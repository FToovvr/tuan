var Wn=Object.defineProperty,Gn=Object.defineProperties;var Vn=Object.getOwnPropertyDescriptors;var nn=Object.getOwnPropertySymbols;var Yn=Object.prototype.hasOwnProperty,jn=Object.prototype.propertyIsEnumerable;var an=(e,t,n)=>t in e?Wn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Ee=(e,t)=>{for(var n in t||(t={}))Yn.call(t,n)&&an(e,n,t[n]);if(nn)for(var n of nn(t))jn.call(t,n)&&an(e,n,t[n]);return e},At=(e,t)=>Gn(e,Vn(t));import{c as Qn,N as on,a as Kn,o as _,b as x,d as p,e as Xn,u as Zn,f as Jn,g as W,h as ea,i as B,j as q,k as Q,l as Ie,r as Re,m as yn,w as we,n as ta,P as rn,p as na,q as aa,s as oa,t as P,v as w,x as b,y as ue,z as ln,A as sn,B as ie,C as Me,D as Ne,E as Xe,F as re,G as Ke,H as ft,I as Ce,J as be,K as ra,L as Pe,T as la,M as sa,O as Le,Q as ct,R as ia,S as ua,U as dt,V as He,W as Rt,X as It,Y as bn,Z as wn,_ as xn,$ as Sn,a0 as un,a1 as ca,a2 as da}from"./vendor.8f5ee17f.js";const pa=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerpolicy&&(s.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?s.credentials="include":r.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}};pa();var fa={button:{about:e=>{const{normalize:t}=e;return t(["\u5173\u4E8E"])},back:e=>{const{normalize:t}=e;return t(["\u8FD4\u56DE"])},go:e=>{const{normalize:t}=e;return t(["\u786E\u5B9A"])},home:e=>{const{normalize:t}=e;return t(["\u9996\u9875"])},toggle_dark:e=>{const{normalize:t}=e;return t(["\u5207\u6362\u6DF1\u8272\u6A21\u5F0F"])},toggle_langs:e=>{const{normalize:t}=e;return t(["\u5207\u6362\u8BED\u8A00"])}},intro:{desc:e=>{const{normalize:t}=e;return t(["\u56FA\u6267\u5DF1\u89C1\u7684 Vite \u9879\u76EE\u6A21\u677F"])},"dynamic-route":e=>{const{normalize:t}=e;return t(["\u52A8\u6001\u8DEF\u7531\u6F14\u793A"])},hi:e=>{const{normalize:t,interpolate:n,named:o}=e;return t(["\u4F60\u597D\uFF0C",n(o("name"))])},aka:e=>{const{normalize:t}=e;return t(["\u4E5F\u53EB"])},"whats-your-name":e=>{const{normalize:t}=e;return t(["\u8F93\u5165\u4F60\u7684\u540D\u5B57"])}},"not-found":e=>{const{normalize:t}=e;return t(["\u672A\u627E\u5230\u9875\u9762"])}},va=Object.freeze(Object.defineProperty({__proto__:null,default:fa},Symbol.toStringTag,{value:"Module"}));const ma=Object.fromEntries(Object.entries({"../../locales/zh-Hans.yml":va}).map(([e,t])=>{const n=e.endsWith(".yaml");return[e.slice(14,n?-5:-4),t.default]})),ha=({app:e})=>{const t=Qn({legacy:!1,locale:"zh-Hans",messages:ma});e.use(t)};var _a=Object.freeze(Object.defineProperty({__proto__:null,install:ha},Symbol.toStringTag,{value:"Module"}));const ga=({isClient:e,router:t})=>{e&&(t.beforeEach(()=>{on.start()}),t.afterEach(()=>{on.done()}))};var ya=Object.freeze(Object.defineProperty({__proto__:null,install:ga},Symbol.toStringTag,{value:"Module"}));const ba=({isClient:e,initialState:t,app:n})=>{const o=Kn();n.use(o),e?o.state.value=t.pinia||{}:t.pinia=o.state.value};var wa=Object.freeze(Object.defineProperty({__proto__:null,install:ba},Symbol.toStringTag,{value:"Module"}));const xa="modulepreload",cn={},Sa="/tuan/",Ta=function(t,n){return!n||n.length===0?t():Promise.all(n.map(o=>{if(o=`${Sa}${o}`,o in cn)return;cn[o]=!0;const r=o.endsWith(".css"),s=r?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${o}"]${s}`))return;const l=document.createElement("link");if(l.rel=r?"stylesheet":xa,r||(l.as="script",l.crossOrigin=""),l.href=o,document.head.appendChild(l),r)return new Promise((c,u)=>{l.addEventListener("load",c),l.addEventListener("error",()=>u(new Error(`Unable to preload CSS for ${o}`)))})})).then(()=>t())},Aa={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"1.2em",height:"1.2em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 32 32"},ka=p("path",{d:"M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z",fill:"currentColor"},null,-1),Ea=[ka];function $a(e,t){return _(),x("svg",Aa,Ea)}var Ca={name:"carbon-moon",render:$a};const Pa={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"1.2em",height:"1.2em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 32 32"},Ra=Xn('<path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path>',9),La=[Ra];function Ia(e,t){return _(),x("svg",Pa,La)}var Ma={name:"carbon-sun",render:Ia};const Na={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"1.2em",height:"1.2em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 32 32"},Oa=p("path",{d:"M16 2a14 14 0 0 0-4.43 27.28c.7.13 1-.3 1-.67v-2.38c-3.89.84-4.71-1.88-4.71-1.88a3.71 3.71 0 0 0-1.62-2.05c-1.27-.86.1-.85.1-.85a2.94 2.94 0 0 1 2.14 1.45a3 3 0 0 0 4.08 1.16a2.93 2.93 0 0 1 .88-1.87c-3.1-.36-6.37-1.56-6.37-6.92a5.4 5.4 0 0 1 1.44-3.76a5 5 0 0 1 .14-3.7s1.17-.38 3.85 1.43a13.3 13.3 0 0 1 7 0c2.67-1.81 3.84-1.43 3.84-1.43a5 5 0 0 1 .14 3.7a5.4 5.4 0 0 1 1.44 3.76c0 5.38-3.27 6.56-6.39 6.91a3.33 3.33 0 0 1 .95 2.59v3.84c0 .46.25.81 1 .67A14 14 0 0 0 16 2z","fill-rule":"evenodd",fill:"currentColor"},null,-1),Da=[Oa];function Fa(e,t){return _(),x("svg",Na,Da)}var za={name:"carbon-logo-github",render:Fa};const vt=Zn(),Ba=Jn(vt);var le=(e,t)=>{const n=e.__vccOpts||e;for(const[o,r]of t)n[o]=r;return n};const Ua={"w:text":"3xl sm:2xl"},Ha={class:"flex items-center","w:flex":"col","w:space":"y-1.5"},qa=["title"],Wa={class:"icon-btn",rel:"noreferrer",href:"https://github.com/FToovvr/tuan",target:"_blank",title:"GitHub"},Ga=W({setup(e){const{t,availableLocales:n,locale:o}=ea();return(r,s)=>{const l=Ca,c=Ma,u=za;return _(),x("nav",Ua,[p("div",Ha,[p("button",{class:"icon-btn !outline-none",title:B(t)("button.toggle_dark"),onClick:s[0]||(s[0]=d=>B(Ba)())},[B(vt)?(_(),q(l,{key:0})):(_(),q(c,{key:1}))],8,qa),p("a",Wa,[Q(u)])])])}}});var Va=le(Ga,[["__scopeId","data-v-9c6f4f6a"]]),Ze={initial:0,post:2e6,overflowMask:19e5,postHead:32e5,fixedWrapper:4e6};const Ya={class:"fixed px-1 py-1.5 rounded-3xl","w:border":"1 gray-500","w:bg":"white dark:gray-900"},ja=W({setup(e){Ie(n=>({"064753e0":B(t)}));const t=Ze.fixedWrapper;return(n,o)=>(_(),x("div",Ya,[Re(n.$slots,"default",{},void 0,!0)]))}});var Tn=le(ja,[["__scopeId","data-v-30638907"]]);const Qa={class:"px-4 pb-10 text-center text-gray-700 dark:text-gray-200"};function Ka(e,t){const n=Va,o=Tn,r=yn("router-view");return _(),x("main",Qa,[Q(o,{class:"top-6 right-3 sm:right-6"},{default:we(()=>[Q(n)]),_:1}),Q(r)])}const Xa={};var Za=le(Xa,[["render",Ka]]);const Ja={"404":()=>Ta(()=>import("./404.f146bd32.js"),["assets/404.f146bd32.js","assets/vendor.8f5ee17f.js"]),default:Za};function eo(e){return e.map(t=>{var n;return{path:t.path,component:Ja[((n=t.meta)==null?void 0:n.layout)||"default"],children:[At(Ee({},t),{path:""})]}})}const it="/tuan";class We{constructor(t,n){this.refShardLookup=null,this.id=t.id,this.dataBasePath=t.dataBasePath,this.pagesPerShard=t.pagesPerShard,this.postsPerPage=t.postsPerPage;const o=this.pagesPerShard*this.postsPerPage;console.assert(this.id===n.id),this.name=n.name,this.postOwner=n.po,this.postCount=n.postCount;const r=Math.floor((this.postCount-1)/o)+1;this.shards=new Array(r).fill(null),this.postFloorLookup=new Map}static async build(t){const n=await(await fetch(`${t.dataBasePath}/tuan.json`)).json();return new We(t,n)}async getPage(t){const{inShard:n,inShardRange:o}=this.getPagePosition(t);return(await this.getShard(n)).posts.slice(o.from,o.to+1)}async getRefPost(t){const n=this.postFloorLookup.get(t);if(n!==void 0){const c=this.getFloorPosition(n);return(await this.getShard(c.inShard)).posts[c.inShardOffset]}const r=(await this.getRefShardLookup()).get(t);if(!r)return null;const s=await this.getShard(r),l=ta(s.posts,t,(c,u)=>c.id-u);return console.assert(l>=0),s.posts[l]}getPagePosition(t){const n=(t-1)%this.pagesPerShard;return{inShard:Math.floor((t-1)/this.pagesPerShard),inShardRange:{from:n*this.postsPerPage,to:(n+1)*this.postsPerPage-1}}}getFloorPosition(t){const n=Math.floor(t/this.postsPerPage)+1,o=t%this.postsPerPage,r=this.getPagePosition(n);return{inShard:r.inShard,inShardOffset:r.inShardRange.from+o}}async getShard(t){const n=this.pagesPerShard*this.postsPerPage;this.shards[t]||(this.shards[t]=We.fetchShard(t,{shardCapacity:n,postCount:this.postCount,dataBasePath:this.dataBasePath}),this.shards[t]=await this.shards[t]);const o=await this.shards[t];if(!o.initialized){o.initialized=!0;const r=t*n;for(const[s,l]of o.posts.entries())this.postFloorLookup.set(l.id,r+s)}return o}static async fetchShard(t,n){const[o,r]=[t*n.shardCapacity,Math.min(n.postCount-1,(t+1)*n.shardCapacity-1)],s=`[${t}]${o}-${r}.csv`,l=await(await fetch(`${n.dataBasePath}/shards/${s}`)).text();l.charCodeAt(0)===65279&&l.substring(1);const u=rn.parse(l,{header:!0}).data.map(d=>{const m={id:Number(d.id),created_at:Number(d.created_at),user_id:d.user_id,content:d.content};return d.title&&(m.title=d.title),d.name&&(m.name=d.name),d.attachment_base&&(m.attachment_base=d.attachment_base),d.attachment_extension&&(m.attachment_extension=d.attachment_extension),m});return{initialized:!1,idRange:{from:u[0].id,to:u[u.length-1].id},posts:u}}async getRefShardLookup(){return this.refShardLookup||(this.refShardLookup=await(async()=>{const t=await(await fetch(`${this.dataBasePath}/ref-index.csv`)).text(),o=rn.parse(t).data,r=new Map;for(let s=1;s<o.length;s++)r.set(o.refId,o.atShard);return r})()),await this.refShardLookup}static convertIdToFolderName(t){const n=t.split(":"),o=n.splice(n.length-1,1);return n.map(r=>`[${r}]`).join("")+o}}const ve=na("stuff",{state:()=>({isInitialized:!1,entrypoint:null,assetBaseUrl:null,lfsAssetBaseUrl:null,collection:null,loadedQuests:new Map,currentQuest:null,rootPostWidth:0,postToScrollTo:null,isInAutoScrolling:!1}),actions:{async loadCurrentQuestLegacy(e,t){const n=this.convertLegacyPathToId(e,t);console.assert(n!==void 0),this.loadCurrentQuest(n)},convertLegacyPathToId(e,t){var n;return(n=this.collection)==null?void 0:n.legacyPathToId.get(`${e}/${t}`)},async loadCurrentQuest(e){this.currentQuest=await this.loadQuest(e)},async loadQuest(e){const t=We.convertIdToFolderName(e);if(this.loadedQuests.has(e))return this.loadedQuests.get(e);if(!this.assetBaseUrl||!this.lfsAssetBaseUrl)throw new Error(`baseUrl(${this.assetBaseUrl}) or lfsBaseUrl(${this.lfsAssetBaseUrl}) is null`);let n=await We.build(Ee({id:e,dataBasePath:`${this.assetBaseUrl}/${t}`},this.collection.shardsInfo));return this.loadedQuests.set(e,n),n}}});function to(e){const t=ve();t.entrypoint=e.entrypoint,t.assetBaseUrl=e.assetBaseUrl,t.lfsAssetBaseUrl=e.lfsAssetBaseUrl,new Promise(async()=>{const n=await(await fetch(`${it}/assets/tuan-data/collection.json`)).json(),o=new Map,r=new Map;for(const s of n.index)o.set(s.id,s),s.legacyPath&&r.set(`${s.legacyPath.folder}/${s.legacyPath.quest}`,s.id);t.collection={quests:o,legacyPathToId:r,shardsInfo:n.shardsInfo},t.isInitialized=!0})}const no=W({setup(e){return aa().appContext.config.compilerOptions.isCustomElement=t=>t==="font",oa({title:"Vitesse",meta:[{name:"description",content:"Opinionated Vite Starter Template"}]}),to({entrypoint:"/tuan",assetBaseUrl:"/tuan/assets/tuan-data",lfsAssetBaseUrl:(()=>`https://media.githubusercontent.com/media/${/^(.*?)\./.exec(window.location.hostname)[1]}/tuan/gh-pages`)()+"/assets/tuan-data"}),(t,n)=>{const o=yn("router-view");return _(),q(o)}}});const ao={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"1.2em",height:"1.2em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 512 512"},oo=p("path",{d:"M414 321.94L274.22 158.82a24 24 0 0 0-36.44 0L98 321.94c-13.34 15.57-2.28 39.62 18.22 39.62h279.6c20.5 0 31.56-24.05 18.18-39.62z",fill:"currentColor"},null,-1),ro=[oo];function lo(e,t){return _(),x("svg",ao,ro)}var so={name:"ion-caret-up",render:lo};const io=e=>(Me("data-v-7ecd0a8b"),e=e(),Ne(),e),uo=["value"],co=io(()=>p("div",null,"/",-1)),po={class:"max"},fo=W({props:{modelValue:null,max:null,disabled:{type:Boolean}},emits:["update:modelValue"],setup(e,{emit:t}){const n=e;Ie(u=>({"0b8dea46":r.value}));let o=P(n,"modelValue"),r=w(()=>{var u;return`${Math.max((u=n.max)!=null?u:0,n.modelValue).toString().length+1}ch`});function s(u,d=!1){var S,T;if(n.disabled)return;const m=d?(S=l.value)==null?void 0:S.selectionStart:null;let g=Number(u);return!Number.isInteger(g)||g<=0||g>((T=n.max)!=null?T:0)?u==="":(t("update:modelValue",Number(u)),m&&Xe(()=>{var R;return(R=l.value)==null?void 0:R.setSelectionRange(m,m)}),!0)}let l=b(null);ue(()=>{l.value.oninput=function(u){s(this.value)||(this.value=o.value)}});function c(u){var d;u.target instanceof HTMLInputElement||(d=l.value)==null||d.focus()}return(u,d)=>{var m;return _(),x("div",{class:"flex","w:justify":"center",onClick:c},[p("input",{class:"block",ref_key:"inputRef",ref:l,inputmode:"decimal",value:o.value,onKeydown:[d[0]||(d[0]=ln(sn(g=>s(o.value-1,!0),["prevent"]),["up"])),d[1]||(d[1]=ln(sn(g=>s(o.value+1,!0),["prevent"]),["down"]))]},null,40,uo),co,p("div",po,ie((m=e.max)!=null?m:"\u2026"),1)])}}});var vo=le(fo,[["__scopeId","data-v-7ecd0a8b"]]);const mo={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"1.2em",height:"1.2em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 512 512"},ho=p("path",{d:"M98 190.06l139.78 163.12a24 24 0 0 0 36.44 0L414 190.06c13.34-15.57 2.28-39.62-18.22-39.62h-279.6c-20.5 0-31.56 24.05-18.18 39.62z",fill:"currentColor"},null,-1),_o=[ho];function go(e,t){return _(),x("svg",mo,_o)}var yo={name:"ion-caret-down",render:go};const bo={class:"flex","w:m":"auto","w:w":"max","w:space":"x-1","w:p":"0.5","w:items":"center"},wo=["disabled"],xo=["disabled"],So=W({props:{currentPage:null,max:null,pageStatuses:null,disabled:{type:Boolean}},emits:["pageChangeRequired"],setup(e,{emit:t}){const n=e;function o(l){var c;l>0&&l<=((c=n.max)!=null?c:0)&&t("pageChangeRequired",l)}let r=w(()=>n.pageStatuses.get(n.currentPage-1)==="loading"),s=w(()=>n.pageStatuses.get(n.currentPage+1)==="loading");return(l,c)=>{const u=so,d=vo,m=yo;return _(),x("div",bo,[p("button",{onClick:c[0]||(c[0]=g=>o(e.currentPage-1)),disabled:e.currentPage===1||r.value||e.disabled,"w:h":"1.2em","w:text":"2xl"},[Q(u)],8,wo),Q(d,{modelValue:e.currentPage,max:e.max,"onUpdate:modelValue":c[1]||(c[1]=g=>o(g)),disabled:e.disabled},null,8,["modelValue","max","disabled"]),p("button",{onClick:c[2]||(c[2]=g=>o(e.currentPage+1)),disabled:e.currentPage===e.max||s.value||e.disabled,"w:h":"1.2em","w:text":"2xl"},[Q(m)],8,xo)])}}});var To=le(So,[["__scopeId","data-v-3af40edc"]]);const Ao={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"1.2em",height:"1.2em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 256 256"},ko=p("path",{d:"M216.5 199.5a12 12 0 0 1 0 17a12.1 12.1 0 0 1-17 0L128 145l-71.5 71.5a12 12 0 0 1-17-17l80-80a12 12 0 0 1 17 0zm-160-63L128 65l71.5 71.5a12.1 12.1 0 0 0 17 0a12 12 0 0 0 0-17l-80-80a12 12 0 0 0-17 0l-80 80a12 12 0 0 0 17 17z",fill:"currentColor"},null,-1),Eo=[ko];function $o(e,t){return _(),x("svg",Ao,Eo)}var Co={name:"ph-caret-double-up-bold",render:$o};const Po={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"1.2em",height:"1.2em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 256 256"},Ro=p("path",{d:"M216.5 119.5a12 12 0 0 1 0 17l-80 80a12.1 12.1 0 0 1-17 0l-80-80a12 12 0 0 1 17-17L128 191l71.5-71.5a12 12 0 0 1 17 0zm-97 17a12.1 12.1 0 0 0 17 0l80-80a12 12 0 0 0-17-17L128 111L56.5 39.5a12 12 0 0 0-17 17z",fill:"currentColor"},null,-1),Lo=[Ro];function Io(e,t){return _(),x("svg",Po,Lo)}var Mo={name:"ph-caret-double-down-bold",render:Io};const No={class:"flex items-center justify-center space-x-1 cursor-pointer","w:text":"gray-700 dark:gray-300 opacity-80"},Oo={"w:font":"bold","w:text":"sm"},Do=W({props:{direction:null,pageNumber:null},setup(e){return(t,n)=>{const o=Co,r=Mo;return _(),x("div",No,[e.direction==="up"?(_(),q(o,{key:0,style:{"font-size":"0.875rem"}})):re("",!0),e.direction==="down"?(_(),q(r,{key:1,style:{"font-size":"0.875rem"}})):re("",!0),p("div",Oo,"\u52A0\u8F7D"+ie(e.pageNumber)+"\u9875\u2026",1)])}}}),An=e=>(Me("data-v-2203ae9b"),e=e(),Ne(),e),Fo={class:"flex"},zo=An(()=>p("div",{class:"dash"},null,-1)),Bo={"w:p":"x-2"},Uo=An(()=>p("div",{class:"dash"},null,-1));function Ho(e,t){return _(),x("div",Fo,[zo,p("div",Bo,[Re(e.$slots,"default",{},void 0,!0)]),Uo])}const qo={};var Wo=le(qo,[["render",Ho],["__scopeId","data-v-2203ae9b"]]);const Go=W({props:{direction:{default:"top-bottom"},backgroundColorRgbHex:null,height:{default:"2rem"},zIndex:{type:[Number,Boolean]}},setup(e){const t=e;Ie(c=>({"39b9b75e":n.value,"7df8f27e":e.height,"730a3305":s.value,"0688da06":B(l)}));let n=w(()=>t.direction==="top-bottom"?`calc(100% - ${t.height})`:0),o=P(t,"backgroundColorRgbHex"),r=w(()=>`${o.value}00`),s=w(()=>t.direction==="top-bottom"?`linear-gradient(${r.value}, ${o.value})`:`linear-gradient(${o.value}, ${r.value})`);const l=typeof t.zIndex=="number"?t.zIndex:t.zIndex?Ze.overflowMask:null;return(c,u)=>(_(),x("div"))}});var Mt=le(Go,[["__scopeId","data-v-0927980d"]]);function kn(e){return e*parseFloat(getComputedStyle(document.documentElement).fontSize)}const Vo={key:0,"w:float":"right"},Yo=["data-mode"],jo=["src"],Qo=W({props:{imageUrl:null,backgroundColorRgbHex:null},setup(e){Ie(d=>({"707c1c4f":l.value}));let t=b(null),n=b("thumbnail");function o(){n.value=n.value==="thumbnail"?"expanded":"thumbnail",n.value==="thumbnail"&&t.value.getBoundingClientRect().top<0&&(t.value.closest(".quest-post").scrollIntoView(),window.scrollBy(0,kn(-2)))}let r=b({width:0,height:0});ue(()=>{Ke(t.value.querySelector("img"),d=>{r.value=d[0].contentRect})});let s=w(()=>r.value.width*2),l=w(()=>`${s.value}px`),c=b(null);function u(){c.value=null}return ue(()=>{t.value.querySelector("img").onerror=d=>{typeof d=="string"?c.value=`\u56FE\u7247\u52A0\u8F7D\u5931\u8D25\uFF1A${d}`:c.value="\u56FE\u7247\u52A0\u8F7D\u5931\u8D25\uFF01"}}),(d,m)=>{const g=Mt;return _(),x(ft,null,[c.value!==null?(_(),x("span",Vo,ie(c.value),1)):re("",!0),p("figure",{class:"relative",ref_key:"figureRef",ref:t,"data-mode":n.value,onClick:o},[n.value==="thumbnail"&&r.value.height>s.value?(_(),q(g,{key:0,"background-color-rgb-hex":e.backgroundColorRgbHex},null,8,["background-color-rgb-hex"])):re("",!0),p("img",{src:e.imageUrl,loading:"lazy",onLoad:u},null,40,jo)],8,Yo)],64)}}});var Ko=le(Qo,[["__scopeId","data-v-3e31d681"]]);function Xo(e){return`#${e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/).slice(1).map(t=>parseInt(t,10).toString(16).padStart(2,"0")).join("")}`}function rt(e){const t=document.createElement("div");t.className=`${e}`,document.body.appendChild(t);const n=Xo(window.getComputedStyle(t).getPropertyValue("color"));return t.remove(),n}const En=(()=>({app:{background:{light:rt("text-white"),dark:rt("text-black")}},post:{background:{light:rt("text-post-background-color"),dark:rt("text-post-background-color-dark")}}}))();w(()=>En.app.background[vt.value?"dark":"light"]);const qe=w(()=>En.post.background[vt.value?"dark":"light"]),$n=Symbol(),Cn=Symbol(),dn=Symbol(),Pn=Symbol(),Rn=Symbol(),Ln=Symbol();const Zo=e=>(Me("data-v-087fd58a"),e=e(),Ne(),e),Jo={class:"inline-block relative"},er=["data-status"],tr=Zo(()=>p("span",{class:"px-0.5"},null,-1)),nr=W({props:{postId:null,nestLevel:null,siblingOrder:null},setup(e){const t=e;let n=P(t,"postId"),o=w(()=>Number(t.nestLevel)),r=w(()=>Number(t.siblingOrder)),s=Ce($n),l=b(null),c=b(null),u=ve(),d=w(()=>{const M="0.75rem",f=`${u.rootPostWidth}px`,A=`(${M} * ${o.value+1})`,O=`(0.2em * ${o.value})`;return`calc(${f} - ${A} - ${O})`}),m=function(f,A,O=100){let k=f,U=A,X=b({refLink:!1,refPost:!1}),oe=w(()=>X.value.refLink||X.value.refPost),pe=b(!1);be(oe,async xe=>{xe===!1&&(pe.value=!0,await new Promise(C=>setTimeout(C,O)),pe.value=!1)});let I=w(()=>oe.value||pe.value),he=b({width:0,height:0});ue(()=>{Ke(s.value,xe=>{const{width:C,height:_e}=xe[0].contentRect;he.value={width:C,height:_e}})});const D=ra(he,200);return be([k,U,D],()=>{if(!s.value||!k.value||!U.value)return;const{top:xe,left:C}=k.value.getBoundingClientRect(),{top:_e,left:Ge}=s.value.getBoundingClientRect();U.value.style.top=`${xe-_e}px`,U.value.style.left=`${C-Ge}px`}),{onHovers:X,shouldFloat:I}}(l,c,100),g=P(m,"onHovers"),S=P(m,"shouldFloat"),T=b(!1),R=b(0),L=b(0),F=b(0);be([c,T],()=>{var f,A;if(!c.value||!T.value)return;const M=c.value.querySelector(".quest-post-content-wrapper");for(const{heightRef:O,widthRef:k,el:U}of[{heightRef:R,widthRef:L,el:c.value},{heightRef:F,widthRef:null,el:M}])O.value=(f=U.clientHeight)!=null?f:0,k&&(k.value=(A=U.clientWidth)!=null?A:0),Ke(U,X=>{O.value=X[0].contentRect.height,k&&(k.value=X[0].contentRect.width)})},{immediate:!0});const de=kn(15/4);let j=function(f,A){let O=A,k=b(!1),U=b(!1);be(k,he=>{he||(U.value=!1)});let X=w(()=>k.value?U.value?"collapsed":"open":S.value?"floating":"closed"),oe=w(()=>O.value>f),pe=b(!1);function I(he){if(pe.value=!1,!k.value)k.value=!0;else if(he==="link"){if(!oe.value)return;U.value=X.value!=="collapsed"}else k.value=!1}return{displayStatus:X,isPinned:k,isCollapsed:U,isCollapsible:oe,eagersToCollapse:pe,onClick:I}}(de,F),G=P(j,"displayStatus"),z=P(j,"isPinned"),ee=P(j,"isCollapsed"),N=P(j,"isCollapsible"),te=P(j,"eagersToCollapse"),$=P(j,"onClick"),ne=w(()=>{var M;return z.value?(M=s.value)==null?void 0:M.querySelector(".relative.quest-post-ref-wrapper"):s.value});be(F,()=>{te.value&&N.value&&(ee.value=!0,te.value=!1)}),ue(()=>{o.value===1&&(z.value=!0,Xe(()=>{N.value?ee.value=!0:te.value=!0}))});let se=Ce(Cn),ae=w(()=>Ze.post+(se.value-r.value));return(M,f)=>{const A=Mt,O=On;return _(),x(ft,null,[p("span",{class:"ref-post-link",style:Pe([{color:"#789922"},{cursor:G.value==="open"?N.value?"zoom-out":"":"zoom-in"}]),"w:font":"mono","w:text":"sm",onClick:f[0]||(f[0]=k=>$.value("link")),onMouseenter:f[1]||(f[1]=k=>g.value.refLink=!0),onMouseleave:f[2]||(f[2]=k=>g.value.refLink=!1)},">>No."+ie(n.value),37),(_(),q(sa,null,[s.value&&(S.value||z.value)?(_(),x("div",{key:0,class:"ref-post-anchor",ref_key:"refPostAnchorRef",ref:l,style:Pe(z.value?{height:`${R.value}px`,width:`${L.value}px`}:void 0)},[(_(),q(la,{to:ne.value},[p("div",{class:"absolute",ref_key:"refPostRef",ref:c,onMouseenter:f[7]||(f[7]=k=>(g.value.refPost=!0,te.value=!1)),onMouseleave:f[8]||(f[8]=k=>g.value.refPost=!1),style:Pe([{width:"max-content"},{zIndex:ae.value,maxWidth:d.value}])},[Q(O,{"post-id":n.value,"nest-level":o.value,"display-status":G.value,onExpand:f[5]||(f[5]=k=>$.value("link")),onReady:f[6]||(f[6]=k=>T.value=!0)},{"head-left":we(()=>[p("div",Jo,[ee.value?(_(),q(A,{key:0,onClick:f[3]||(f[3]=k=>$.value("pin")),"w:cursor":"pointer",height:"1em","background-color-rgb-hex":B(qe),"z-index":""},null,8,["background-color-rgb-hex"])):re("",!0),p("span",{class:"pin-button","data-status":G.value,"w:text":"xs",onClick:f[4]||(f[4]=k=>$.value("pin")),"w:cursor":"pointer"},"\u{1F4CC}",8,er)]),tr]),_:1},8,["post-id","nest-level","display-status"])],36)],8,["to"]))],4)):re("",!0)],1024))],64)}}});var ar=le(nr,[["__scopeId","data-v-087fd58a"]]);/*! @license DOMPurify 2.3.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.3.6/LICENSE */function or(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}else return Array.from(e)}var rr=Object.hasOwnProperty,pn=Object.setPrototypeOf,lr=Object.isFrozen,sr=Object.getPrototypeOf,ir=Object.getOwnPropertyDescriptor,K=Object.freeze,me=Object.seal,ur=Object.create,In=typeof Reflect!="undefined"&&Reflect,pt=In.apply,Lt=In.construct;pt||(pt=function(t,n,o){return t.apply(n,o)});K||(K=function(t){return t});me||(me=function(t){return t});Lt||(Lt=function(t,n){return new(Function.prototype.bind.apply(t,[null].concat(or(n))))});var cr=ce(Array.prototype.forEach),fn=ce(Array.prototype.pop),je=ce(Array.prototype.push),ut=ce(String.prototype.toLowerCase),vn=ce(String.prototype.match),Te=ce(String.prototype.replace),dr=ce(String.prototype.indexOf),pr=ce(String.prototype.trim),J=ce(RegExp.prototype.test),kt=fr(TypeError);function ce(e){return function(t){for(var n=arguments.length,o=Array(n>1?n-1:0),r=1;r<n;r++)o[r-1]=arguments[r];return pt(e,t,o)}}function fr(e){return function(){for(var t=arguments.length,n=Array(t),o=0;o<t;o++)n[o]=arguments[o];return Lt(e,n)}}function y(e,t){pn&&pn(e,null);for(var n=t.length;n--;){var o=t[n];if(typeof o=="string"){var r=ut(o);r!==o&&(lr(t)||(t[n]=r),o=r)}e[o]=!0}return e}function $e(e){var t=ur(null),n=void 0;for(n in e)pt(rr,e,[n])&&(t[n]=e[n]);return t}function lt(e,t){for(;e!==null;){var n=ir(e,t);if(n){if(n.get)return ce(n.get);if(typeof n.value=="function")return ce(n.value)}e=sr(e)}function o(r){return console.warn("fallback value for",r),null}return o}var mn=K(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Et=K(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),$t=K(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),vr=K(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Ct=K(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),mr=K(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),hn=K(["#text"]),_n=K(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),Pt=K(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),gn=K(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),st=K(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),hr=me(/\{\{[\s\S]*|[\s\S]*\}\}/gm),_r=me(/<%[\s\S]*|[\s\S]*%>/gm),gr=me(/^data-[\-\w.\u00B7-\uFFFF]/),yr=me(/^aria-[\-\w]+$/),br=me(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),wr=me(/^(?:\w+script|data):/i),xr=me(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Sr=me(/^html$/i),Qe=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function fe(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}else return Array.from(e)}var Tr=function(){return typeof window=="undefined"?null:window},Ar=function(t,n){if((typeof t=="undefined"?"undefined":Qe(t))!=="object"||typeof t.createPolicy!="function")return null;var o=null,r="data-tt-policy-suffix";n.currentScript&&n.currentScript.hasAttribute(r)&&(o=n.currentScript.getAttribute(r));var s="dompurify"+(o?"#"+o:"");try{return t.createPolicy(s,{createHTML:function(c){return c}})}catch{return console.warn("TrustedTypes policy "+s+" could not be created."),null}};function Mn(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Tr(),t=function(a){return Mn(a)};if(t.version="2.3.6",t.removed=[],!e||!e.document||e.document.nodeType!==9)return t.isSupported=!1,t;var n=e.document,o=e.document,r=e.DocumentFragment,s=e.HTMLTemplateElement,l=e.Node,c=e.Element,u=e.NodeFilter,d=e.NamedNodeMap,m=d===void 0?e.NamedNodeMap||e.MozNamedAttrMap:d,g=e.HTMLFormElement,S=e.DOMParser,T=e.trustedTypes,R=c.prototype,L=lt(R,"cloneNode"),F=lt(R,"nextSibling"),de=lt(R,"childNodes"),j=lt(R,"parentNode");if(typeof s=="function"){var G=o.createElement("template");G.content&&G.content.ownerDocument&&(o=G.content.ownerDocument)}var z=Ar(T,n),ee=z?z.createHTML(""):"",N=o,te=N.implementation,$=N.createNodeIterator,ne=N.createDocumentFragment,se=N.getElementsByTagName,ae=n.importNode,M={};try{M=$e(o).documentMode?o.documentMode:{}}catch{}var f={};t.isSupported=typeof j=="function"&&te&&typeof te.createHTMLDocument!="undefined"&&M!==9;var A=hr,O=_r,k=gr,U=yr,X=wr,oe=xr,pe=br,I=null,he=y({},[].concat(fe(mn),fe(Et),fe($t),fe(Ct),fe(hn))),D=null,xe=y({},[].concat(fe(_n),fe(Pt),fe(gn),fe(st))),C=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),_e=null,Ge=null,Ft=!0,mt=!0,zt=!1,Oe=!1,Ae=!1,ht=!1,_t=!1,De=!1,et=!1,tt=!1,Bt=!0,gt=!0,Ve=!1,Fe={},ze=null,Ut=y({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Ht=null,qt=y({},["audio","video","img","source","image","track"]),yt=null,Wt=y({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),bt="http://www.w3.org/1998/Math/MathML",wt="http://www.w3.org/2000/svg",Se="http://www.w3.org/1999/xhtml",nt=Se,xt=!1,Be=void 0,Dn=["application/xhtml+xml","text/html"],Fn="text/html",ke=void 0,Ue=null,zn=o.createElement("form"),Gt=function(a){return a instanceof RegExp||a instanceof Function},St=function(a){Ue&&Ue===a||((!a||(typeof a=="undefined"?"undefined":Qe(a))!=="object")&&(a={}),a=$e(a),I="ALLOWED_TAGS"in a?y({},a.ALLOWED_TAGS):he,D="ALLOWED_ATTR"in a?y({},a.ALLOWED_ATTR):xe,yt="ADD_URI_SAFE_ATTR"in a?y($e(Wt),a.ADD_URI_SAFE_ATTR):Wt,Ht="ADD_DATA_URI_TAGS"in a?y($e(qt),a.ADD_DATA_URI_TAGS):qt,ze="FORBID_CONTENTS"in a?y({},a.FORBID_CONTENTS):Ut,_e="FORBID_TAGS"in a?y({},a.FORBID_TAGS):{},Ge="FORBID_ATTR"in a?y({},a.FORBID_ATTR):{},Fe="USE_PROFILES"in a?a.USE_PROFILES:!1,Ft=a.ALLOW_ARIA_ATTR!==!1,mt=a.ALLOW_DATA_ATTR!==!1,zt=a.ALLOW_UNKNOWN_PROTOCOLS||!1,Oe=a.SAFE_FOR_TEMPLATES||!1,Ae=a.WHOLE_DOCUMENT||!1,De=a.RETURN_DOM||!1,et=a.RETURN_DOM_FRAGMENT||!1,tt=a.RETURN_TRUSTED_TYPE||!1,_t=a.FORCE_BODY||!1,Bt=a.SANITIZE_DOM!==!1,gt=a.KEEP_CONTENT!==!1,Ve=a.IN_PLACE||!1,pe=a.ALLOWED_URI_REGEXP||pe,nt=a.NAMESPACE||Se,a.CUSTOM_ELEMENT_HANDLING&&Gt(a.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(C.tagNameCheck=a.CUSTOM_ELEMENT_HANDLING.tagNameCheck),a.CUSTOM_ELEMENT_HANDLING&&Gt(a.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(C.attributeNameCheck=a.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),a.CUSTOM_ELEMENT_HANDLING&&typeof a.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(C.allowCustomizedBuiltInElements=a.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Be=Dn.indexOf(a.PARSER_MEDIA_TYPE)===-1?Be=Fn:Be=a.PARSER_MEDIA_TYPE,ke=Be==="application/xhtml+xml"?function(i){return i}:ut,Oe&&(mt=!1),et&&(De=!0),Fe&&(I=y({},[].concat(fe(hn))),D=[],Fe.html===!0&&(y(I,mn),y(D,_n)),Fe.svg===!0&&(y(I,Et),y(D,Pt),y(D,st)),Fe.svgFilters===!0&&(y(I,$t),y(D,Pt),y(D,st)),Fe.mathMl===!0&&(y(I,Ct),y(D,gn),y(D,st))),a.ADD_TAGS&&(I===he&&(I=$e(I)),y(I,a.ADD_TAGS)),a.ADD_ATTR&&(D===xe&&(D=$e(D)),y(D,a.ADD_ATTR)),a.ADD_URI_SAFE_ATTR&&y(yt,a.ADD_URI_SAFE_ATTR),a.FORBID_CONTENTS&&(ze===Ut&&(ze=$e(ze)),y(ze,a.FORBID_CONTENTS)),gt&&(I["#text"]=!0),Ae&&y(I,["html","head","body"]),I.table&&(y(I,["tbody"]),delete _e.tbody),K&&K(a),Ue=a)},Vt=y({},["mi","mo","mn","ms","mtext"]),Yt=y({},["foreignobject","desc","title","annotation-xml"]),at=y({},Et);y(at,$t),y(at,vr);var Tt=y({},Ct);y(Tt,mr);var Bn=function(a){var i=j(a);(!i||!i.tagName)&&(i={namespaceURI:Se,tagName:"template"});var v=ut(a.tagName),E=ut(i.tagName);if(a.namespaceURI===wt)return i.namespaceURI===Se?v==="svg":i.namespaceURI===bt?v==="svg"&&(E==="annotation-xml"||Vt[E]):Boolean(at[v]);if(a.namespaceURI===bt)return i.namespaceURI===Se?v==="math":i.namespaceURI===wt?v==="math"&&Yt[E]:Boolean(Tt[v]);if(a.namespaceURI===Se){if(i.namespaceURI===wt&&!Yt[E]||i.namespaceURI===bt&&!Vt[E])return!1;var V=y({},["title","style","font","a","script"]);return!Tt[v]&&(V[v]||!at[v])}return!1},ge=function(a){je(t.removed,{element:a});try{a.parentNode.removeChild(a)}catch{try{a.outerHTML=ee}catch{a.remove()}}},jt=function(a,i){try{je(t.removed,{attribute:i.getAttributeNode(a),from:i})}catch{je(t.removed,{attribute:null,from:i})}if(i.removeAttribute(a),a==="is"&&!D[a])if(De||et)try{ge(i)}catch{}else try{i.setAttribute(a,"")}catch{}},Qt=function(a){var i=void 0,v=void 0;if(_t)a="<remove></remove>"+a;else{var E=vn(a,/^[\r\n\t ]+/);v=E&&E[0]}Be==="application/xhtml+xml"&&(a='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+a+"</body></html>");var V=z?z.createHTML(a):a;if(nt===Se)try{i=new S().parseFromString(V,Be)}catch{}if(!i||!i.documentElement){i=te.createDocument(nt,"template",null);try{i.documentElement.innerHTML=xt?"":V}catch{}}var Y=i.body||i.documentElement;return a&&v&&Y.insertBefore(o.createTextNode(v),Y.childNodes[0]||null),nt===Se?se.call(i,Ae?"html":"body")[0]:Ae?i.documentElement:Y},Kt=function(a){return $.call(a.ownerDocument||a,a,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT,null,!1)},Un=function(a){return a instanceof g&&(typeof a.nodeName!="string"||typeof a.textContent!="string"||typeof a.removeChild!="function"||!(a.attributes instanceof m)||typeof a.removeAttribute!="function"||typeof a.setAttribute!="function"||typeof a.namespaceURI!="string"||typeof a.insertBefore!="function")},Ye=function(a){return(typeof l=="undefined"?"undefined":Qe(l))==="object"?a instanceof l:a&&(typeof a=="undefined"?"undefined":Qe(a))==="object"&&typeof a.nodeType=="number"&&typeof a.nodeName=="string"},ye=function(a,i,v){!f[a]||cr(f[a],function(E){E.call(t,i,v,Ue)})},Xt=function(a){var i=void 0;if(ye("beforeSanitizeElements",a,null),Un(a)||vn(a.nodeName,/[\u0080-\uFFFF]/))return ge(a),!0;var v=ke(a.nodeName);if(ye("uponSanitizeElement",a,{tagName:v,allowedTags:I}),!Ye(a.firstElementChild)&&(!Ye(a.content)||!Ye(a.content.firstElementChild))&&J(/<[/\w]/g,a.innerHTML)&&J(/<[/\w]/g,a.textContent)||v==="select"&&J(/<template/i,a.innerHTML))return ge(a),!0;if(!I[v]||_e[v]){if(!_e[v]&&Jt(v)&&(C.tagNameCheck instanceof RegExp&&J(C.tagNameCheck,v)||C.tagNameCheck instanceof Function&&C.tagNameCheck(v)))return!1;if(gt&&!ze[v]){var E=j(a)||a.parentNode,V=de(a)||a.childNodes;if(V&&E)for(var Y=V.length,H=Y-1;H>=0;--H)E.insertBefore(L(V[H],!0),F(a))}return ge(a),!0}return a instanceof c&&!Bn(a)||(v==="noscript"||v==="noembed")&&J(/<\/no(script|embed)/i,a.innerHTML)?(ge(a),!0):(Oe&&a.nodeType===3&&(i=a.textContent,i=Te(i,A," "),i=Te(i,O," "),a.textContent!==i&&(je(t.removed,{element:a.cloneNode()}),a.textContent=i)),ye("afterSanitizeElements",a,null),!1)},Zt=function(a,i,v){if(Bt&&(i==="id"||i==="name")&&(v in o||v in zn))return!1;if(!(mt&&!Ge[i]&&J(k,i))){if(!(Ft&&J(U,i))){if(!D[i]||Ge[i]){if(!(Jt(a)&&(C.tagNameCheck instanceof RegExp&&J(C.tagNameCheck,a)||C.tagNameCheck instanceof Function&&C.tagNameCheck(a))&&(C.attributeNameCheck instanceof RegExp&&J(C.attributeNameCheck,i)||C.attributeNameCheck instanceof Function&&C.attributeNameCheck(i))||i==="is"&&C.allowCustomizedBuiltInElements&&(C.tagNameCheck instanceof RegExp&&J(C.tagNameCheck,v)||C.tagNameCheck instanceof Function&&C.tagNameCheck(v))))return!1}else if(!yt[i]){if(!J(pe,Te(v,oe,""))){if(!((i==="src"||i==="xlink:href"||i==="href")&&a!=="script"&&dr(v,"data:")===0&&Ht[a])){if(!(zt&&!J(X,Te(v,oe,"")))){if(v)return!1}}}}}}return!0},Jt=function(a){return a.indexOf("-")>0},en=function(a){var i=void 0,v=void 0,E=void 0,V=void 0;ye("beforeSanitizeAttributes",a,null);var Y=a.attributes;if(!!Y){var H={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:D};for(V=Y.length;V--;){i=Y[V];var ot=i,Z=ot.name,tn=ot.namespaceURI;if(v=pr(i.value),E=ke(Z),H.attrName=E,H.attrValue=v,H.keepAttr=!0,H.forceKeepAttr=void 0,ye("uponSanitizeAttribute",a,H),v=H.attrValue,!H.forceKeepAttr&&(jt(Z,a),!!H.keepAttr)){if(J(/\/>/i,v)){jt(Z,a);continue}Oe&&(v=Te(v,A," "),v=Te(v,O," "));var qn=ke(a.nodeName);if(!!Zt(qn,E,v))try{tn?a.setAttributeNS(tn,Z,v):a.setAttribute(Z,v),fn(t.removed)}catch{}}}ye("afterSanitizeAttributes",a,null)}},Hn=function h(a){var i=void 0,v=Kt(a);for(ye("beforeSanitizeShadowDOM",a,null);i=v.nextNode();)ye("uponSanitizeShadowNode",i,null),!Xt(i)&&(i.content instanceof r&&h(i.content),en(i));ye("afterSanitizeShadowDOM",a,null)};return t.sanitize=function(h,a){var i=void 0,v=void 0,E=void 0,V=void 0,Y=void 0;if(xt=!h,xt&&(h="<!-->"),typeof h!="string"&&!Ye(h)){if(typeof h.toString!="function")throw kt("toString is not a function");if(h=h.toString(),typeof h!="string")throw kt("dirty is not a string, aborting")}if(!t.isSupported){if(Qe(e.toStaticHTML)==="object"||typeof e.toStaticHTML=="function"){if(typeof h=="string")return e.toStaticHTML(h);if(Ye(h))return e.toStaticHTML(h.outerHTML)}return h}if(ht||St(a),t.removed=[],typeof h=="string"&&(Ve=!1),Ve){if(h.nodeName){var H=ke(h.nodeName);if(!I[H]||_e[H])throw kt("root node is forbidden and cannot be sanitized in-place")}}else if(h instanceof l)i=Qt("<!---->"),v=i.ownerDocument.importNode(h,!0),v.nodeType===1&&v.nodeName==="BODY"||v.nodeName==="HTML"?i=v:i.appendChild(v);else{if(!De&&!Oe&&!Ae&&h.indexOf("<")===-1)return z&&tt?z.createHTML(h):h;if(i=Qt(h),!i)return De?null:tt?ee:""}i&&_t&&ge(i.firstChild);for(var ot=Kt(Ve?h:i);E=ot.nextNode();)E.nodeType===3&&E===V||Xt(E)||(E.content instanceof r&&Hn(E.content),en(E),V=E);if(V=null,Ve)return h;if(De){if(et)for(Y=ne.call(i.ownerDocument);i.firstChild;)Y.appendChild(i.firstChild);else Y=i;return D.shadowroot&&(Y=ae.call(n,Y,!0)),Y}var Z=Ae?i.outerHTML:i.innerHTML;return Ae&&I["!doctype"]&&i.ownerDocument&&i.ownerDocument.doctype&&i.ownerDocument.doctype.name&&J(Sr,i.ownerDocument.doctype.name)&&(Z="<!DOCTYPE "+i.ownerDocument.doctype.name+`>
`+Z),Oe&&(Z=Te(Z,A," "),Z=Te(Z,O," ")),z&&tt?z.createHTML(Z):Z},t.setConfig=function(h){St(h),ht=!0},t.clearConfig=function(){Ue=null,ht=!1},t.isValidAttribute=function(h,a,i){Ue||St({});var v=ke(h),E=ke(a);return Zt(v,E,i)},t.addHook=function(h,a){typeof a=="function"&&(f[h]=f[h]||[],je(f[h],a))},t.removeHook=function(h){f[h]&&fn(f[h])},t.removeHooks=function(h){f[h]&&(f[h]=[])},t.removeAllHooks=function(){f={}},t}var kr=Mn();const Er={class:"prose","w:text":"left","w:break":"words"},$r={"w:whitespace":"pre-line","w:leading":"snug"},Cr=["innerHTML"],Pr=W({props:{content:null,nestLevel:null},setup(e){const t=e;let n=P(t,"content"),o=w(()=>kr.sanitize(n.value)),r=w(()=>o.value.indexOf("<font")>=0),s=b(0);Le(Cn,ct(s));let l=w(()=>{const c=new DOMParser().parseFromString(`<div>${o.value}</div>`,"text/html"),u=c.querySelectorAll('font[color="#789922"]');let d=1;return u.forEach(m=>{if(!/>>No\.\d+/.test(m.textContent))return;const g=Number(m.textContent.split(".")[1]),S=document.createElement("quest-post-ref-link");S.setAttribute(":post-id",String(g)),S.setAttribute(":nest-level",String(t.nestLevel+1)),S.setAttribute(":sibling-order",String(d)),d++,m.parentElement.replaceChild(S,m)}),s.value=d-1,c.documentElement.children[1]});return(c,u)=>(_(),x("div",Er,[p("div",$r,[r.value?(_(),q(ia({template:l.value,components:{QuestPostRefLink:ar}}),{key:0})):(_(),x("div",{key:1,innerHTML:o.value},null,8,Cr))])]))}});const Je=e=>(Me("data-v-b4c178e4"),e=e(),Ne(),e),Rr={class:"quest-post-wrapper relative"},Lr=Je(()=>p("div",{"w:clear":"both"},null,-1)),Ir=Je(()=>p("div",{class:"h-1"},null,-1)),Mr=Je(()=>p("hr",{"w:m":"x-0.5","w:border":"dashed gray-400"},null,-1)),Nr={class:"quest-post-content-wrapper"},Or=Je(()=>p("div",{class:"relative quest-post-ref-wrapper"},null,-1)),Dr=Je(()=>p("div",{"w:clear":"both"},null,-1)),Fr=W({props:{nestLevel:null,displayStatus:null,backgroundColorRgbHex:null},emits:["expand"],setup(e,{emit:t}){const n=e;Ie(T=>({a337ed86:e.backgroundColorRgbHex,"2119d084":B(S)}));let o=w(()=>n.nestLevel>0),r=b(null);Le($n,ct(r));function s(T){n.displayStatus==="collapsed"&&(t("expand"),T.target instanceof HTMLElement&&T.target.classList.contains("ref-post-link")||T.stopPropagation())}let l=b(null),c=Ce("offsetTop",b(0)),u=b(0);ue(()=>Ke(l.value,([T])=>u.value=T.contentRect.height));let d=b(null),m=function(R,L,F,de){let j=L,G=R,z=F,ee=de,N=b(null),te=w(()=>z.value+ee.value),$=w(()=>{var ae;return Math.max((ae=N.value)!=null?ae:te.value,z.value)}),ne=b(null);const se=ae=>{if(!G.value){window.removeEventListener("scroll",se);return}const M=G.value.getBoundingClientRect();N.value=M.bottom};return ua(()=>window.removeEventListener("scroll",se)),ue(()=>dt(j.value,([{intersectionRatio:ae}])=>{const M=j.value.getBoundingClientRect();M.top>0&&M.bottom>window.innerHeight/2||(ae===1?ne.value="onScreen":ae===0?ne.value==="aboveScreen"?ne.value="partiallyCoveredByTopEdge":ne.value="aboveScreen":ne.value="partiallyCoveredByTopEdge")},{threshold:[0,1]})),be(ne,()=>{switch(ne.value){case"onScreen":window.removeEventListener("scroll",se),N.value=null;break;case"aboveScreen":window.removeEventListener("scroll",se),N.value=0;break;case"partiallyCoveredByTopEdge":window.addEventListener("scroll",se);break}}),{childTop:$}}(l,d,c,u),g=P(m,"childTop");Le("offsetTop",ct(g));let S=Ze.postHead;return(T,R)=>{const L=Mt;return _(),x("article",{class:He(["quest-post container relative rounded-md",B(o)?"!border-gray-400 px-1":"px-4 pt-0.5"]),"w:border":"1 dark:gray"},[p("div",Rr,[p("div",{class:"quest-post-head sticky",ref_key:"headRef",ref:l,"w:text":"sm","w:p":"t-1",style:Pe({top:`${c.value}px`})},[Re(T.$slots,"head",{},void 0,!0),Lr,Ir,Mr],4),p("div",{class:He(B(o)?"h-1.5":"h-1")},null,2),p("div",{class:"relative",ref_key:"postContentDivRef",ref:r},[e.displayStatus==="collapsed"?(_(),q(L,{key:0,onClickCapture:s,"background-color-rgb-hex":e.backgroundColorRgbHex,"z-index":""},null,8,["background-color-rgb-hex"])):re("",!0),p("div",{class:He(e.displayStatus==="collapsed"?"max-h-15 overflow-hidden":void 0)},[p("div",Nr,[Or,p("div",{onClickCapture:s,class:He((B(o),"px-2"))},[Re(T.$slots,"content",{},void 0,!0),p("div",{class:He(B(o)?"h-2":"h-3")},null,2)],34)])],2)],512),Dr,p("div",{ref_key:"sentinelDiv",ref:d,style:Pe([{position:"absolute",left:"0",right:"0",visibility:"hidden"},{height:`${u.value}px`,bottom:`${c.value}px`}])},null,4)])],2)}}});var Nn=le(Fr,[["__scopeId","data-v-b4c178e4"]]);const Nt=e=>(Me("data-v-053ad1d9"),e=e(),Ne(),e),zr={"w:float":"left"},Br=Nt(()=>p("span",{class:"px-1.5"},null,-1)),Ur={"w:font":"mono"},Hr=Nt(()=>p("span",{class:"px-3"},null,-1)),qr={"w:font":"mono","w:float":"right"},Wr={"w:text":"xs"},Gr=It("("),Vr=["href"],Yr=It(")"),jr={key:0},Qr=Nt(()=>p("div",{class:"clear-both"},null,-1)),Kr=W({props:{post:null,nestLevel:null,displayStatus:null},emits:["expand"],setup(e,{emit:t}){const n=e;Ie(S=>({"09c311ec":B(qe)}));let o=w(()=>n.nestLevel>0),r=Ce(Ln),s=P(n,"post");const l=ve();let c=w(()=>{const S=s.value.createdAtUtc+288e3,T=new Date(S*1e3).toISOString(),[R,L]=T.split("T"),[F]=L.split(".");return`${R} ${F}`}),u=Ce(Pn),d=Ce(Rn),m=b(null),g=b(null);return ue(()=>{if(n.nestLevel>0)return;let S=!0;dt(m,([{intersectionRatio:R,boundingClientRect:{y:L}}])=>{if(S){S=!1;return}l.isInAutoScrolling||R<1&&m.value.getBoundingClientRect().top<0&&(r.value&&(u.value=r.value),d.value=s.value.postId)},{threshold:1});let T=null;dt(g,([{intersectionRatio:R,boundingClientRect:{y:L}}])=>{if(T===null||T>window.innerHeight){T=L;return}T=L,!l.isInAutoScrolling&&R===1&&(r.value&&(u.value=r.value),d.value=s.value.postId)},{threshold:1})}),ue(()=>{n.nestLevel===0&&Xe(()=>{const S=ve();S.postToScrollTo===n.post.postId&&(m.value.scrollIntoView(),S.postToScrollTo=null)})}),(S,T)=>{const R=Ko,L=Pr;return _(),x("div",null,[p("div",{ref_key:"topSentinelDiv",ref:m},null,512),s.value?(_(),q(Nn,Rt({key:0,id:o.value?void 0:"id-"+s.value.postId,"nest-level":e.nestLevel,"display-status":e.displayStatus,"background-color-rgb-hex":B(qe),onExpand:T[0]||(T[0]=F=>t("expand"))},S.$attrs),{head:we(()=>[p("div",zr,[Re(S.$slots,"head-left",{},void 0,!0),p("span",{"w:font":"mono",class:He(s.value.isPostOwner?"font-black":"font-normal")},ie(s.value.userId),3),Br,p("span",Ur,ie(c.value),1),Hr]),p("div",qr,[p("span",null,"No."+ie(s.value.postId),1),p("span",Wr,[Gr,p("a",{class:"anchor-link",href:"#id-"+s.value.postId},"#"+ie(s.value.floorNumber),9,Vr),Yr])])]),content:we(()=>{var F;return[p("div",null,[s.value.imageUrl?(_(),x("div",jr,[Q(R,{"image-url":s.value.imageUrl,"background-color-rgb-hex":B(qe)},null,8,["image-url","background-color-rgb-hex"])])):re("",!0),Q(L,{content:s.value.content,"nest-level":(F=e.nestLevel)!=null?F:0},null,8,["content","nest-level"]),Qr])]}),_:3},16,["id","nest-level","display-status","background-color-rgb-hex"])):re("",!0),p("div",{ref_key:"bottomSentinelDiv",ref:g},null,512)])}}});var Xr=le(Kr,[["__scopeId","data-v-053ad1d9"]]);function Zr(e,t,n){const o=ve();return{postId:e.id,floorNumber:n,createdAtUtc:e.created_at,userId:e.user_id,isPostOwner:e.user_id===t.postOwner,content:e.content,imageUrl:e.attachment_base?(()=>{const s=`${e.attachment_base}${e.attachment_extension}`.split("/")[1],l=We.convertIdToFolderName(t.id);return`${o.lfsAssetBaseUrl}/${l}/attachments/${s}`})():void 0}}const Ot=e=>(Me("data-v-f07b7dd4"),e=e(),Ne(),e),Jr={"w:float":"left"},el={"w:font":"mono","w:float":"right"},tl={key:0,"w:text":"rose-600 bold"},nl=Ot(()=>p("span",{"w:text":"lg"},"\u672C\u4E32\u53F7\u5BF9\u5E94\u5185\u5BB9\u672A\u88AB\u6536\u5F55\u2026",-1)),al=Ot(()=>p("br",null,null,-1)),ol=Ot(()=>p("span",{"w:text":"sm"},"\u6B64\u5185\u5BB9\u53EF\u80FD\u6765\u81EA\u5176\u4ED6\u4E32\uFF0C\u6216\u5728\u6536\u5F55\u524D\u5C31\u5DF2\u6D88\u5931\u3002",-1)),rl=[nl,al,ol],ll={key:1,"w:text":"gray-400 bold"},sl=W({props:{postId:null,nestLevel:null,displayStatus:{default:"open"}},emits:["expand","ready"],setup(e,{emit:t}){const n=e;Ie(c=>({"517f306d":B(qe)}));let o=Ce(dn,b(!1)),r=w(()=>o.value||n.displayStatus==="collapsed");Le(dn,ct(r));const s=ve();let l=b("loading");return new Promise(async()=>{const c=await s.currentQuest.getRefPost(n.postId);if(!c)l.value="lost";else{const u=s.currentQuest;l.value=Zr(c,u,u.postFloorLookup.get(c.id))}Xe(()=>t("ready"))}),(c,u)=>{var m,g;const d=Xr;return l.value==="loading"||l.value==="lost"?(_(),q(Nn,Rt({key:0,"nest-level":(m=e.nestLevel)!=null?m:0,"display-status":e.displayStatus,"background-color-rgb-hex":B(qe),onExpand:u[0]||(u[0]=S=>t("expand"))},c.$attrs),{head:we(()=>[p("div",Jr,[Re(c.$slots,"head-left",{},void 0,!0)]),p("div",el,[p("span",null,"No."+ie(e.postId),1)])]),content:we(()=>[l.value==="lost"?(_(),x("span",tl,rl)):(_(),x("span",ll,"\u52A0\u8F7D\u4E2D\u2026"))]),_:3},16,["nest-level","display-status","background-color-rgb-hex"])):(_(),q(d,Rt({key:1,post:l.value,"nest-level":(g=e.nestLevel)!=null?g:0,"display-status":e.displayStatus,onExpand:u[1]||(u[1]=S=>t("expand"))},c.$attrs),{"head-left":we(()=>[Re(c.$slots,"head-left",{},void 0,!0)]),_:3},16,["post","nest-level","display-status"]))}}});var On=le(sl,[["__scopeId","data-v-f07b7dd4"]]);const il=["id"],ul={class:"post-page-bar"},cl={"w:font":"mono"},dl=p("div",{"w:h":"2"},null,-1),pl={key:1},fl=p("span",null,"\u9875\u9762\u52A0\u8F7D\u4E2D\u2026",-1),vl=[fl],ml=W({props:{props:null},emits:["ready"],setup(e,{emit:t}){const n=e;let o=w(()=>n.props.type==="page"?n.props.page:null);Le(Ln,o);let r=w(()=>n.props.type==="page"?`${n.props.page}\u9875`:"?");const s=ve();let l=b([]);be(P(n,"props"),async()=>{const d=await s.currentQuest.getPage(n.props.page);l.value=d.map(m=>m.id)},{immediate:!0});let c=b(null);return ue(()=>{Ke(c,u=>{s.rootPostWidth=u[0].contentRect.width})}),be(l,()=>{l.value.length>0&&Xe(()=>t("ready"))}),(u,d)=>{const m=Wo;return _(),x("div",{class:"post-page",id:o.value!==null?`page-${o.value}`:void 0},[p("div",ul,[Q(m,null,{default:we(()=>[p("span",cl,ie(r.value),1)]),_:1})]),dl,l.value?(_(),x("div",{key:0,class:"post-list",ref_key:"postListRef",ref:c,"w:space":"y-1"},[(_(!0),x(ft,null,bn(l.value,(g,S)=>(_(),q(On,{key:g,"post-id":g,style:Pe({zIndex:B(Ze).post+l.value.length-S})},null,8,["post-id","style"]))),128))],512)):(_(),x("div",pl,vl))],8,il)}}}),hl={key:0,"w:h":"2"},_l=W({props:{pageStart:null,pageEnd:null,pageCurrent:null},emits:["updated"],setup(e,{emit:t}){const n=e;let o=w(()=>function*(){for(let l=n.pageStart;l<=n.pageEnd;l++)yield l});const r=new Map;be([P(n,"pageStart"),P(n,"pageEnd")],()=>{for(const l of[...r.keys()])(l<n.pageStart||l>n.pageEnd)&&r.delete(l);for(let l=n.pageStart;l<=n.pageEnd;l++)r.has(l)||r.set(l,"loading")},{immediate:!0});function s(l){r.set(l,"ready"),t("updated",r)}return(l,c)=>{const u=ml;return _(!0),x(ft,null,bn(o.value(),(d,m)=>(_(),x("div",{key:d},[Number(m)!==0?(_(),x("div",hl)):re("",!0),Q(u,{props:{type:"page",page:d},style:Pe({zIndex:-d}),onReady:g=>s(d)},null,8,["props","style","onReady"])]))),128)}}});function gl(e){if(e.durationMs<=0)return window.scrollTo(window.screenX,e.finalY),e.onComplete(),null;const t=window.scrollY,n=e.finalY-t;let o=null,r=!1;const s=()=>{r=!0};return window.requestAnimationFrame(function l(c){if(r)return;o||(o=c);const u=c-o,d=Math.min(u/e.durationMs,1);window.scrollTo(window.screenX,t+n*d),u<e.durationMs?window.requestAnimationFrame(l):window.requestAnimationFrame(e.onComplete)}),s}const Dt=e=>(Me("data-v-51a22f11"),e=e(),Ne(),e),yl={key:0,class:"max-w-2xl mx-auto"},bl=Dt(()=>p("hr",null,null,-1)),wl=Dt(()=>p("div",{"w:h":"2"},null,-1)),xl=Dt(()=>p("div",{"w:h":"2"},null,-1)),Sl=W({setup(e){var M;const n=wn().params;let o=xn(Ee({},n)),r=P(o,"id"),s=P(o,"page");s.value=(M=s.value)!=null?M:"1";const l=ve();new Promise(async()=>{await Sn(P(l,"isInitialized")).toBe(!0),l.loadCurrentQuest(r.value)});let c=w(()=>l.currentQuest!==null),u=b(Number(s.value)),d=b(null);Le(Pn,u),Le(Rn,d),un([u,d],()=>{history.replaceState({},"",String(u.value)),history.replaceState({},"",d.value?`#id-${d.value}`:"")},{throttle:300});let m=b(u.value),g=b(u.value),S=w(()=>{var f;return(f=l.currentQuest)==null?void 0:f.postCount}),T=w(()=>{var f;return S.value?((((f=S.value)!=null?f:1)-1)/19|0)+1:null}),R=w(()=>{var f;return g.value<((f=T.value)!=null?f:0)});function L(f){return document.querySelector(`#page-${f}`)}let F=null,de;function j(){F=L(m.value).offsetTop,m.value--}let G=b(new Map);function z(f){if(G.value=f,de&&(window.scrollTo(window.scrollX,de),de=null),F!==null){const O=L(m.value+1).offsetTop-F;window.scrollBy({top:O}),F=null}requestAnimationFrame(()=>te())}let ee=null,N=null;function te(f=null,A=null){if(f===null){if(!N)return;f=N.pageToJumpTo,A=N.jumpToPageOptions}if(G.value.get(f)!=="ready"){N={pageToJumpTo:f,jumpToPageOptions:A};return}else N=null;ee&&(ee(),ee=null),Ee({behavior:"smooth"},A).behavior==="auto"?L(f).scrollIntoView():(l.isInAutoScrolling=!0,ee=gl({finalY:L(f).getBoundingClientRect().top+window.scrollY,durationMs:300,onComplete:()=>{l.isInAutoScrolling=!1}}))}let $=b(null),ne=w(()=>$.value===null?0:G.value.get($.value)!=="ready"?500:0);un($,()=>{if($.value!==null){if(u.value=$.value,!($.value>=m.value&&$.value<=g.value))if($.value===m.value-1)m.value=$.value,g.value>m.value+9&&(g.value=m.value+9);else if($.value===g.value+1){if(g.value=$.value,g.value>m.value+9){const f=L(m.value).getBoundingClientRect().top,A=L(g.value-9).getBoundingClientRect().top;de=window.scrollY-(A-f),m.value=g.value-9}}else m.value=$.value,g.value=$.value,window.scrollTo({top:0});d.value=null,te($.value),$.value=null}},{throttle:ne});function se(f,A){$.value=f}let ae=b(null);return ue(()=>{dt(ae,([{intersectionRatio:f}])=>{G.value.get(g.value)==="ready"&&f>0&&g.value++},{threshold:[0]})}),(f,A)=>{var X;const O=To,k=Do,U=_l;return c.value?(_(),x("div",yl,[Q(Tn,{class:"page-control bottom-2 sm:bottom-6"},{default:we(()=>[Q(O,{"current-page":$.value||u.value,max:T.value,"page-statuses":G.value,onPageChangeRequired:A[0]||(A[0]=oe=>se(oe))},null,8,["current-page","max","page-statuses"])]),_:1}),It(ie((X=B(l).currentQuest)==null?void 0:X.name),1),bl,m.value-1>0?(_(),q(k,{key:0,direction:"up","page-number":m.value-1,onClick:j},null,8,["page-number"])):re("",!0),wl,Q(U,{"page-start":m.value,"page-end":g.value,"page-current":u.value,onUpdated:A[1]||(A[1]=oe=>z(oe))},null,8,["page-start","page-end","page-current"]),xl,R.value?(_(),q(k,{key:1,direction:"down","page-number":g.value+1,onClick:A[2]||(A[2]=oe=>g.value++)},null,8,["page-number"])):re("",!0),p("div",{ref_key:"autoLoadNextPageSentinelDiv",ref:ae,"w:m":"b-8"},null,512)])):re("",!0)}}});var Tl=le(Sl,[["__scopeId","data-v-51a22f11"]]);const Al=W({setup(e){const t=wn(),n=ca(),o=t.params;let r=xn(Ee({},o)),s=P(r,"folder"),l=P(r,"quest"),c=P(r,"page");const u=ve();return new Promise(async()=>{await Sn(P(u,"isInitialized")).toBe(!0);const d=u.convertLegacyPathToId(s.value,l.value);n.replace({path:`${u.entrypoint}/quests/${d}/pages/${c.value}`,params:t.params,hash:t.hash})}),()=>{}}});var kl=[{path:`${it}/quests/:id/pages/:page`,component:Tl},{path:`${it}/quests/:id`,redirect:e=>{const t=e.path.endsWith("/")?e.path:`${e.path}/`;return At(Ee({},e),{path:`${t}pages/1`})}},{path:`${it}/folder-:folder/quest-:quest/:page`,component:Al}];const El=eo(kl);da(no,{routes:El,scrollBehavior:(e,t,n)=>{if(e.hash){const o=/^#id\-(\d+)$/.exec(e.hash);if(o){const r=ve();r.postToScrollTo=Number(o[1])}}}},e=>{Object.values({"./modules/i18n.ts":_a,"./modules/nprogress.ts":ya,"./modules/pinia.ts":wa}).map(t=>{var n;return(n=t.install)==null?void 0:n.call(t,e)})});
