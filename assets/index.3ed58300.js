var Gn=Object.defineProperty,Vn=Object.defineProperties;var Yn=Object.getOwnPropertyDescriptors;var nn=Object.getOwnPropertySymbols;var jn=Object.prototype.hasOwnProperty,Qn=Object.prototype.propertyIsEnumerable;var an=(e,t,n)=>t in e?Gn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Ae=(e,t)=>{for(var n in t||(t={}))jn.call(t,n)&&an(e,n,t[n]);if(nn)for(var n of nn(t))Qn.call(t,n)&&an(e,n,t[n]);return e},At=(e,t)=>Vn(e,Yn(t));import{c as Kn,N as on,a as Xn,o as h,b as T,d as p,e as Zn,u as Jn,f as ea,g as W,h as ta,i as B,j as q,k as j,l as Re,r as Ce,m as yn,w as ye,n as na,P as rn,p as aa,q as oa,s as ra,t as C,v as S,x,y as ie,z as sn,A as ln,B as le,C as Le,D as Ie,E as Ke,F as ne,G as Qe,H as pt,I as ke,J as fe,K as sa,L as $e,T as la,M as ia,O as Pe,Q as ut,R as ua,S as ca,U as ct,V as Ue,W as Rt,X as It,Y as bn,Z as wn,_ as xn,$ as Sn,a0 as un,a1 as da,a2 as pa}from"./vendor.8f5ee17f.js";const fa=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const l of r)if(l.type==="childList")for(const s of l.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&o(s)}).observe(document,{childList:!0,subtree:!0});function n(r){const l={};return r.integrity&&(l.integrity=r.integrity),r.referrerpolicy&&(l.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?l.credentials="include":r.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function o(r){if(r.ep)return;r.ep=!0;const l=n(r);fetch(r.href,l)}};fa();var va={button:{about:e=>{const{normalize:t}=e;return t(["\u5173\u4E8E"])},back:e=>{const{normalize:t}=e;return t(["\u8FD4\u56DE"])},go:e=>{const{normalize:t}=e;return t(["\u786E\u5B9A"])},home:e=>{const{normalize:t}=e;return t(["\u9996\u9875"])},toggle_dark:e=>{const{normalize:t}=e;return t(["\u5207\u6362\u6DF1\u8272\u6A21\u5F0F"])},toggle_langs:e=>{const{normalize:t}=e;return t(["\u5207\u6362\u8BED\u8A00"])}},intro:{desc:e=>{const{normalize:t}=e;return t(["\u56FA\u6267\u5DF1\u89C1\u7684 Vite \u9879\u76EE\u6A21\u677F"])},"dynamic-route":e=>{const{normalize:t}=e;return t(["\u52A8\u6001\u8DEF\u7531\u6F14\u793A"])},hi:e=>{const{normalize:t,interpolate:n,named:o}=e;return t(["\u4F60\u597D\uFF0C",n(o("name"))])},aka:e=>{const{normalize:t}=e;return t(["\u4E5F\u53EB"])},"whats-your-name":e=>{const{normalize:t}=e;return t(["\u8F93\u5165\u4F60\u7684\u540D\u5B57"])}},"not-found":e=>{const{normalize:t}=e;return t(["\u672A\u627E\u5230\u9875\u9762"])}},ma=Object.freeze(Object.defineProperty({__proto__:null,default:va},Symbol.toStringTag,{value:"Module"}));const ha=Object.fromEntries(Object.entries({"../../locales/zh-Hans.yml":ma}).map(([e,t])=>{const n=e.endsWith(".yaml");return[e.slice(14,n?-5:-4),t.default]})),_a=({app:e})=>{const t=Kn({legacy:!1,locale:"zh-Hans",messages:ha});e.use(t)};var ga=Object.freeze(Object.defineProperty({__proto__:null,install:_a},Symbol.toStringTag,{value:"Module"}));const ya=({isClient:e,router:t})=>{e&&(t.beforeEach(()=>{on.start()}),t.afterEach(()=>{on.done()}))};var ba=Object.freeze(Object.defineProperty({__proto__:null,install:ya},Symbol.toStringTag,{value:"Module"}));const wa=({isClient:e,initialState:t,app:n})=>{const o=Xn();n.use(o),e?o.state.value=t.pinia||{}:t.pinia=o.state.value};var xa=Object.freeze(Object.defineProperty({__proto__:null,install:wa},Symbol.toStringTag,{value:"Module"}));const Sa="modulepreload",cn={},Ta="/tuan/",Aa=function(t,n){return!n||n.length===0?t():Promise.all(n.map(o=>{if(o=`${Ta}${o}`,o in cn)return;cn[o]=!0;const r=o.endsWith(".css"),l=r?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${o}"]${l}`))return;const s=document.createElement("link");if(s.rel=r?"stylesheet":Sa,r||(s.as="script",s.crossOrigin=""),s.href=o,document.head.appendChild(s),r)return new Promise((d,u)=>{s.addEventListener("load",d),s.addEventListener("error",()=>u(new Error(`Unable to preload CSS for ${o}`)))})})).then(()=>t())},Ea={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"1.2em",height:"1.2em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 32 32"},ka=p("path",{d:"M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z",fill:"currentColor"},null,-1),$a=[ka];function Ca(e,t){return h(),T("svg",Ea,$a)}var Pa={name:"carbon-moon",render:Ca};const Ra={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"1.2em",height:"1.2em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 32 32"},La=Zn('<path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path>',9),Ia=[La];function Ma(e,t){return h(),T("svg",Ra,Ia)}var Na={name:"carbon-sun",render:Ma};const Oa={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"1.2em",height:"1.2em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 32 32"},Da=p("path",{d:"M16 2a14 14 0 0 0-4.43 27.28c.7.13 1-.3 1-.67v-2.38c-3.89.84-4.71-1.88-4.71-1.88a3.71 3.71 0 0 0-1.62-2.05c-1.27-.86.1-.85.1-.85a2.94 2.94 0 0 1 2.14 1.45a3 3 0 0 0 4.08 1.16a2.93 2.93 0 0 1 .88-1.87c-3.1-.36-6.37-1.56-6.37-6.92a5.4 5.4 0 0 1 1.44-3.76a5 5 0 0 1 .14-3.7s1.17-.38 3.85 1.43a13.3 13.3 0 0 1 7 0c2.67-1.81 3.84-1.43 3.84-1.43a5 5 0 0 1 .14 3.7a5.4 5.4 0 0 1 1.44 3.76c0 5.38-3.27 6.56-6.39 6.91a3.33 3.33 0 0 1 .95 2.59v3.84c0 .46.25.81 1 .67A14 14 0 0 0 16 2z","fill-rule":"evenodd",fill:"currentColor"},null,-1),Fa=[Da];function za(e,t){return h(),T("svg",Oa,Fa)}var Ba={name:"carbon-logo-github",render:za};const ft=Jn(),Ua=ea(ft);var ae=(e,t)=>{const n=e.__vccOpts||e;for(const[o,r]of t)n[o]=r;return n};const Ha={"w:text":"3xl sm:2xl"},qa={class:"flex items-center","w:flex":"col","w:space":"y-1.5"},Wa=["title"],Ga={class:"icon-btn",rel:"noreferrer",href:"https://github.com/FToovvr/tuan",target:"_blank",title:"GitHub"},Va=W({setup(e){const{t,availableLocales:n,locale:o}=ta();return(r,l)=>{const s=Pa,d=Na,u=Ba;return h(),T("nav",Ha,[p("div",qa,[p("button",{class:"icon-btn !outline-none",title:B(t)("button.toggle_dark"),onClick:l[0]||(l[0]=c=>B(Ua)())},[B(ft)?(h(),q(s,{key:0})):(h(),q(d,{key:1}))],8,Wa),p("a",Ga,[j(u)])])])}}});var Ya=ae(Va,[["__scopeId","data-v-9c6f4f6a"]]),Xe={initial:0,post:2e6,overflowMask:19e5,postHead:32e5,fixedWrapper:4e6};const ja={class:"fixed px-1 py-1.5 rounded-3xl","w:border":"1 gray-500","w:bg":"white dark:gray-900"},Qa=W({setup(e){Re(n=>({"064753e0":B(t)}));const t=Xe.fixedWrapper;return(n,o)=>(h(),T("div",ja,[Ce(n.$slots,"default",{},void 0,!0)]))}});var Tn=ae(Qa,[["__scopeId","data-v-30638907"]]);const Ka={class:"px-4 pb-10 text-center text-gray-700 dark:text-gray-200"};function Xa(e,t){const n=Ya,o=Tn,r=yn("router-view");return h(),T("main",Ka,[j(o,{class:"top-6 right-3 sm:right-6"},{default:ye(()=>[j(n)]),_:1}),j(r)])}const Za={};var Ja=ae(Za,[["render",Xa]]);const eo={"404":()=>Aa(()=>import("./404.f146bd32.js"),["assets/404.f146bd32.js","assets/vendor.8f5ee17f.js"]),default:Ja};function to(e){return e.map(t=>{var n;return{path:t.path,component:eo[((n=t.meta)==null?void 0:n.layout)||"default"],children:[At(Ae({},t),{path:""})]}})}const lt="/tuan";class qe{constructor(t,n){this.refShardLookup=null,this.id=t.id,this.dataBasePath=t.dataBasePath,this.pagesPerShard=t.pagesPerShard,this.postsPerPage=t.postsPerPage;const o=this.pagesPerShard*this.postsPerPage;console.assert(this.id===n.id),this.name=n.name,this.postOwner=n.po,this.postCount=n.postCount;const r=Math.floor((this.postCount-1)/o)+1;this.shards=new Array(r).fill(null),this.postFloorLookup=new Map}static async build(t){const n=await(await fetch(`${t.dataBasePath}/tuan.json`)).json();return new qe(t,n)}async getPage(t){const{inShard:n,inShardRange:o}=this.getPagePosition(t);return(await this.getShard(n)).posts.slice(o.from,o.to+1)}async getRefPost(t){const n=this.postFloorLookup.get(t);if(n!==void 0){const d=this.getFloorPosition(n);return(await this.getShard(d.inShard)).posts[d.inShardOffset]}const r=(await this.getRefShardLookup()).get(t);if(!r)return null;const l=await this.getShard(r),s=na(l.posts,t,(d,u)=>d.id-u);return console.assert(s>=0),l.posts[s]}getPagePosition(t){const n=(t-1)%this.pagesPerShard;return{inShard:Math.floor((t-1)/this.pagesPerShard),inShardRange:{from:n*this.postsPerPage,to:(n+1)*this.postsPerPage-1}}}getFloorPosition(t){const n=Math.floor(t/this.postsPerPage)+1,o=t%this.postsPerPage,r=this.getPagePosition(n);return{inShard:r.inShard,inShardOffset:r.inShardRange.from+o}}async getShard(t){const n=this.pagesPerShard*this.postsPerPage;this.shards[t]||(this.shards[t]=qe.fetchShard(t,{shardCapacity:n,postCount:this.postCount,dataBasePath:this.dataBasePath}),this.shards[t]=await this.shards[t]);const o=await this.shards[t];if(!o.initialized){o.initialized=!0;const r=t*n;for(const[l,s]of o.posts.entries())this.postFloorLookup.set(s.id,r+l)}return o}static async fetchShard(t,n){const[o,r]=[t*n.shardCapacity,Math.min(n.postCount-1,(t+1)*n.shardCapacity-1)],l=`[${t}]${o}-${r}.csv`,s=await(await fetch(`${n.dataBasePath}/shards/${l}`)).text();s.charCodeAt(0)===65279&&s.substring(1);const u=rn.parse(s,{header:!0}).data.map(c=>{const v={id:Number(c.id),created_at:Number(c.created_at),user_id:c.user_id,content:c.content};return c.title&&(v.title=c.title),c.name&&(v.name=c.name),c.attachment_base&&(v.attachment_base=c.attachment_base),c.attachment_extension&&(v.attachment_extension=c.attachment_extension),v});return{initialized:!1,idRange:{from:u[0].id,to:u[u.length-1].id},posts:u}}async getRefShardLookup(){return this.refShardLookup||(this.refShardLookup=await(async()=>{const t=await(await fetch(`${this.dataBasePath}/ref-index.csv`)).text(),o=rn.parse(t).data,r=new Map;for(let l=1;l<o.length;l++)r.set(o.refId,o.atShard);return r})()),await this.refShardLookup}static convertIdToFolderName(t){const n=t.split(":"),o=n.splice(n.length-1,1);return n.map(r=>`[${r}]`).join("")+o}}const ve=aa("stuff",{state:()=>({isInitialized:!1,entrypoint:null,assetBaseUrl:null,lfsAssetBaseUrl:null,collection:null,loadedQuests:new Map,currentQuest:null,rootPostWidth:0,postToScrollTo:null,isInAutoScrolling:!1}),actions:{async loadCurrentQuestLegacy(e,t){const n=this.convertLegacyPathToId(e,t);console.assert(n!==void 0),this.loadCurrentQuest(n)},convertLegacyPathToId(e,t){var n;return(n=this.collection)==null?void 0:n.legacyPathToId.get(`${e}/${t}`)},async loadCurrentQuest(e){this.currentQuest=await this.loadQuest(e)},async loadQuest(e){const t=qe.convertIdToFolderName(e);if(this.loadedQuests.has(e))return this.loadedQuests.get(e);if(!this.assetBaseUrl||!this.lfsAssetBaseUrl)throw new Error(`baseUrl(${this.assetBaseUrl}) or lfsBaseUrl(${this.lfsAssetBaseUrl}) is null`);let n=await qe.build(Ae({id:e,dataBasePath:`${this.assetBaseUrl}/${t}`},this.collection.shardsInfo));return this.loadedQuests.set(e,n),n}}});function no(e){const t=ve();t.entrypoint=e.entrypoint,t.assetBaseUrl=e.assetBaseUrl,t.lfsAssetBaseUrl=e.lfsAssetBaseUrl,new Promise(async()=>{const n=await(await fetch(`${lt}/assets/tuan-data/collection.json`)).json(),o=new Map,r=new Map;for(const l of n.index)o.set(l.id,l),l.legacyPath&&r.set(`${l.legacyPath.folder}/${l.legacyPath.quest}`,l.id);t.collection={quests:o,legacyPathToId:r,shardsInfo:n.shardsInfo},t.isInitialized=!0})}const ao=W({setup(e){return oa().appContext.config.compilerOptions.isCustomElement=t=>t==="font",ra({title:"Vitesse",meta:[{name:"description",content:"Opinionated Vite Starter Template"}]}),no({entrypoint:"/tuan",assetBaseUrl:"/tuan/assets/tuan-data",lfsAssetBaseUrl:(()=>`https://media.githubusercontent.com/media/${/^(.*?)\./.exec(window.location.hostname)[1]}/tuan/gh-pages`)()+"/assets/tuan-data"}),(t,n)=>{const o=yn("router-view");return h(),q(o)}}});const oo={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"1.2em",height:"1.2em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 512 512"},ro=p("path",{d:"M414 321.94L274.22 158.82a24 24 0 0 0-36.44 0L98 321.94c-13.34 15.57-2.28 39.62 18.22 39.62h279.6c20.5 0 31.56-24.05 18.18-39.62z",fill:"currentColor"},null,-1),so=[ro];function lo(e,t){return h(),T("svg",oo,so)}var io={name:"ion-caret-up",render:lo};const uo=e=>(Le("data-v-7ecd0a8b"),e=e(),Ie(),e),co=["value"],po=uo(()=>p("div",null,"/",-1)),fo={class:"max"},vo=W({props:{modelValue:null,max:null,disabled:{type:Boolean}},emits:["update:modelValue"],setup(e,{emit:t}){const n=e;Re(u=>({"0b8dea46":r.value}));let o=C(n,"modelValue"),r=S(()=>{var u;return`${Math.max((u=n.max)!=null?u:0,n.modelValue).toString().length+1}ch`});function l(u,c=!1){var A,E;if(n.disabled)return;const v=c?(A=s.value)==null?void 0:A.selectionStart:null;let g=Number(u);return!Number.isInteger(g)||g<=0||g>((E=n.max)!=null?E:0)?u==="":(t("update:modelValue",Number(u)),v&&Ke(()=>{var $;return($=s.value)==null?void 0:$.setSelectionRange(v,v)}),!0)}let s=x(null);ie(()=>{s.value.oninput=function(u){l(this.value)||(this.value=o.value)}});function d(u){var c;u.target instanceof HTMLInputElement||(c=s.value)==null||c.focus()}return(u,c)=>{var v;return h(),T("div",{class:"flex","w:justify":"center",onClick:d},[p("input",{class:"block",ref_key:"inputRef",ref:s,inputmode:"decimal",value:o.value,onKeydown:[c[0]||(c[0]=sn(ln(g=>l(o.value-1,!0),["prevent"]),["up"])),c[1]||(c[1]=sn(ln(g=>l(o.value+1,!0),["prevent"]),["down"]))]},null,40,co),po,p("div",fo,le((v=e.max)!=null?v:"\u2026"),1)])}}});var mo=ae(vo,[["__scopeId","data-v-7ecd0a8b"]]);const ho={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"1.2em",height:"1.2em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 512 512"},_o=p("path",{d:"M98 190.06l139.78 163.12a24 24 0 0 0 36.44 0L414 190.06c13.34-15.57 2.28-39.62-18.22-39.62h-279.6c-20.5 0-31.56 24.05-18.18 39.62z",fill:"currentColor"},null,-1),go=[_o];function yo(e,t){return h(),T("svg",ho,go)}var bo={name:"ion-caret-down",render:yo};const wo={class:"flex","w:m":"auto","w:w":"max","w:space":"x-1","w:p":"0.5","w:items":"center"},xo=["disabled"],So=["disabled"],To=W({props:{currentPage:null,max:null,pageStatuses:null,disabled:{type:Boolean}},emits:["pageChangeRequired"],setup(e,{emit:t}){const n=e;function o(s){var d;s>0&&s<=((d=n.max)!=null?d:0)&&t("pageChangeRequired",s)}let r=S(()=>n.pageStatuses.get(n.currentPage-1)==="loading"),l=S(()=>n.pageStatuses.get(n.currentPage+1)==="loading");return(s,d)=>{const u=io,c=mo,v=bo;return h(),T("div",wo,[p("button",{onClick:d[0]||(d[0]=g=>o(e.currentPage-1)),disabled:e.currentPage===1||r.value||e.disabled,"w:h":"1.2em","w:text":"2xl"},[j(u)],8,xo),j(c,{modelValue:e.currentPage,max:e.max,"onUpdate:modelValue":d[1]||(d[1]=g=>o(g)),disabled:e.disabled},null,8,["modelValue","max","disabled"]),p("button",{onClick:d[2]||(d[2]=g=>o(e.currentPage+1)),disabled:e.currentPage===e.max||l.value||e.disabled,"w:h":"1.2em","w:text":"2xl"},[j(v)],8,So)])}}});var Ao=ae(To,[["__scopeId","data-v-3af40edc"]]);const Eo={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"1.2em",height:"1.2em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 256 256"},ko=p("path",{d:"M216.5 199.5a12 12 0 0 1 0 17a12.1 12.1 0 0 1-17 0L128 145l-71.5 71.5a12 12 0 0 1-17-17l80-80a12 12 0 0 1 17 0zm-160-63L128 65l71.5 71.5a12.1 12.1 0 0 0 17 0a12 12 0 0 0 0-17l-80-80a12 12 0 0 0-17 0l-80 80a12 12 0 0 0 17 17z",fill:"currentColor"},null,-1),$o=[ko];function Co(e,t){return h(),T("svg",Eo,$o)}var Po={name:"ph-caret-double-up-bold",render:Co};const Ro={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"1.2em",height:"1.2em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 256 256"},Lo=p("path",{d:"M216.5 119.5a12 12 0 0 1 0 17l-80 80a12.1 12.1 0 0 1-17 0l-80-80a12 12 0 0 1 17-17L128 191l71.5-71.5a12 12 0 0 1 17 0zm-97 17a12.1 12.1 0 0 0 17 0l80-80a12 12 0 0 0-17-17L128 111L56.5 39.5a12 12 0 0 0-17 17z",fill:"currentColor"},null,-1),Io=[Lo];function Mo(e,t){return h(),T("svg",Ro,Io)}var No={name:"ph-caret-double-down-bold",render:Mo};const Oo={class:"flex items-center justify-center space-x-1 cursor-pointer","w:text":"gray-700 dark:gray-300 opacity-80"},Do={"w:font":"bold","w:text":"sm"},Fo=W({props:{direction:null,pageNumber:null},setup(e){return(t,n)=>{const o=Po,r=No;return h(),T("div",Oo,[e.direction==="up"?(h(),q(o,{key:0,style:{"font-size":"0.875rem"}})):ne("",!0),e.direction==="down"?(h(),q(r,{key:1,style:{"font-size":"0.875rem"}})):ne("",!0),p("div",Do,"\u52A0\u8F7D"+le(e.pageNumber)+"\u9875\u2026",1)])}}}),An=e=>(Le("data-v-2203ae9b"),e=e(),Ie(),e),zo={class:"flex"},Bo=An(()=>p("div",{class:"dash"},null,-1)),Uo={"w:p":"x-2"},Ho=An(()=>p("div",{class:"dash"},null,-1));function qo(e,t){return h(),T("div",zo,[Bo,p("div",Uo,[Ce(e.$slots,"default",{},void 0,!0)]),Ho])}const Wo={};var Go=ae(Wo,[["render",qo],["__scopeId","data-v-2203ae9b"]]);const Vo=W({props:{direction:{default:"top-bottom"},backgroundColorRgbHex:null,height:{default:"2rem"},zIndex:{type:[Number,Boolean]}},setup(e){const t=e;Re(d=>({"39b9b75e":n.value,"7df8f27e":e.height,"730a3305":l.value,"0688da06":B(s)}));let n=S(()=>t.direction==="top-bottom"?`calc(100% - ${t.height})`:0),o=C(t,"backgroundColorRgbHex"),r=S(()=>`${o.value}00`),l=S(()=>t.direction==="top-bottom"?`linear-gradient(${r.value}, ${o.value})`:`linear-gradient(${o.value}, ${r.value})`);const s=typeof t.zIndex=="number"?t.zIndex:t.zIndex?Xe.overflowMask:null;return(d,u)=>(h(),T("div"))}});var Mt=ae(Vo,[["__scopeId","data-v-0927980d"]]);function En(e){return e*parseFloat(getComputedStyle(document.documentElement).fontSize)}const Yo={key:0,"w:float":"right"},jo=["data-mode"],Qo=["src"],Ko=W({props:{imageUrl:null,backgroundColorRgbHex:null},setup(e){Re(c=>({"707c1c4f":s.value}));let t=x(null),n=x("thumbnail");function o(){n.value=n.value==="thumbnail"?"expanded":"thumbnail",n.value==="thumbnail"&&t.value.getBoundingClientRect().top<0&&(t.value.closest(".quest-post").scrollIntoView(),window.scrollBy(0,En(-2)))}let r=x({width:0,height:0});ie(()=>{Qe(t.value.querySelector("img"),c=>{r.value=c[0].contentRect})});let l=S(()=>r.value.width*2),s=S(()=>`${l.value}px`),d=x(null);function u(){d.value=null}return ie(()=>{t.value.querySelector("img").onerror=c=>{typeof c=="string"?d.value=`\u56FE\u7247\u52A0\u8F7D\u5931\u8D25\uFF1A${c}`:d.value="\u56FE\u7247\u52A0\u8F7D\u5931\u8D25\uFF01"}}),(c,v)=>{const g=Mt;return h(),T(pt,null,[d.value!==null?(h(),T("span",Yo,le(d.value),1)):ne("",!0),p("figure",{class:"relative",ref_key:"figureRef",ref:t,"data-mode":n.value,onClick:o},[n.value==="thumbnail"&&r.value.height>l.value?(h(),q(g,{key:0,"background-color-rgb-hex":e.backgroundColorRgbHex},null,8,["background-color-rgb-hex"])):ne("",!0),p("img",{src:e.imageUrl,loading:"lazy",onLoad:u},null,40,Qo)],8,jo)],64)}}});var Xo=ae(Ko,[["__scopeId","data-v-3e31d681"]]);function Zo(e){return`#${e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/).slice(1).map(t=>parseInt(t,10).toString(16).padStart(2,"0")).join("")}`}function ot(e){const t=document.createElement("div");t.className=`${e}`,document.body.appendChild(t);const n=Zo(window.getComputedStyle(t).getPropertyValue("color"));return t.remove(),n}const kn=(()=>({app:{background:{light:ot("text-white"),dark:ot("text-black")}},post:{background:{light:ot("text-post-background-color"),dark:ot("text-post-background-color-dark")}}}))();S(()=>kn.app.background[ft.value?"dark":"light"]);const He=S(()=>kn.post.background[ft.value?"dark":"light"]),$n=Symbol(),Cn=Symbol(),dn=Symbol(),Pn=Symbol(),Rn=Symbol(),Ln=Symbol();const Jo=e=>(Le("data-v-290e98c9"),e=e(),Ie(),e),er={class:"inline-block relative"},tr=["data-status"],nr=Jo(()=>p("span",{class:"px-0.5"},null,-1)),ar=W({props:{postId:null,nestLevel:null,siblingOrder:null},setup(e){const t=e;let n=C(t,"postId"),o=ke($n),r=x(null),l=x(null),s=ve(),d=S(()=>{const z="0.75rem",b=`${s.rootPostWidth}px`,O=`(${z} * ${t.nestLevel+1})`,_=`(0.2em * ${t.nestLevel})`;return`calc(${b} - ${O} - ${_})`}),u=function(b,O,_=100){let y=b,I=O,X=x({refLink:!1,refPost:!1}),he=S(()=>X.value.refLink||X.value.refPost),re=x(!1);fe(he,async be=>{be===!1&&(re.value=!0,await new Promise(R=>setTimeout(R,_)),re.value=!1)});let se=S(()=>he.value||re.value),de=x({width:0,height:0});ie(()=>{Qe(o.value,be=>{const{width:R,height:Me}=be[0].contentRect;de.value={width:R,height:Me}})});const F=sa(de,200);return fe([y,I,F],()=>{if(!o.value||!y.value||!I.value)return;const{top:be,left:R}=y.value.getBoundingClientRect(),{top:Me,left:M}=o.value.getBoundingClientRect();I.value.style.top=`${be-Me}px`,I.value.style.left=`${R-M}px`}),{onHovers:X,shouldFloat:se}}(r,l,100),c=C(u,"onHovers"),v=C(u,"shouldFloat"),g=x(!1),A=x(0),E=x(0),$=x(0);fe([l,g],()=>{var b,O;if(!l.value||!g.value)return;const z=l.value.querySelector(".quest-post-content-wrapper");for(const{heightRef:_,widthRef:y,el:I}of[{heightRef:A,widthRef:E,el:l.value},{heightRef:$,widthRef:null,el:z}])_.value=(b=I.clientHeight)!=null?b:0,y&&(y.value=(O=I.clientWidth)!=null?O:0),Qe(I,X=>{_.value=X[0].contentRect.height,y&&(y.value=X[0].contentRect.width)})},{immediate:!0});const L=En(15/4);let N=function(b,O){let _=O,y=x(!1),I=x(!1);fe(y,de=>{de||(I.value=!1)});let X=S(()=>y.value?I.value?"collapsed":"open":v.value?"floating":"closed"),he=S(()=>_.value>b),re=x(!1);function se(de){if(re.value=!1,!y.value)y.value=!0;else if(de==="link"){if(!he.value)return;I.value=X.value!=="collapsed"}else y.value=!1}return{displayStatus:X,isPinned:y,isCollapsed:I,isCollapsible:he,eagersToCollapse:re,onClick:se}}(L,$),oe=C(N,"displayStatus"),ee=C(N,"isPinned"),G=C(N,"isCollapsed"),U=C(N,"isCollapsible"),K=C(N,"eagersToCollapse"),D=C(N,"onClick"),ce=S(()=>{var z;return ee.value?(z=o.value)==null?void 0:z.querySelector(".relative.quest-post-ref-wrapper"):o.value});fe($,()=>{K.value&&U.value&&(G.value=!0,K.value=!1)}),ie(()=>{t.nestLevel===1&&(ee.value=!0,Ke(()=>{U.value?G.value=!0:K.value=!0}))});let P=ke(Cn),te=S(()=>Xe.post+(P.value-t.siblingOrder));return(z,b)=>{const O=Mt,_=Dn;return h(),T(pt,null,[p("span",{class:"ref-post-link",style:$e([{color:"#789922"},{cursor:oe.value==="open"?U.value?"zoom-out":"":"zoom-in"}]),"w:font":"mono","w:text":"sm",onClick:b[0]||(b[0]=y=>D.value("link")),onMouseenter:b[1]||(b[1]=y=>c.value.refLink=!0),onMouseleave:b[2]||(b[2]=y=>c.value.refLink=!1)},">>No."+le(n.value),37),(h(),q(ia,null,[o.value&&(v.value||ee.value)?(h(),T("div",{key:0,class:"ref-post-anchor",ref_key:"refPostAnchorRef",ref:r,style:$e(ee.value?{height:`${A.value}px`,width:`${E.value}px`}:void 0)},[(h(),q(la,{to:ce.value},[p("div",{class:"absolute",ref_key:"refPostRef",ref:l,onMouseenter:b[7]||(b[7]=y=>(c.value.refPost=!0,K.value=!1)),onMouseleave:b[8]||(b[8]=y=>c.value.refPost=!1),style:$e([{width:"max-content"},{zIndex:te.value,maxWidth:d.value}])},[j(_,{"post-id":n.value,"nest-level":e.nestLevel,"display-status":oe.value,onExpand:b[5]||(b[5]=y=>D.value("link")),onReady:b[6]||(b[6]=y=>g.value=!0)},{"head-left":ye(()=>[p("div",er,[G.value?(h(),q(O,{key:0,onClick:b[3]||(b[3]=y=>D.value("pin")),"w:cursor":"pointer",height:"1em","background-color-rgb-hex":B(He),"z-index":""},null,8,["background-color-rgb-hex"])):ne("",!0),p("span",{class:"pin-button","data-status":oe.value,"w:text":"xs",onClick:b[4]||(b[4]=y=>D.value("pin")),"w:cursor":"pointer"},"\u{1F4CC}",8,tr)]),nr]),_:1},8,["post-id","nest-level","display-status"])],36)],8,["to"]))],4)):ne("",!0)],1024))],64)}}});var or=ae(ar,[["__scopeId","data-v-290e98c9"]]);/*! @license DOMPurify 2.3.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.3.6/LICENSE */function rr(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}else return Array.from(e)}var sr=Object.hasOwnProperty,pn=Object.setPrototypeOf,lr=Object.isFrozen,ir=Object.getPrototypeOf,ur=Object.getOwnPropertyDescriptor,Q=Object.freeze,me=Object.seal,cr=Object.create,In=typeof Reflect!="undefined"&&Reflect,dt=In.apply,Lt=In.construct;dt||(dt=function(t,n,o){return t.apply(n,o)});Q||(Q=function(t){return t});me||(me=function(t){return t});Lt||(Lt=function(t,n){return new(Function.prototype.bind.apply(t,[null].concat(rr(n))))});var dr=ue(Array.prototype.forEach),fn=ue(Array.prototype.pop),Ye=ue(Array.prototype.push),it=ue(String.prototype.toLowerCase),vn=ue(String.prototype.match),xe=ue(String.prototype.replace),pr=ue(String.prototype.indexOf),fr=ue(String.prototype.trim),J=ue(RegExp.prototype.test),Et=vr(TypeError);function ue(e){return function(t){for(var n=arguments.length,o=Array(n>1?n-1:0),r=1;r<n;r++)o[r-1]=arguments[r];return dt(e,t,o)}}function vr(e){return function(){for(var t=arguments.length,n=Array(t),o=0;o<t;o++)n[o]=arguments[o];return Lt(e,n)}}function w(e,t){pn&&pn(e,null);for(var n=t.length;n--;){var o=t[n];if(typeof o=="string"){var r=it(o);r!==o&&(lr(t)||(t[n]=r),o=r)}e[o]=!0}return e}function Ee(e){var t=cr(null),n=void 0;for(n in e)dt(sr,e,[n])&&(t[n]=e[n]);return t}function rt(e,t){for(;e!==null;){var n=ur(e,t);if(n){if(n.get)return ue(n.get);if(typeof n.value=="function")return ue(n.value)}e=ir(e)}function o(r){return console.warn("fallback value for",r),null}return o}var mn=Q(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),kt=Q(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),$t=Q(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),mr=Q(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Ct=Q(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),hr=Q(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),hn=Q(["#text"]),_n=Q(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),Pt=Q(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),gn=Q(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),st=Q(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),_r=me(/\{\{[\s\S]*|[\s\S]*\}\}/gm),gr=me(/<%[\s\S]*|[\s\S]*%>/gm),yr=me(/^data-[\-\w.\u00B7-\uFFFF]/),br=me(/^aria-[\-\w]+$/),wr=me(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),xr=me(/^(?:\w+script|data):/i),Sr=me(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Tr=me(/^html$/i),je=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function pe(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}else return Array.from(e)}var Ar=function(){return typeof window=="undefined"?null:window},Er=function(t,n){if((typeof t=="undefined"?"undefined":je(t))!=="object"||typeof t.createPolicy!="function")return null;var o=null,r="data-tt-policy-suffix";n.currentScript&&n.currentScript.hasAttribute(r)&&(o=n.currentScript.getAttribute(r));var l="dompurify"+(o?"#"+o:"");try{return t.createPolicy(l,{createHTML:function(d){return d}})}catch{return console.warn("TrustedTypes policy "+l+" could not be created."),null}};function Mn(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ar(),t=function(a){return Mn(a)};if(t.version="2.3.6",t.removed=[],!e||!e.document||e.document.nodeType!==9)return t.isSupported=!1,t;var n=e.document,o=e.document,r=e.DocumentFragment,l=e.HTMLTemplateElement,s=e.Node,d=e.Element,u=e.NodeFilter,c=e.NamedNodeMap,v=c===void 0?e.NamedNodeMap||e.MozNamedAttrMap:c,g=e.HTMLFormElement,A=e.DOMParser,E=e.trustedTypes,$=d.prototype,L=rt($,"cloneNode"),N=rt($,"nextSibling"),oe=rt($,"childNodes"),ee=rt($,"parentNode");if(typeof l=="function"){var G=o.createElement("template");G.content&&G.content.ownerDocument&&(o=G.content.ownerDocument)}var U=Er(E,n),K=U?U.createHTML(""):"",D=o,ce=D.implementation,P=D.createNodeIterator,te=D.createDocumentFragment,z=D.getElementsByTagName,b=n.importNode,O={};try{O=Ee(o).documentMode?o.documentMode:{}}catch{}var _={};t.isSupported=typeof ee=="function"&&ce&&typeof ce.createHTMLDocument!="undefined"&&O!==9;var y=_r,I=gr,X=yr,he=br,re=xr,se=Sr,de=wr,F=null,be=w({},[].concat(pe(mn),pe(kt),pe($t),pe(Ct),pe(hn))),R=null,Me=w({},[].concat(pe(_n),pe(Pt),pe(gn),pe(st))),M=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),We=null,vt=null,Ft=!0,mt=!0,zt=!1,Ne=!1,Se=!1,ht=!1,_t=!1,Oe=!1,Je=!1,et=!1,Bt=!0,gt=!0,Ge=!1,De={},Fe=null,Ut=w({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Ht=null,qt=w({},["audio","video","img","source","image","track"]),yt=null,Wt=w({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),bt="http://www.w3.org/1998/Math/MathML",wt="http://www.w3.org/2000/svg",we="http://www.w3.org/1999/xhtml",tt=we,xt=!1,ze=void 0,Fn=["application/xhtml+xml","text/html"],zn="text/html",Te=void 0,Be=null,Bn=o.createElement("form"),Gt=function(a){return a instanceof RegExp||a instanceof Function},St=function(a){Be&&Be===a||((!a||(typeof a=="undefined"?"undefined":je(a))!=="object")&&(a={}),a=Ee(a),F="ALLOWED_TAGS"in a?w({},a.ALLOWED_TAGS):be,R="ALLOWED_ATTR"in a?w({},a.ALLOWED_ATTR):Me,yt="ADD_URI_SAFE_ATTR"in a?w(Ee(Wt),a.ADD_URI_SAFE_ATTR):Wt,Ht="ADD_DATA_URI_TAGS"in a?w(Ee(qt),a.ADD_DATA_URI_TAGS):qt,Fe="FORBID_CONTENTS"in a?w({},a.FORBID_CONTENTS):Ut,We="FORBID_TAGS"in a?w({},a.FORBID_TAGS):{},vt="FORBID_ATTR"in a?w({},a.FORBID_ATTR):{},De="USE_PROFILES"in a?a.USE_PROFILES:!1,Ft=a.ALLOW_ARIA_ATTR!==!1,mt=a.ALLOW_DATA_ATTR!==!1,zt=a.ALLOW_UNKNOWN_PROTOCOLS||!1,Ne=a.SAFE_FOR_TEMPLATES||!1,Se=a.WHOLE_DOCUMENT||!1,Oe=a.RETURN_DOM||!1,Je=a.RETURN_DOM_FRAGMENT||!1,et=a.RETURN_TRUSTED_TYPE||!1,_t=a.FORCE_BODY||!1,Bt=a.SANITIZE_DOM!==!1,gt=a.KEEP_CONTENT!==!1,Ge=a.IN_PLACE||!1,de=a.ALLOWED_URI_REGEXP||de,tt=a.NAMESPACE||we,a.CUSTOM_ELEMENT_HANDLING&&Gt(a.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(M.tagNameCheck=a.CUSTOM_ELEMENT_HANDLING.tagNameCheck),a.CUSTOM_ELEMENT_HANDLING&&Gt(a.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(M.attributeNameCheck=a.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),a.CUSTOM_ELEMENT_HANDLING&&typeof a.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(M.allowCustomizedBuiltInElements=a.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),ze=Fn.indexOf(a.PARSER_MEDIA_TYPE)===-1?ze=zn:ze=a.PARSER_MEDIA_TYPE,Te=ze==="application/xhtml+xml"?function(i){return i}:it,Ne&&(mt=!1),Je&&(Oe=!0),De&&(F=w({},[].concat(pe(hn))),R=[],De.html===!0&&(w(F,mn),w(R,_n)),De.svg===!0&&(w(F,kt),w(R,Pt),w(R,st)),De.svgFilters===!0&&(w(F,$t),w(R,Pt),w(R,st)),De.mathMl===!0&&(w(F,Ct),w(R,gn),w(R,st))),a.ADD_TAGS&&(F===be&&(F=Ee(F)),w(F,a.ADD_TAGS)),a.ADD_ATTR&&(R===Me&&(R=Ee(R)),w(R,a.ADD_ATTR)),a.ADD_URI_SAFE_ATTR&&w(yt,a.ADD_URI_SAFE_ATTR),a.FORBID_CONTENTS&&(Fe===Ut&&(Fe=Ee(Fe)),w(Fe,a.FORBID_CONTENTS)),gt&&(F["#text"]=!0),Se&&w(F,["html","head","body"]),F.table&&(w(F,["tbody"]),delete We.tbody),Q&&Q(a),Be=a)},Vt=w({},["mi","mo","mn","ms","mtext"]),Yt=w({},["foreignobject","desc","title","annotation-xml"]),nt=w({},kt);w(nt,$t),w(nt,mr);var Tt=w({},Ct);w(Tt,hr);var Un=function(a){var i=ee(a);(!i||!i.tagName)&&(i={namespaceURI:we,tagName:"template"});var f=it(a.tagName),k=it(i.tagName);if(a.namespaceURI===wt)return i.namespaceURI===we?f==="svg":i.namespaceURI===bt?f==="svg"&&(k==="annotation-xml"||Vt[k]):Boolean(nt[f]);if(a.namespaceURI===bt)return i.namespaceURI===we?f==="math":i.namespaceURI===wt?f==="math"&&Yt[k]:Boolean(Tt[f]);if(a.namespaceURI===we){if(i.namespaceURI===wt&&!Yt[k]||i.namespaceURI===bt&&!Vt[k])return!1;var V=w({},["title","style","font","a","script"]);return!Tt[f]&&(V[f]||!nt[f])}return!1},_e=function(a){Ye(t.removed,{element:a});try{a.parentNode.removeChild(a)}catch{try{a.outerHTML=K}catch{a.remove()}}},jt=function(a,i){try{Ye(t.removed,{attribute:i.getAttributeNode(a),from:i})}catch{Ye(t.removed,{attribute:null,from:i})}if(i.removeAttribute(a),a==="is"&&!R[a])if(Oe||Je)try{_e(i)}catch{}else try{i.setAttribute(a,"")}catch{}},Qt=function(a){var i=void 0,f=void 0;if(_t)a="<remove></remove>"+a;else{var k=vn(a,/^[\r\n\t ]+/);f=k&&k[0]}ze==="application/xhtml+xml"&&(a='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+a+"</body></html>");var V=U?U.createHTML(a):a;if(tt===we)try{i=new A().parseFromString(V,ze)}catch{}if(!i||!i.documentElement){i=ce.createDocument(tt,"template",null);try{i.documentElement.innerHTML=xt?"":V}catch{}}var Y=i.body||i.documentElement;return a&&f&&Y.insertBefore(o.createTextNode(f),Y.childNodes[0]||null),tt===we?z.call(i,Se?"html":"body")[0]:Se?i.documentElement:Y},Kt=function(a){return P.call(a.ownerDocument||a,a,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT,null,!1)},Hn=function(a){return a instanceof g&&(typeof a.nodeName!="string"||typeof a.textContent!="string"||typeof a.removeChild!="function"||!(a.attributes instanceof v)||typeof a.removeAttribute!="function"||typeof a.setAttribute!="function"||typeof a.namespaceURI!="string"||typeof a.insertBefore!="function")},Ve=function(a){return(typeof s=="undefined"?"undefined":je(s))==="object"?a instanceof s:a&&(typeof a=="undefined"?"undefined":je(a))==="object"&&typeof a.nodeType=="number"&&typeof a.nodeName=="string"},ge=function(a,i,f){!_[a]||dr(_[a],function(k){k.call(t,i,f,Be)})},Xt=function(a){var i=void 0;if(ge("beforeSanitizeElements",a,null),Hn(a)||vn(a.nodeName,/[\u0080-\uFFFF]/))return _e(a),!0;var f=Te(a.nodeName);if(ge("uponSanitizeElement",a,{tagName:f,allowedTags:F}),!Ve(a.firstElementChild)&&(!Ve(a.content)||!Ve(a.content.firstElementChild))&&J(/<[/\w]/g,a.innerHTML)&&J(/<[/\w]/g,a.textContent)||f==="select"&&J(/<template/i,a.innerHTML))return _e(a),!0;if(!F[f]||We[f]){if(!We[f]&&Jt(f)&&(M.tagNameCheck instanceof RegExp&&J(M.tagNameCheck,f)||M.tagNameCheck instanceof Function&&M.tagNameCheck(f)))return!1;if(gt&&!Fe[f]){var k=ee(a)||a.parentNode,V=oe(a)||a.childNodes;if(V&&k)for(var Y=V.length,H=Y-1;H>=0;--H)k.insertBefore(L(V[H],!0),N(a))}return _e(a),!0}return a instanceof d&&!Un(a)||(f==="noscript"||f==="noembed")&&J(/<\/no(script|embed)/i,a.innerHTML)?(_e(a),!0):(Ne&&a.nodeType===3&&(i=a.textContent,i=xe(i,y," "),i=xe(i,I," "),a.textContent!==i&&(Ye(t.removed,{element:a.cloneNode()}),a.textContent=i)),ge("afterSanitizeElements",a,null),!1)},Zt=function(a,i,f){if(Bt&&(i==="id"||i==="name")&&(f in o||f in Bn))return!1;if(!(mt&&!vt[i]&&J(X,i))){if(!(Ft&&J(he,i))){if(!R[i]||vt[i]){if(!(Jt(a)&&(M.tagNameCheck instanceof RegExp&&J(M.tagNameCheck,a)||M.tagNameCheck instanceof Function&&M.tagNameCheck(a))&&(M.attributeNameCheck instanceof RegExp&&J(M.attributeNameCheck,i)||M.attributeNameCheck instanceof Function&&M.attributeNameCheck(i))||i==="is"&&M.allowCustomizedBuiltInElements&&(M.tagNameCheck instanceof RegExp&&J(M.tagNameCheck,f)||M.tagNameCheck instanceof Function&&M.tagNameCheck(f))))return!1}else if(!yt[i]){if(!J(de,xe(f,se,""))){if(!((i==="src"||i==="xlink:href"||i==="href")&&a!=="script"&&pr(f,"data:")===0&&Ht[a])){if(!(zt&&!J(re,xe(f,se,"")))){if(f)return!1}}}}}}return!0},Jt=function(a){return a.indexOf("-")>0},en=function(a){var i=void 0,f=void 0,k=void 0,V=void 0;ge("beforeSanitizeAttributes",a,null);var Y=a.attributes;if(!!Y){var H={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:R};for(V=Y.length;V--;){i=Y[V];var at=i,Z=at.name,tn=at.namespaceURI;if(f=fr(i.value),k=Te(Z),H.attrName=k,H.attrValue=f,H.keepAttr=!0,H.forceKeepAttr=void 0,ge("uponSanitizeAttribute",a,H),f=H.attrValue,!H.forceKeepAttr&&(jt(Z,a),!!H.keepAttr)){if(J(/\/>/i,f)){jt(Z,a);continue}Ne&&(f=xe(f,y," "),f=xe(f,I," "));var Wn=Te(a.nodeName);if(!!Zt(Wn,k,f))try{tn?a.setAttributeNS(tn,Z,f):a.setAttribute(Z,f),fn(t.removed)}catch{}}}ge("afterSanitizeAttributes",a,null)}},qn=function m(a){var i=void 0,f=Kt(a);for(ge("beforeSanitizeShadowDOM",a,null);i=f.nextNode();)ge("uponSanitizeShadowNode",i,null),!Xt(i)&&(i.content instanceof r&&m(i.content),en(i));ge("afterSanitizeShadowDOM",a,null)};return t.sanitize=function(m,a){var i=void 0,f=void 0,k=void 0,V=void 0,Y=void 0;if(xt=!m,xt&&(m="<!-->"),typeof m!="string"&&!Ve(m)){if(typeof m.toString!="function")throw Et("toString is not a function");if(m=m.toString(),typeof m!="string")throw Et("dirty is not a string, aborting")}if(!t.isSupported){if(je(e.toStaticHTML)==="object"||typeof e.toStaticHTML=="function"){if(typeof m=="string")return e.toStaticHTML(m);if(Ve(m))return e.toStaticHTML(m.outerHTML)}return m}if(ht||St(a),t.removed=[],typeof m=="string"&&(Ge=!1),Ge){if(m.nodeName){var H=Te(m.nodeName);if(!F[H]||We[H])throw Et("root node is forbidden and cannot be sanitized in-place")}}else if(m instanceof s)i=Qt("<!---->"),f=i.ownerDocument.importNode(m,!0),f.nodeType===1&&f.nodeName==="BODY"||f.nodeName==="HTML"?i=f:i.appendChild(f);else{if(!Oe&&!Ne&&!Se&&m.indexOf("<")===-1)return U&&et?U.createHTML(m):m;if(i=Qt(m),!i)return Oe?null:et?K:""}i&&_t&&_e(i.firstChild);for(var at=Kt(Ge?m:i);k=at.nextNode();)k.nodeType===3&&k===V||Xt(k)||(k.content instanceof r&&qn(k.content),en(k),V=k);if(V=null,Ge)return m;if(Oe){if(Je)for(Y=te.call(i.ownerDocument);i.firstChild;)Y.appendChild(i.firstChild);else Y=i;return R.shadowroot&&(Y=b.call(n,Y,!0)),Y}var Z=Se?i.outerHTML:i.innerHTML;return Se&&F["!doctype"]&&i.ownerDocument&&i.ownerDocument.doctype&&i.ownerDocument.doctype.name&&J(Tr,i.ownerDocument.doctype.name)&&(Z="<!DOCTYPE "+i.ownerDocument.doctype.name+`>
`+Z),Ne&&(Z=xe(Z,y," "),Z=xe(Z,I," ")),U&&et?U.createHTML(Z):Z},t.setConfig=function(m){St(m),ht=!0},t.clearConfig=function(){Be=null,ht=!1},t.isValidAttribute=function(m,a,i){Be||St({});var f=Te(m),k=Te(a);return Zt(f,k,i)},t.addHook=function(m,a){typeof a=="function"&&(_[m]=_[m]||[],Ye(_[m],a))},t.removeHook=function(m){_[m]&&fn(_[m])},t.removeHooks=function(m){_[m]&&(_[m]=[])},t.removeAllHooks=function(){_={}},t}var kr=Mn();const $r={class:"prose","w:text":"left","w:break":"words"},Cr={"w:whitespace":"pre-line","w:leading":"snug"},Pr=["innerHTML"],Rr=W({props:{content:null,nestLevel:null},setup(e){const t=e;let n=C(t,"content"),o=S(()=>kr.sanitize(n.value)),r=S(()=>o.value.indexOf("<font")>=0),l=x(0);Pe(Cn,ut(l));let s=S(()=>{const d=new DOMParser().parseFromString(`<div>${o.value}</div>`,"text/html"),u=d.querySelectorAll('font[color="#789922"]');let c=1;return u.forEach(v=>{if(!/>>No\.\d+/.test(v.textContent))return;const g=Number(v.textContent.split(".")[1]),A=document.createElement("quest-post-ref-link");A.setAttribute(":post-id",String(g)),A.setAttribute(":nest-level",String(t.nestLevel+1)),A.setAttribute(":sibling-order",String(c)),c++,v.parentElement.replaceChild(A,v)}),l.value=c-1,d.documentElement.children[1]});return(d,u)=>(h(),T("div",$r,[p("div",Cr,[r.value?(h(),q(ua({template:s.value,components:{QuestPostRefLink:or}}),{key:0})):(h(),T("div",{key:1,innerHTML:o.value},null,8,Pr))])]))}});const Ze=e=>(Le("data-v-63887ae8"),e=e(),Ie(),e),Lr={class:"quest-post-wrapper relative"},Ir=Ze(()=>p("div",{"w:clear":"both"},null,-1)),Mr=Ze(()=>p("div",{class:"h-1"},null,-1)),Nr=Ze(()=>p("hr",{"w:m":"x-0.5","w:border":"dashed gray-400"},null,-1)),Or={class:"quest-post-content-wrapper"},Dr=Ze(()=>p("div",{class:"relative quest-post-ref-wrapper"},null,-1)),Fr=Ze(()=>p("div",{"w:clear":"both"},null,-1)),zr=W({props:{nestLevel:null,displayStatus:null,backgroundColorRgbHex:null},emits:["expand"],setup(e,{emit:t}){const n=e;Re(E=>({f2fc055a:e.backgroundColorRgbHex,"24765530":B(A)}));let o=S(()=>n.nestLevel>0),r=x(null);Pe($n,ut(r));function l(E){n.displayStatus==="collapsed"&&(t("expand"),E.target instanceof HTMLElement&&E.target.classList.contains("ref-post-link")||E.stopPropagation())}let s=x(null),d=ke("offsetTop",x(0)),u=x(0);ie(()=>Qe(s.value,([E])=>u.value=E.contentRect.height));let c=x(null),v=function($,L,N,oe){let ee=L,G=$,U=N,K=oe,D=x(null),ce=S(()=>U.value+K.value),P=S(()=>{var b;return Math.max((b=D.value)!=null?b:ce.value,U.value)}),te=x(null);const z=b=>{if(!G.value){window.removeEventListener("scroll",z);return}const O=G.value.getBoundingClientRect();D.value=O.bottom};return ca(()=>window.removeEventListener("scroll",z)),ie(()=>ct(ee.value,([{intersectionRatio:b}])=>{const O=ee.value.getBoundingClientRect();O.top>0&&O.bottom>window.innerHeight/2||(b===1?te.value="onScreen":b===0?te.value==="aboveScreen"?te.value="partiallyCoveredByTopEdge":te.value="aboveScreen":te.value="partiallyCoveredByTopEdge")},{threshold:[0,1]})),fe(te,()=>{switch(te.value){case"onScreen":window.removeEventListener("scroll",z),D.value=null;break;case"aboveScreen":window.removeEventListener("scroll",z),D.value=0;break;case"partiallyCoveredByTopEdge":window.addEventListener("scroll",z);break}}),{childTop:P}}(s,c,d,u),g=C(v,"childTop");Pe("offsetTop",ut(g));let A=Xe.postHead;return(E,$)=>{const L=Mt;return h(),T("article",{class:Ue(["quest-post container relative rounded-md",B(o)?"!border-gray-400 px-1":"px-4 pt-0.5"]),"w:border":"1 dark:gray"},[p("div",Lr,[p("div",{class:"quest-post-head sticky",ref_key:"headRef",ref:s,"w:text":"sm","w:p":"t-1",style:$e({top:`${d.value}px`})},[Ce(E.$slots,"head",{},void 0,!0),Ir,Mr,Nr],4),p("div",{class:Ue(B(o)?"h-1.5":"h-1")},null,2),p("div",{class:"relative",ref_key:"postContentDivRef",ref:r},[e.displayStatus==="collapsed"?(h(),q(L,{key:0,onClickCapture:l,"background-color-rgb-hex":e.backgroundColorRgbHex,"z-index":""},null,8,["background-color-rgb-hex"])):ne("",!0),p("div",{class:Ue(e.displayStatus==="collapsed"?"max-h-15 overflow-hidden":void 0)},[p("div",Or,[Dr,p("div",{onClickCapture:l,class:Ue((B(o),"px-2"))},[Ce(E.$slots,"content",{},void 0,!0),p("div",{class:Ue(B(o)?"h-2":"h-3")},null,2)],34)])],2)],512),Fr,p("div",{ref_key:"sentinelDiv",ref:c,style:$e([{position:"absolute",left:"0",right:"0",visibility:"hidden"},{height:`${u.value}px`,bottom:`${d.value}px`}])},null,4)])],2)}}});var Nn=ae(zr,[["__scopeId","data-v-63887ae8"]]);const Nt=e=>(Le("data-v-053ad1d9"),e=e(),Ie(),e),Br={"w:float":"left"},Ur=Nt(()=>p("span",{class:"px-1.5"},null,-1)),Hr={"w:font":"mono"},qr=Nt(()=>p("span",{class:"px-3"},null,-1)),Wr={"w:font":"mono","w:float":"right"},Gr={"w:text":"xs"},Vr=It("("),Yr=["href"],jr=It(")"),Qr={key:0},Kr=Nt(()=>p("div",{class:"clear-both"},null,-1)),Xr=W({props:{post:null,nestLevel:null,displayStatus:null},emits:["expand"],setup(e,{emit:t}){const n=e;Re(A=>({"09c311ec":B(He)}));let o=S(()=>n.nestLevel>0),r=ke(Ln),l=C(n,"post");const s=ve();let d=S(()=>{const A=l.value.createdAtUtc+288e3,E=new Date(A*1e3).toISOString(),[$,L]=E.split("T"),[N]=L.split(".");return`${$} ${N}`}),u=ke(Pn),c=ke(Rn),v=x(null),g=x(null);return ie(()=>{if(n.nestLevel>0)return;let A=!0;ct(v,([{intersectionRatio:$,boundingClientRect:{y:L}}])=>{if(A){A=!1;return}s.isInAutoScrolling||$<1&&v.value.getBoundingClientRect().top<0&&(r.value&&(u.value=r.value),c.value=l.value.postId)},{threshold:1});let E=null;ct(g,([{intersectionRatio:$,boundingClientRect:{y:L}}])=>{if(E===null||E>window.innerHeight){E=L;return}E=L,!s.isInAutoScrolling&&$===1&&(r.value&&(u.value=r.value),c.value=l.value.postId)},{threshold:1})}),ie(()=>{n.nestLevel===0&&Ke(()=>{const A=ve();A.postToScrollTo===n.post.postId&&(v.value.scrollIntoView(),A.postToScrollTo=null)})}),(A,E)=>{const $=Xo,L=Rr;return h(),T("div",null,[p("div",{ref_key:"topSentinelDiv",ref:v},null,512),l.value?(h(),q(Nn,Rt({key:0,id:o.value?void 0:"id-"+l.value.postId,"nest-level":e.nestLevel,"display-status":e.displayStatus,"background-color-rgb-hex":B(He),onExpand:E[0]||(E[0]=N=>t("expand"))},A.$attrs),{head:ye(()=>[p("div",Br,[Ce(A.$slots,"head-left",{},void 0,!0),p("span",{"w:font":"mono",class:Ue(l.value.isPostOwner?"font-black":"font-normal")},le(l.value.userId),3),Ur,p("span",Hr,le(d.value),1),qr]),p("div",Wr,[p("span",null,"No."+le(l.value.postId),1),p("span",Gr,[Vr,p("a",{class:"anchor-link",href:"#id-"+l.value.postId},"#"+le(l.value.floorNumber),9,Yr),jr])])]),content:ye(()=>{var N;return[p("div",null,[l.value.imageUrl?(h(),T("div",Qr,[j($,{"image-url":l.value.imageUrl,"background-color-rgb-hex":B(He)},null,8,["image-url","background-color-rgb-hex"])])):ne("",!0),j(L,{content:l.value.content,"nest-level":(N=e.nestLevel)!=null?N:0},null,8,["content","nest-level"]),Kr])]}),_:3},16,["id","nest-level","display-status","background-color-rgb-hex"])):ne("",!0),p("div",{ref_key:"bottomSentinelDiv",ref:g},null,512)])}}});var Zr=ae(Xr,[["__scopeId","data-v-053ad1d9"]]);function On(e,t,n){const o=ve();return{postId:e.id,floorNumber:n,createdAtUtc:e.created_at,userId:e.user_id,isPostOwner:e.user_id===t.postOwner,content:e.content,imageUrl:e.attachment_base?(()=>{const l=`${e.attachment_base}${e.attachment_extension}`.split("/")[1],s=qe.convertIdToFolderName(t.id);return`${o.lfsAssetBaseUrl}/${s}/attachments/${l}`})():void 0}}const Ot=e=>(Le("data-v-09e02cba"),e=e(),Ie(),e),Jr={"w:float":"left"},es={"w:font":"mono","w:float":"right"},ts={key:0,"w:text":"rose-600 bold"},ns=Ot(()=>p("span",{"w:text":"lg"},"\u672C\u4E32\u53F7\u5BF9\u5E94\u5185\u5BB9\u672A\u88AB\u6536\u5F55\u2026",-1)),as=Ot(()=>p("br",null,null,-1)),os=Ot(()=>p("span",{"w:text":"sm"},"\u6B64\u5185\u5BB9\u53EF\u80FD\u6765\u81EA\u5176\u4ED6\u4E32\uFF0C\u6216\u5728\u6536\u5F55\u524D\u5C31\u5DF2\u6D88\u5931\u3002",-1)),rs=[ns,as,os],ss={key:1,"w:text":"gray-400 bold"},ls=W({props:{post:null,postId:null,nestLevel:null,displayStatus:{default:"open"}},emits:["expand","ready"],setup(e,{emit:t}){const n=e;Re(d=>({"782c8d3b":B(He)}));let o=ke(dn,x(!1)),r=S(()=>o.value||n.displayStatus==="collapsed");Pe(dn,ut(r));const l=ve();let s=x("loading");return fe(n,()=>{if(n.post){s.value=n.post,t("ready");return}new Promise(async()=>{const d=await l.currentQuest.getRefPost(n.postId);if(!d)console.debug(`\u4E32 ${n.postId} \u4E0D\u5B58\u5728\u4E8E\u6570\u636E\u4E2D`),s.value="lost";else{const u=l.currentQuest;s.value=On(d,u,u.postFloorLookup.get(d.id))}Ke(()=>t("ready"))})},{immediate:!0}),(d,u)=>{var v,g;const c=Zr;return s.value==="loading"||s.value==="lost"?(h(),q(Nn,Rt({key:0,"nest-level":(v=e.nestLevel)!=null?v:0,"display-status":e.displayStatus,"background-color-rgb-hex":B(He),onExpand:u[0]||(u[0]=A=>t("expand"))},d.$attrs),{head:ye(()=>[p("div",Jr,[Ce(d.$slots,"head-left",{},void 0,!0)]),p("div",es,[p("span",null,"No."+le(e.postId),1)])]),content:ye(()=>[s.value==="lost"?(h(),T("span",ts,rs)):(h(),T("span",ss,"\u52A0\u8F7D\u4E2D\u2026"))]),_:3},16,["nest-level","display-status","background-color-rgb-hex"])):(h(),q(c,Rt({key:1,post:s.value,"nest-level":(g=e.nestLevel)!=null?g:0,"display-status":e.displayStatus,onExpand:u[1]||(u[1]=A=>t("expand"))},d.$attrs),{"head-left":ye(()=>[Ce(d.$slots,"head-left",{},void 0,!0)]),_:3},16,["post","nest-level","display-status"]))}}});var Dn=ae(ls,[["__scopeId","data-v-09e02cba"]]);const is=["id"],us={class:"post-page-bar"},cs={"w:font":"mono"},ds=p("div",{"w:h":"2"},null,-1),ps={key:1},fs=p("span",null,"\u9875\u9762\u52A0\u8F7D\u4E2D\u2026",-1),vs=[fs],ms=W({props:{props:null},emits:["ready"],setup(e,{emit:t}){const n=e;let o=S(()=>n.props.type==="page"?n.props.page:null);Pe(Ln,o);let r=S(()=>n.props.type==="page"?`${n.props.page}\u9875`:"?");const l=ve();let s=x([]);fe(C(n,"props"),async()=>{const u=l.currentQuest,c=await u.getPage(n.props.page);s.value=c.map(v=>On(v,u,u.postFloorLookup.get(v.id)))},{immediate:!0});let d=x(null);return ie(()=>{Qe(d,u=>{l.rootPostWidth=u[0].contentRect.width})}),fe(s,()=>{s.value&&Ke(()=>t("ready"))}),(u,c)=>{const v=Go;return h(),T("div",{class:"post-page",id:o.value!==null?`page-${o.value}`:void 0},[p("div",us,[j(v,null,{default:ye(()=>[p("span",cs,le(r.value),1)]),_:1})]),ds,s.value?(h(),T("div",{key:0,class:"post-list",ref_key:"postListRef",ref:d,"w:space":"y-1"},[(h(!0),T(pt,null,bn(s.value,(g,A)=>(h(),q(Dn,{key:g.postId,post:g,style:$e({zIndex:B(Xe).post+s.value.length-A})},null,8,["post","style"]))),128))],512)):(h(),T("div",ps,vs))],8,is)}}}),hs={key:0,"w:h":"2"},_s=W({props:{pageStart:null,pageEnd:null,pageCurrent:null},emits:["updated"],setup(e,{emit:t}){const n=e;let o=S(()=>function*(){for(let s=n.pageStart;s<=n.pageEnd;s++)yield s});const r=new Map;fe([C(n,"pageStart"),C(n,"pageEnd")],()=>{for(const s of[...r.keys()])(s<n.pageStart||s>n.pageEnd)&&r.delete(s);for(let s=n.pageStart;s<=n.pageEnd;s++)r.has(s)||r.set(s,"loading")},{immediate:!0});function l(s){r.set(s,"ready"),t("updated",r)}return(s,d)=>{const u=ms;return h(!0),T(pt,null,bn(o.value(),(c,v)=>(h(),T("div",{key:c},[Number(v)!==0?(h(),T("div",hs)):ne("",!0),j(u,{props:{type:"page",page:c},style:$e({zIndex:-c}),onReady:g=>l(c)},null,8,["props","style","onReady"])]))),128)}}});function gs(e){if(e.durationMs<=0)return window.scrollTo(window.screenX,e.finalY),e.onComplete(),null;const t=window.scrollY,n=e.finalY-t;let o=null,r=!1;const l=()=>{r=!0};return window.requestAnimationFrame(function s(d){if(r)return;o||(o=d);const u=d-o,c=Math.min(u/e.durationMs,1);window.scrollTo(window.screenX,t+n*c),u<e.durationMs?window.requestAnimationFrame(s):window.requestAnimationFrame(e.onComplete)}),l}const Dt=e=>(Le("data-v-51a22f11"),e=e(),Ie(),e),ys={key:0,class:"max-w-2xl mx-auto"},bs=Dt(()=>p("hr",null,null,-1)),ws=Dt(()=>p("div",{"w:h":"2"},null,-1)),xs=Dt(()=>p("div",{"w:h":"2"},null,-1)),Ss=W({setup(e){var O;const n=wn().params;let o=xn(Ae({},n)),r=C(o,"id"),l=C(o,"page");l.value=(O=l.value)!=null?O:"1";const s=ve();new Promise(async()=>{await Sn(C(s,"isInitialized")).toBe(!0),s.loadCurrentQuest(r.value)});let d=S(()=>s.currentQuest!==null),u=x(Number(l.value)),c=x(null);Pe(Pn,u),Pe(Rn,c),un([u,c],()=>{history.replaceState({},"",String(u.value)),history.replaceState({},"",c.value?`#id-${c.value}`:"")},{throttle:300});let v=x(u.value),g=x(u.value),A=S(()=>{var _;return(_=s.currentQuest)==null?void 0:_.postCount}),E=S(()=>{var _;return A.value?((((_=A.value)!=null?_:1)-1)/19|0)+1:null}),$=S(()=>{var _;return g.value<((_=E.value)!=null?_:0)});function L(_){return document.querySelector(`#page-${_}`)}let N=null,oe;function ee(){N=L(v.value).offsetTop,v.value--}let G=x(new Map);function U(_){if(G.value=_,oe&&(window.scrollTo(window.scrollX,oe),oe=null),N!==null){const I=L(v.value+1).offsetTop-N;window.scrollBy({top:I}),N=null}requestAnimationFrame(()=>ce())}let K=null,D=null;function ce(_=null,y=null){if(_===null){if(!D)return;_=D.pageToJumpTo,y=D.jumpToPageOptions}if(G.value.get(_)!=="ready"){D={pageToJumpTo:_,jumpToPageOptions:y};return}else D=null;K&&(K(),K=null),Ae({behavior:"smooth"},y).behavior==="auto"?L(_).scrollIntoView():(s.isInAutoScrolling=!0,K=gs({finalY:L(_).getBoundingClientRect().top+window.scrollY,durationMs:300,onComplete:()=>{s.isInAutoScrolling=!1}}))}let P=x(null),te=S(()=>P.value===null?0:G.value.get(P.value)!=="ready"?500:0);un(P,()=>{if(P.value!==null){if(u.value=P.value,!(P.value>=v.value&&P.value<=g.value))if(P.value===v.value-1)v.value=P.value,g.value>v.value+9&&(g.value=v.value+9);else if(P.value===g.value+1){if(g.value=P.value,g.value>v.value+9){const _=L(v.value).getBoundingClientRect().top,y=L(g.value-9).getBoundingClientRect().top;oe=window.scrollY-(y-_),v.value=g.value-9}}else v.value=P.value,g.value=P.value,window.scrollTo({top:0});c.value=null,ce(P.value),P.value=null}},{throttle:te});function z(_,y){P.value=_}let b=x(null);return ie(()=>{ct(b,([{intersectionRatio:_}])=>{G.value.get(g.value)==="ready"&&_>0&&g.value++},{threshold:[0]})}),(_,y)=>{var re;const I=Ao,X=Fo,he=_s;return d.value?(h(),T("div",ys,[j(Tn,{class:"page-control bottom-2 sm:bottom-6"},{default:ye(()=>[j(I,{"current-page":P.value||u.value,max:E.value,"page-statuses":G.value,onPageChangeRequired:y[0]||(y[0]=se=>z(se))},null,8,["current-page","max","page-statuses"])]),_:1}),It(le((re=B(s).currentQuest)==null?void 0:re.name),1),bs,v.value-1>0?(h(),q(X,{key:0,direction:"up","page-number":v.value-1,onClick:ee},null,8,["page-number"])):ne("",!0),ws,j(he,{"page-start":v.value,"page-end":g.value,"page-current":u.value,onUpdated:y[1]||(y[1]=se=>U(se))},null,8,["page-start","page-end","page-current"]),xs,$.value?(h(),q(X,{key:1,direction:"down","page-number":g.value+1,onClick:y[2]||(y[2]=se=>g.value++)},null,8,["page-number"])):ne("",!0),p("div",{ref_key:"autoLoadNextPageSentinelDiv",ref:b,"w:m":"b-8"},null,512)])):ne("",!0)}}});var Ts=ae(Ss,[["__scopeId","data-v-51a22f11"]]);const As=W({setup(e){const t=wn(),n=da(),o=t.params;let r=xn(Ae({},o)),l=C(r,"folder"),s=C(r,"quest"),d=C(r,"page");const u=ve();return new Promise(async()=>{await Sn(C(u,"isInitialized")).toBe(!0);const c=u.convertLegacyPathToId(l.value,s.value);n.replace({path:`${u.entrypoint}/quests/${c}/pages/${d.value}`,params:t.params,hash:t.hash})}),()=>{}}});var Es=[{path:`${lt}/quests/:id/pages/:page`,component:Ts},{path:`${lt}/quests/:id`,redirect:e=>{const t=e.path.endsWith("/")?e.path:`${e.path}/`;return At(Ae({},e),{path:`${t}pages/1`})}},{path:`${lt}/folder-:folder/quest-:quest/:page`,component:As}];const ks=to(Es);pa(ao,{routes:ks,scrollBehavior:(e,t,n)=>{if(e.hash){const o=/^#id\-(\d+)$/.exec(e.hash);if(o){const r=ve();r.postToScrollTo=Number(o[1])}}}},e=>{Object.values({"./modules/i18n.ts":ga,"./modules/nprogress.ts":ba,"./modules/pinia.ts":xa}).map(t=>{var n;return(n=t.install)==null?void 0:n.call(t,e)})});
