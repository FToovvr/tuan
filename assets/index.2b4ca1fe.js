var Gn=Object.defineProperty,Vn=Object.defineProperties;var Yn=Object.getOwnPropertyDescriptors;var nn=Object.getOwnPropertySymbols;var jn=Object.prototype.hasOwnProperty,Qn=Object.prototype.propertyIsEnumerable;var an=(e,t,n)=>t in e?Gn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Te=(e,t)=>{for(var n in t||(t={}))jn.call(t,n)&&an(e,n,t[n]);if(nn)for(var n of nn(t))Qn.call(t,n)&&an(e,n,t[n]);return e},At=(e,t)=>Vn(e,Yn(t));import{c as Kn,N as on,a as Xn,o as _,b as S,d as p,e as Zn,u as Jn,f as ea,g as G,h as ta,i as U,j as W,k as Q,l as Pe,r as $e,m as yn,w as _e,n as na,P as rn,p as aa,q as oa,s as ra,t as P,v as x,x as b,y as se,z as sn,A as ln,B as re,C as Re,D as Le,E as dt,F as ne,G as je,H as pt,I as Ee,J as pe,K as sa,L as ke,T as la,M as ia,O as Ce,Q as it,R as ua,S as ca,U as ut,V as ze,W as Rt,X as It,Y as bn,Z as wn,_ as xn,$ as Sn,a0 as un,a1 as da,a2 as pa}from"./vendor.8f5ee17f.js";const fa=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const l of r)if(l.type==="childList")for(const s of l.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&o(s)}).observe(document,{childList:!0,subtree:!0});function n(r){const l={};return r.integrity&&(l.integrity=r.integrity),r.referrerpolicy&&(l.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?l.credentials="include":r.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function o(r){if(r.ep)return;r.ep=!0;const l=n(r);fetch(r.href,l)}};fa();var va={button:{about:e=>{const{normalize:t}=e;return t(["\u5173\u4E8E"])},back:e=>{const{normalize:t}=e;return t(["\u8FD4\u56DE"])},go:e=>{const{normalize:t}=e;return t(["\u786E\u5B9A"])},home:e=>{const{normalize:t}=e;return t(["\u9996\u9875"])},toggle_dark:e=>{const{normalize:t}=e;return t(["\u5207\u6362\u6DF1\u8272\u6A21\u5F0F"])},toggle_langs:e=>{const{normalize:t}=e;return t(["\u5207\u6362\u8BED\u8A00"])}},intro:{desc:e=>{const{normalize:t}=e;return t(["\u56FA\u6267\u5DF1\u89C1\u7684 Vite \u9879\u76EE\u6A21\u677F"])},"dynamic-route":e=>{const{normalize:t}=e;return t(["\u52A8\u6001\u8DEF\u7531\u6F14\u793A"])},hi:e=>{const{normalize:t,interpolate:n,named:o}=e;return t(["\u4F60\u597D\uFF0C",n(o("name"))])},aka:e=>{const{normalize:t}=e;return t(["\u4E5F\u53EB"])},"whats-your-name":e=>{const{normalize:t}=e;return t(["\u8F93\u5165\u4F60\u7684\u540D\u5B57"])}},"not-found":e=>{const{normalize:t}=e;return t(["\u672A\u627E\u5230\u9875\u9762"])}},ma=Object.freeze(Object.defineProperty({__proto__:null,default:va},Symbol.toStringTag,{value:"Module"}));const ha=Object.fromEntries(Object.entries({"../../locales/zh-Hans.yml":ma}).map(([e,t])=>{const n=e.endsWith(".yaml");return[e.slice(14,n?-5:-4),t.default]})),_a=({app:e})=>{const t=Kn({legacy:!1,locale:"zh-Hans",messages:ha});e.use(t)};var ga=Object.freeze(Object.defineProperty({__proto__:null,install:_a},Symbol.toStringTag,{value:"Module"}));const ya=({isClient:e,router:t})=>{e&&(t.beforeEach(()=>{on.start()}),t.afterEach(()=>{on.done()}))};var ba=Object.freeze(Object.defineProperty({__proto__:null,install:ya},Symbol.toStringTag,{value:"Module"}));const wa=({isClient:e,initialState:t,app:n})=>{const o=Xn();n.use(o),e?o.state.value=t.pinia||{}:t.pinia=o.state.value};var xa=Object.freeze(Object.defineProperty({__proto__:null,install:wa},Symbol.toStringTag,{value:"Module"}));const Sa="modulepreload",cn={},Ta="/tuan/",Aa=function(t,n){return!n||n.length===0?t():Promise.all(n.map(o=>{if(o=`${Ta}${o}`,o in cn)return;cn[o]=!0;const r=o.endsWith(".css"),l=r?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${o}"]${l}`))return;const s=document.createElement("link");if(s.rel=r?"stylesheet":Sa,r||(s.as="script",s.crossOrigin=""),s.href=o,document.head.appendChild(s),r)return new Promise((d,u)=>{s.addEventListener("load",d),s.addEventListener("error",()=>u(new Error(`Unable to preload CSS for ${o}`)))})})).then(()=>t())},Ea={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"1.2em",height:"1.2em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 32 32"},ka=p("path",{d:"M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z",fill:"currentColor"},null,-1),$a=[ka];function Ca(e,t){return _(),S("svg",Ea,$a)}var Pa={name:"carbon-moon",render:Ca};const Ra={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"1.2em",height:"1.2em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 32 32"},La=Zn('<path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path>',9),Ia=[La];function Ma(e,t){return _(),S("svg",Ra,Ia)}var Na={name:"carbon-sun",render:Ma};const Oa={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"1.2em",height:"1.2em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 32 32"},Da=p("path",{d:"M16 2a14 14 0 0 0-4.43 27.28c.7.13 1-.3 1-.67v-2.38c-3.89.84-4.71-1.88-4.71-1.88a3.71 3.71 0 0 0-1.62-2.05c-1.27-.86.1-.85.1-.85a2.94 2.94 0 0 1 2.14 1.45a3 3 0 0 0 4.08 1.16a2.93 2.93 0 0 1 .88-1.87c-3.1-.36-6.37-1.56-6.37-6.92a5.4 5.4 0 0 1 1.44-3.76a5 5 0 0 1 .14-3.7s1.17-.38 3.85 1.43a13.3 13.3 0 0 1 7 0c2.67-1.81 3.84-1.43 3.84-1.43a5 5 0 0 1 .14 3.7a5.4 5.4 0 0 1 1.44 3.76c0 5.38-3.27 6.56-6.39 6.91a3.33 3.33 0 0 1 .95 2.59v3.84c0 .46.25.81 1 .67A14 14 0 0 0 16 2z","fill-rule":"evenodd",fill:"currentColor"},null,-1),Fa=[Da];function za(e,t){return _(),S("svg",Oa,Fa)}var Ba={name:"carbon-logo-github",render:za};const ft=Jn(),Ua=ea(ft);var ae=(e,t)=>{const n=e.__vccOpts||e;for(const[o,r]of t)n[o]=r;return n};const Ha={"w:text":"3xl sm:2xl"},qa={class:"flex items-center","w:flex":"col","w:space":"y-1.5"},Wa=["title"],Ga={class:"icon-btn",rel:"noreferrer",href:"https://github.com/FToovvr/tuan",target:"_blank",title:"GitHub"},Va=G({setup(e){const{t,availableLocales:n,locale:o}=ta();return(r,l)=>{const s=Pa,d=Na,u=Ba;return _(),S("nav",Ha,[p("div",qa,[p("button",{class:"icon-btn !outline-none",title:U(t)("button.toggle_dark"),onClick:l[0]||(l[0]=c=>U(Ua)())},[U(ft)?(_(),W(s,{key:0})):(_(),W(d,{key:1}))],8,Wa),p("a",Ga,[Q(u)])])])}}});var Ya=ae(Va,[["__scopeId","data-v-9c6f4f6a"]]),Qe={initial:0,post:2e6,overflowMask:19e5,postHead:32e5,fixedWrapper:4e6};const ja={class:"fixed px-1 py-1.5 rounded-3xl","w:border":"1 gray-500","w:bg":"white dark:gray-900"},Qa=G({setup(e){Pe(n=>({"064753e0":U(t)}));const t=Qe.fixedWrapper;return(n,o)=>(_(),S("div",ja,[$e(n.$slots,"default",{},void 0,!0)]))}});var Tn=ae(Qa,[["__scopeId","data-v-30638907"]]);const Ka={class:"px-4 pb-10 text-center text-gray-700 dark:text-gray-200"};function Xa(e,t){const n=Ya,o=Tn,r=yn("router-view");return _(),S("main",Ka,[Q(o,{class:"top-6 right-3 sm:right-6"},{default:_e(()=>[Q(n)]),_:1}),Q(r)])}const Za={};var Ja=ae(Za,[["render",Xa]]);const eo={"404":()=>Aa(()=>import("./404.f146bd32.js"),["assets/404.f146bd32.js","assets/vendor.8f5ee17f.js"]),default:Ja};function to(e){return e.map(t=>{var n;return{path:t.path,component:eo[((n=t.meta)==null?void 0:n.layout)||"default"],children:[At(Te({},t),{path:""})]}})}const st="/tuan";class Ue{constructor(t,n){this.refShardLookup=null,this.id=t.id,this.dataBasePath=t.dataBasePath,this.pagesPerShard=t.pagesPerShard,this.postsPerPage=t.postsPerPage;const o=this.pagesPerShard*this.postsPerPage;console.assert(this.id===n.id),this.name=n.name,this.postOwner=n.po,this.postCount=n.postCount;const r=Math.floor((this.postCount-1)/o)+1;this.shards=new Array(r).fill(null),this.postFloorLookup=new Map}static async build(t){const n=await(await fetch(`${t.dataBasePath}/tuan.json`)).json();return new Ue(t,n)}async getPage(t){const{inShard:n,inShardRange:o}=this.getPagePosition(t);return(await this.getShard(n)).posts.slice(o.from,o.to+1)}async getRefPost(t){const n=this.postFloorLookup.get(t);if(n!==void 0){const d=this.getFloorPosition(n);return(await this.getShard(d.inShard)).posts[d.inShardOffset]}const r=(await this.getRefShardLookup()).get(t);if(!r)return null;const l=await this.getShard(r),s=na(l.posts,t,(d,u)=>d.id-u);return console.assert(s>=0),l.posts[s]}getPagePosition(t){const n=(t-1)%this.pagesPerShard;return{inShard:Math.floor((t-1)/this.pagesPerShard),inShardRange:{from:n*this.postsPerPage,to:(n+1)*this.postsPerPage-1}}}getFloorPosition(t){const n=Math.floor(t/this.postsPerPage)+1,o=t%this.postsPerPage,r=this.getPagePosition(n);return{inShard:r.inShard,inShardOffset:r.inShardRange.from+o}}async getShard(t){const n=this.pagesPerShard*this.postsPerPage;this.shards[t]||(this.shards[t]=Ue.fetchShard(t,{shardCapacity:n,postCount:this.postCount,dataBasePath:this.dataBasePath}),this.shards[t]=await this.shards[t]);const o=await this.shards[t];if(!o.initialized){o.initialized=!0;const r=t*n;for(const[l,s]of o.posts.entries())this.postFloorLookup.set(s.id,r+l)}return o}static async fetchShard(t,n){const[o,r]=[t*n.shardCapacity,Math.min(n.postCount-1,(t+1)*n.shardCapacity-1)],l=`[${t}]${o}-${r}.csv`,s=await(await fetch(`${n.dataBasePath}/shards/${l}`)).text();s.charCodeAt(0)===65279&&s.substring(1);const u=rn.parse(s,{header:!0}).data.map(c=>{const m={id:Number(c.id),created_at:Number(c.created_at),user_id:c.user_id,content:c.content};return c.title&&(m.title=c.title),c.name&&(m.name=c.name),c.attachment_base&&(m.attachment_base=c.attachment_base),c.attachment_extension&&(m.attachment_extension=c.attachment_extension),m});return{initialized:!1,idRange:{from:u[0].id,to:u[u.length-1].id},posts:u}}async getRefShardLookup(){return this.refShardLookup||(this.refShardLookup=await(async()=>{const t=await(await fetch(`${this.dataBasePath}/ref-index.csv`)).text(),o=rn.parse(t).data,r=new Map;for(let l=1;l<o.length;l++)r.set(o.refId,o.atShard);return r})()),await this.refShardLookup}static convertIdToFolderName(t){const n=t.split(":"),o=n.splice(n.length-1,1);return n.map(r=>`[${r}]`).join("")+o}}const fe=aa("stuff",{state:()=>({isInitialized:!1,entrypoint:null,assetBaseUrl:null,lfsAssetBaseUrl:null,collection:null,loadedQuests:new Map,currentQuest:null,rootPostWidth:0,postToScrollTo:null,isInAutoScrolling:!1}),actions:{async loadCurrentQuestLegacy(e,t){const n=this.convertLegacyPathToId(e,t);console.assert(n!==void 0),this.loadCurrentQuest(n)},convertLegacyPathToId(e,t){var n;return(n=this.collection)==null?void 0:n.legacyPathToId.get(`${e}/${t}`)},async loadCurrentQuest(e){this.currentQuest=await this.loadQuest(e)},async loadQuest(e){const t=Ue.convertIdToFolderName(e);if(this.loadedQuests.has(e))return this.loadedQuests.get(e);if(!this.assetBaseUrl||!this.lfsAssetBaseUrl)throw new Error(`baseUrl(${this.assetBaseUrl}) or lfsBaseUrl(${this.lfsAssetBaseUrl}) is null`);let n=await Ue.build(Te({id:e,dataBasePath:`${this.assetBaseUrl}/${t}`},this.collection.shardsInfo));return this.loadedQuests.set(e,n),n}}});function no(e){const t=fe();t.entrypoint=e.entrypoint,t.assetBaseUrl=e.assetBaseUrl,t.lfsAssetBaseUrl=e.lfsAssetBaseUrl,new Promise(async()=>{const n=await(await fetch(`${st}/assets/tuan-data/collection.json`)).json(),o=new Map,r=new Map;for(const l of n.index)o.set(l.id,l),l.legacyPath&&r.set(`${l.legacyPath.folder}/${l.legacyPath.quest}`,l.id);t.collection={quests:o,legacyPathToId:r,shardsInfo:n.shardsInfo},t.isInitialized=!0})}const ao=G({setup(e){return oa().appContext.config.compilerOptions.isCustomElement=t=>t==="font",ra({title:"Vitesse",meta:[{name:"description",content:"Opinionated Vite Starter Template"}]}),no({entrypoint:"/tuan",assetBaseUrl:"/tuan/assets/tuan-data",lfsAssetBaseUrl:(()=>`https://media.githubusercontent.com/media/${/^(.*?)\./.exec(window.location.hostname)[1]}/tuan/gh-pages`)()+"/assets/tuan-data"}),(t,n)=>{const o=yn("router-view");return _(),W(o)}}});const oo={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"1.2em",height:"1.2em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 512 512"},ro=p("path",{d:"M414 321.94L274.22 158.82a24 24 0 0 0-36.44 0L98 321.94c-13.34 15.57-2.28 39.62 18.22 39.62h279.6c20.5 0 31.56-24.05 18.18-39.62z",fill:"currentColor"},null,-1),so=[ro];function lo(e,t){return _(),S("svg",oo,so)}var io={name:"ion-caret-up",render:lo};const uo=e=>(Re("data-v-7ecd0a8b"),e=e(),Le(),e),co=["value"],po=uo(()=>p("div",null,"/",-1)),fo={class:"max"},vo=G({props:{modelValue:null,max:null,disabled:{type:Boolean}},emits:["update:modelValue"],setup(e,{emit:t}){const n=e;Pe(u=>({"0b8dea46":r.value}));let o=P(n,"modelValue"),r=x(()=>{var u;return`${Math.max((u=n.max)!=null?u:0,n.modelValue).toString().length+1}ch`});function l(u,c=!1){var T,E;if(n.disabled)return;const m=c?(T=s.value)==null?void 0:T.selectionStart:null;let g=Number(u);return!Number.isInteger(g)||g<=0||g>((E=n.max)!=null?E:0)?u==="":(t("update:modelValue",Number(u)),m&&dt(()=>{var L;return(L=s.value)==null?void 0:L.setSelectionRange(m,m)}),!0)}let s=b(null);se(()=>{s.value.oninput=function(u){l(this.value)||(this.value=o.value)}});function d(u){var c;u.target instanceof HTMLInputElement||(c=s.value)==null||c.focus()}return(u,c)=>{var m;return _(),S("div",{class:"flex","w:justify":"center",onClick:d},[p("input",{class:"block",ref_key:"inputRef",ref:s,inputmode:"decimal",value:o.value,onKeydown:[c[0]||(c[0]=sn(ln(g=>l(o.value-1,!0),["prevent"]),["up"])),c[1]||(c[1]=sn(ln(g=>l(o.value+1,!0),["prevent"]),["down"]))]},null,40,co),po,p("div",fo,re((m=e.max)!=null?m:"\u2026"),1)])}}});var mo=ae(vo,[["__scopeId","data-v-7ecd0a8b"]]);const ho={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"1.2em",height:"1.2em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 512 512"},_o=p("path",{d:"M98 190.06l139.78 163.12a24 24 0 0 0 36.44 0L414 190.06c13.34-15.57 2.28-39.62-18.22-39.62h-279.6c-20.5 0-31.56 24.05-18.18 39.62z",fill:"currentColor"},null,-1),go=[_o];function yo(e,t){return _(),S("svg",ho,go)}var bo={name:"ion-caret-down",render:yo};const wo={class:"flex","w:m":"auto","w:w":"max","w:space":"x-1","w:p":"0.5","w:items":"center"},xo=["disabled"],So=["disabled"],To=G({props:{currentPage:null,max:null,pageStatuses:null,disabled:{type:Boolean}},emits:["pageChangeRequired"],setup(e,{emit:t}){const n=e;function o(s){var d;s>0&&s<=((d=n.max)!=null?d:0)&&t("pageChangeRequired",s)}let r=x(()=>n.pageStatuses.get(n.currentPage-1)==="loading"),l=x(()=>n.pageStatuses.get(n.currentPage+1)==="loading");return(s,d)=>{const u=io,c=mo,m=bo;return _(),S("div",wo,[p("button",{onClick:d[0]||(d[0]=g=>o(e.currentPage-1)),disabled:e.currentPage===1||r.value||e.disabled,"w:h":"1.2em","w:text":"2xl"},[Q(u)],8,xo),Q(c,{modelValue:e.currentPage,max:e.max,"onUpdate:modelValue":d[1]||(d[1]=g=>o(g)),disabled:e.disabled},null,8,["modelValue","max","disabled"]),p("button",{onClick:d[2]||(d[2]=g=>o(e.currentPage+1)),disabled:e.currentPage===e.max||l.value||e.disabled,"w:h":"1.2em","w:text":"2xl"},[Q(m)],8,So)])}}});var Ao=ae(To,[["__scopeId","data-v-3af40edc"]]);const Eo={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"1.2em",height:"1.2em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 256 256"},ko=p("path",{d:"M216.5 199.5a12 12 0 0 1 0 17a12.1 12.1 0 0 1-17 0L128 145l-71.5 71.5a12 12 0 0 1-17-17l80-80a12 12 0 0 1 17 0zm-160-63L128 65l71.5 71.5a12.1 12.1 0 0 0 17 0a12 12 0 0 0 0-17l-80-80a12 12 0 0 0-17 0l-80 80a12 12 0 0 0 17 17z",fill:"currentColor"},null,-1),$o=[ko];function Co(e,t){return _(),S("svg",Eo,$o)}var Po={name:"ph-caret-double-up-bold",render:Co};const Ro={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"1.2em",height:"1.2em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 256 256"},Lo=p("path",{d:"M216.5 119.5a12 12 0 0 1 0 17l-80 80a12.1 12.1 0 0 1-17 0l-80-80a12 12 0 0 1 17-17L128 191l71.5-71.5a12 12 0 0 1 17 0zm-97 17a12.1 12.1 0 0 0 17 0l80-80a12 12 0 0 0-17-17L128 111L56.5 39.5a12 12 0 0 0-17 17z",fill:"currentColor"},null,-1),Io=[Lo];function Mo(e,t){return _(),S("svg",Ro,Io)}var No={name:"ph-caret-double-down-bold",render:Mo};const Oo={class:"flex items-center justify-center space-x-1 cursor-pointer","w:text":"gray-700 dark:gray-300 opacity-80"},Do={"w:font":"bold","w:text":"sm"},Fo=G({props:{direction:null,pageNumber:null},setup(e){return(t,n)=>{const o=Po,r=No;return _(),S("div",Oo,[e.direction==="up"?(_(),W(o,{key:0,style:{"font-size":"0.875rem"}})):ne("",!0),e.direction==="down"?(_(),W(r,{key:1,style:{"font-size":"0.875rem"}})):ne("",!0),p("div",Do,"\u52A0\u8F7D"+re(e.pageNumber)+"\u9875\u2026",1)])}}}),An=e=>(Re("data-v-2203ae9b"),e=e(),Le(),e),zo={class:"flex"},Bo=An(()=>p("div",{class:"dash"},null,-1)),Uo={"w:p":"x-2"},Ho=An(()=>p("div",{class:"dash"},null,-1));function qo(e,t){return _(),S("div",zo,[Bo,p("div",Uo,[$e(e.$slots,"default",{},void 0,!0)]),Ho])}const Wo={};var Go=ae(Wo,[["render",qo],["__scopeId","data-v-2203ae9b"]]);const Vo=G({props:{direction:{default:"top-bottom"},backgroundColorRgbHex:null,height:{default:"2rem"},zIndex:{type:[Number,Boolean]}},setup(e){const t=e;Pe(d=>({"39b9b75e":n.value,"7df8f27e":e.height,"730a3305":l.value,"0688da06":U(s)}));let n=x(()=>t.direction==="top-bottom"?`calc(100% - ${t.height})`:0),o=P(t,"backgroundColorRgbHex"),r=x(()=>`${o.value}00`),l=x(()=>t.direction==="top-bottom"?`linear-gradient(${r.value}, ${o.value})`:`linear-gradient(${o.value}, ${r.value})`);const s=typeof t.zIndex=="number"?t.zIndex:t.zIndex?Qe.overflowMask:null;return(d,u)=>(_(),S("div"))}});var Mt=ae(Vo,[["__scopeId","data-v-0927980d"]]);function En(e){return e*parseFloat(getComputedStyle(document.documentElement).fontSize)}const Yo={key:0,"w:float":"right"},jo=["data-mode"],Qo=["src"],Ko=G({props:{imageUrl:null,backgroundColorRgbHex:null},setup(e){Pe(c=>({"707c1c4f":s.value}));let t=b(null),n=b("thumbnail");function o(){n.value=n.value==="thumbnail"?"expanded":"thumbnail",n.value==="thumbnail"&&t.value.getBoundingClientRect().top<0&&(t.value.closest(".quest-post").scrollIntoView(),window.scrollBy(0,En(-2)))}let r=b({width:0,height:0});se(()=>{je(t.value.querySelector("img"),c=>{r.value=c[0].contentRect})});let l=x(()=>r.value.width*2),s=x(()=>`${l.value}px`),d=b(null);function u(){d.value=null}return se(()=>{t.value.querySelector("img").onerror=c=>{typeof c=="string"?d.value=`\u56FE\u7247\u52A0\u8F7D\u5931\u8D25\uFF1A${c}`:d.value="\u56FE\u7247\u52A0\u8F7D\u5931\u8D25\uFF01"}}),(c,m)=>{const g=Mt;return _(),S(pt,null,[d.value!==null?(_(),S("span",Yo,re(d.value),1)):ne("",!0),p("figure",{class:"relative",ref_key:"figureRef",ref:t,"data-mode":n.value,onClick:o},[n.value==="thumbnail"&&r.value.height>l.value?(_(),W(g,{key:0,"background-color-rgb-hex":e.backgroundColorRgbHex},null,8,["background-color-rgb-hex"])):ne("",!0),p("img",{src:e.imageUrl,loading:"lazy",onLoad:u},null,40,Qo)],8,jo)],64)}}});var Xo=ae(Ko,[["__scopeId","data-v-3e31d681"]]);function Zo(e){return`#${e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/).slice(1).map(t=>parseInt(t,10).toString(16).padStart(2,"0")).join("")}`}function at(e){const t=document.createElement("div");t.className=`${e}`,document.body.appendChild(t);const n=Zo(window.getComputedStyle(t).getPropertyValue("color"));return t.remove(),n}const kn=(()=>({app:{background:{light:at("text-white"),dark:at("text-black")}},post:{background:{light:at("text-post-background-color"),dark:at("text-post-background-color-dark")}}}))();x(()=>kn.app.background[ft.value?"dark":"light"]);const Be=x(()=>kn.post.background[ft.value?"dark":"light"]),$n=Symbol(),Cn=Symbol(),dn=Symbol(),Pn=Symbol(),Rn=Symbol(),Ln=Symbol();const Jo=e=>(Re("data-v-5bc8be22"),e=e(),Le(),e),er={class:"inline-block relative"},tr=["data-status"],nr=Jo(()=>p("span",{class:"px-0.5"},null,-1)),ar=G({props:{postId:null,nestLevel:null,siblingOrder:null},setup(e){const t=e;let n=P(t,"postId"),o=Ee($n),r=b(null),l=b(null),s=fe(),d=x(()=>{const M="0.75rem",w=`${s.rootPostWidth}px`,I=`(${M} * ${t.nestLevel+1})`,N=`(0.2em * ${t.nestLevel})`;return`calc(${w} - ${I} - ${N})`}),u=function(w,I,N=100){let v=w,A=I,B=b({refLink:!1,refPost:!1}),ue=x(()=>B.value.refLink||B.value.refPost),ce=b(!1);pe(ue,async C=>{C===!1&&(ce.value=!0,await new Promise(ye=>setTimeout(ye,N)),ce.value=!1)});let ge=x(()=>ue.value||ce.value),Z=b({width:0,height:0});se(()=>{je(o.value,C=>{const{width:ye,height:O}=C[0].contentRect;Z.value={width:ye,height:O}})});const He=sa(Z,200);return pe([v,A,He],()=>{if(!o.value||!v.value||!A.value)return;const{top:C,left:ye}=v.value.getBoundingClientRect(),{top:O,left:Xe}=o.value.getBoundingClientRect();A.value.style.top=`${C-O}px`,A.value.style.left=`${ye-Xe}px`}),{onHovers:B,shouldFloat:ge}}(r,l,100),c=P(u,"onHovers"),m=P(u,"shouldFloat"),g=b(0),T=b(0),E=b(0);pe(l,()=>{var w,I;if(!l.value)return;const M=l.value.querySelector(".quest-post-content-wrapper");for(const{heightRef:N,widthRef:v,el:A}of[{heightRef:g,widthRef:T,el:l.value},{heightRef:E,widthRef:null,el:M}])N.value=(w=A.clientHeight)!=null?w:0,v&&(v.value=(I=A.clientWidth)!=null?I:0),je(A,B=>{N.value=B[0].contentRect.height,v&&(v.value=B[0].contentRect.width)})});const L=En(15/4);let $=function(w,I){let N=I,v=b(!1),A=b(!1);pe(v,Z=>{Z||(A.value=!1)});let B=x(()=>v.value?A.value?"collapsed":"open":m.value?"floating":"closed"),ue=x(()=>N.value>w),ce=b(!1);function ge(Z){if(ce.value=!1,!v.value)v.value=!0;else if(Z==="link"){if(!ue.value)return;A.value=B.value!=="collapsed"}else v.value=!1}return{displayStatus:B,isPinned:v,isCollapsed:A,isCollapsible:ue,eagersToCollapse:ce,onClick:ge}}(L,E),F=P($,"displayStatus"),te=P($,"isPinned"),oe=P($,"isCollapsed"),V=P($,"isCollapsible"),z=P($,"eagersToCollapse"),X=P($,"onClick"),H=x(()=>{var M;return te.value?(M=o.value)==null?void 0:M.querySelector(".relative.quest-post-ref-wrapper"):o.value});pe(E,()=>{z.value&&V.value&&(oe.value=!0,z.value=!1)}),se(()=>{t.nestLevel===1&&(te.value=!0,dt(()=>{V.value?oe.value=!0:z.value=!0}))});let ie=Ee(Cn),R=x(()=>Qe.post+(ie.value-t.siblingOrder));return(M,w)=>{const I=Mt,N=Dn;return _(),S(pt,null,[p("span",{class:"ref-post-link",style:ke([{color:"#789922"},{cursor:F.value==="open"?V.value?"zoom-out":"":"zoom-in"}]),"w:font":"mono","w:text":"sm",onClick:w[0]||(w[0]=v=>X.value("link")),onMouseenter:w[1]||(w[1]=v=>c.value.refLink=!0),onMouseleave:w[2]||(w[2]=v=>c.value.refLink=!1)},">>No."+re(n.value),37),(_(),W(ia,null,[o.value&&(m.value||te.value)?(_(),S("div",{key:0,class:"ref-post-anchor",ref_key:"refPostAnchorRef",ref:r,style:ke(te.value?{height:`${g.value}px`,width:`${T.value}px`}:void 0)},[(_(),W(la,{to:H.value},[p("div",{class:"absolute",ref_key:"refPostRef",ref:l,onMouseenter:w[6]||(w[6]=v=>(c.value.refPost=!0,z.value=!1)),onMouseleave:w[7]||(w[7]=v=>c.value.refPost=!1),style:ke([{width:"max-content"},{zIndex:R.value,maxWidth:d.value}])},[Q(N,{"post-id":n.value,"nest-level":e.nestLevel,"display-status":F.value,onExpand:w[5]||(w[5]=v=>X.value("link"))},{"head-left":_e(()=>[p("div",er,[oe.value?(_(),W(I,{key:0,onClick:w[3]||(w[3]=v=>X.value("pin")),"w:cursor":"pointer",height:"1em","background-color-rgb-hex":U(Be),"z-index":""},null,8,["background-color-rgb-hex"])):ne("",!0),p("span",{class:"pin-button","data-status":F.value,"w:text":"xs",onClick:w[4]||(w[4]=v=>X.value("pin")),"w:cursor":"pointer"},"\u{1F4CC}",8,tr)]),nr]),_:1},8,["post-id","nest-level","display-status"])],36)],8,["to"]))],4)):ne("",!0)],1024))],64)}}});var or=ae(ar,[["__scopeId","data-v-5bc8be22"]]);/*! @license DOMPurify 2.3.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.3.6/LICENSE */function rr(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}else return Array.from(e)}var sr=Object.hasOwnProperty,pn=Object.setPrototypeOf,lr=Object.isFrozen,ir=Object.getPrototypeOf,ur=Object.getOwnPropertyDescriptor,K=Object.freeze,ve=Object.seal,cr=Object.create,In=typeof Reflect!="undefined"&&Reflect,ct=In.apply,Lt=In.construct;ct||(ct=function(t,n,o){return t.apply(n,o)});K||(K=function(t){return t});ve||(ve=function(t){return t});Lt||(Lt=function(t,n){return new(Function.prototype.bind.apply(t,[null].concat(rr(n))))});var dr=le(Array.prototype.forEach),fn=le(Array.prototype.pop),Ve=le(Array.prototype.push),lt=le(String.prototype.toLowerCase),vn=le(String.prototype.match),we=le(String.prototype.replace),pr=le(String.prototype.indexOf),fr=le(String.prototype.trim),ee=le(RegExp.prototype.test),Et=vr(TypeError);function le(e){return function(t){for(var n=arguments.length,o=Array(n>1?n-1:0),r=1;r<n;r++)o[r-1]=arguments[r];return ct(e,t,o)}}function vr(e){return function(){for(var t=arguments.length,n=Array(t),o=0;o<t;o++)n[o]=arguments[o];return Lt(e,n)}}function y(e,t){pn&&pn(e,null);for(var n=t.length;n--;){var o=t[n];if(typeof o=="string"){var r=lt(o);r!==o&&(lr(t)||(t[n]=r),o=r)}e[o]=!0}return e}function Ae(e){var t=cr(null),n=void 0;for(n in e)ct(sr,e,[n])&&(t[n]=e[n]);return t}function ot(e,t){for(;e!==null;){var n=ur(e,t);if(n){if(n.get)return le(n.get);if(typeof n.value=="function")return le(n.value)}e=ir(e)}function o(r){return console.warn("fallback value for",r),null}return o}var mn=K(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),kt=K(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),$t=K(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),mr=K(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Ct=K(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),hr=K(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),hn=K(["#text"]),_n=K(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),Pt=K(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),gn=K(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),rt=K(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),_r=ve(/\{\{[\s\S]*|[\s\S]*\}\}/gm),gr=ve(/<%[\s\S]*|[\s\S]*%>/gm),yr=ve(/^data-[\-\w.\u00B7-\uFFFF]/),br=ve(/^aria-[\-\w]+$/),wr=ve(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),xr=ve(/^(?:\w+script|data):/i),Sr=ve(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Tr=ve(/^html$/i),Ye=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function de(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}else return Array.from(e)}var Ar=function(){return typeof window=="undefined"?null:window},Er=function(t,n){if((typeof t=="undefined"?"undefined":Ye(t))!=="object"||typeof t.createPolicy!="function")return null;var o=null,r="data-tt-policy-suffix";n.currentScript&&n.currentScript.hasAttribute(r)&&(o=n.currentScript.getAttribute(r));var l="dompurify"+(o?"#"+o:"");try{return t.createPolicy(l,{createHTML:function(d){return d}})}catch{return console.warn("TrustedTypes policy "+l+" could not be created."),null}};function Mn(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ar(),t=function(a){return Mn(a)};if(t.version="2.3.6",t.removed=[],!e||!e.document||e.document.nodeType!==9)return t.isSupported=!1,t;var n=e.document,o=e.document,r=e.DocumentFragment,l=e.HTMLTemplateElement,s=e.Node,d=e.Element,u=e.NodeFilter,c=e.NamedNodeMap,m=c===void 0?e.NamedNodeMap||e.MozNamedAttrMap:c,g=e.HTMLFormElement,T=e.DOMParser,E=e.trustedTypes,L=d.prototype,$=ot(L,"cloneNode"),F=ot(L,"nextSibling"),te=ot(L,"childNodes"),oe=ot(L,"parentNode");if(typeof l=="function"){var V=o.createElement("template");V.content&&V.content.ownerDocument&&(o=V.content.ownerDocument)}var z=Er(E,n),X=z?z.createHTML(""):"",H=o,ie=H.implementation,R=H.createNodeIterator,M=H.createDocumentFragment,w=H.getElementsByTagName,I=n.importNode,N={};try{N=Ae(o).documentMode?o.documentMode:{}}catch{}var v={};t.isSupported=typeof oe=="function"&&ie&&typeof ie.createHTMLDocument!="undefined"&&N!==9;var A=_r,B=gr,ue=yr,ce=br,ge=xr,Z=Sr,He=wr,C=null,ye=y({},[].concat(de(mn),de(kt),de($t),de(Ct),de(hn))),O=null,Xe=y({},[].concat(de(_n),de(Pt),de(gn),de(rt))),D=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),qe=null,vt=null,Ft=!0,mt=!0,zt=!1,Ie=!1,xe=!1,ht=!1,_t=!1,Me=!1,Ze=!1,Je=!1,Bt=!0,gt=!0,We=!1,Ne={},Oe=null,Ut=y({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Ht=null,qt=y({},["audio","video","img","source","image","track"]),yt=null,Wt=y({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),bt="http://www.w3.org/1998/Math/MathML",wt="http://www.w3.org/2000/svg",be="http://www.w3.org/1999/xhtml",et=be,xt=!1,De=void 0,Fn=["application/xhtml+xml","text/html"],zn="text/html",Se=void 0,Fe=null,Bn=o.createElement("form"),Gt=function(a){return a instanceof RegExp||a instanceof Function},St=function(a){Fe&&Fe===a||((!a||(typeof a=="undefined"?"undefined":Ye(a))!=="object")&&(a={}),a=Ae(a),C="ALLOWED_TAGS"in a?y({},a.ALLOWED_TAGS):ye,O="ALLOWED_ATTR"in a?y({},a.ALLOWED_ATTR):Xe,yt="ADD_URI_SAFE_ATTR"in a?y(Ae(Wt),a.ADD_URI_SAFE_ATTR):Wt,Ht="ADD_DATA_URI_TAGS"in a?y(Ae(qt),a.ADD_DATA_URI_TAGS):qt,Oe="FORBID_CONTENTS"in a?y({},a.FORBID_CONTENTS):Ut,qe="FORBID_TAGS"in a?y({},a.FORBID_TAGS):{},vt="FORBID_ATTR"in a?y({},a.FORBID_ATTR):{},Ne="USE_PROFILES"in a?a.USE_PROFILES:!1,Ft=a.ALLOW_ARIA_ATTR!==!1,mt=a.ALLOW_DATA_ATTR!==!1,zt=a.ALLOW_UNKNOWN_PROTOCOLS||!1,Ie=a.SAFE_FOR_TEMPLATES||!1,xe=a.WHOLE_DOCUMENT||!1,Me=a.RETURN_DOM||!1,Ze=a.RETURN_DOM_FRAGMENT||!1,Je=a.RETURN_TRUSTED_TYPE||!1,_t=a.FORCE_BODY||!1,Bt=a.SANITIZE_DOM!==!1,gt=a.KEEP_CONTENT!==!1,We=a.IN_PLACE||!1,He=a.ALLOWED_URI_REGEXP||He,et=a.NAMESPACE||be,a.CUSTOM_ELEMENT_HANDLING&&Gt(a.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(D.tagNameCheck=a.CUSTOM_ELEMENT_HANDLING.tagNameCheck),a.CUSTOM_ELEMENT_HANDLING&&Gt(a.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(D.attributeNameCheck=a.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),a.CUSTOM_ELEMENT_HANDLING&&typeof a.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(D.allowCustomizedBuiltInElements=a.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),De=Fn.indexOf(a.PARSER_MEDIA_TYPE)===-1?De=zn:De=a.PARSER_MEDIA_TYPE,Se=De==="application/xhtml+xml"?function(i){return i}:lt,Ie&&(mt=!1),Ze&&(Me=!0),Ne&&(C=y({},[].concat(de(hn))),O=[],Ne.html===!0&&(y(C,mn),y(O,_n)),Ne.svg===!0&&(y(C,kt),y(O,Pt),y(O,rt)),Ne.svgFilters===!0&&(y(C,$t),y(O,Pt),y(O,rt)),Ne.mathMl===!0&&(y(C,Ct),y(O,gn),y(O,rt))),a.ADD_TAGS&&(C===ye&&(C=Ae(C)),y(C,a.ADD_TAGS)),a.ADD_ATTR&&(O===Xe&&(O=Ae(O)),y(O,a.ADD_ATTR)),a.ADD_URI_SAFE_ATTR&&y(yt,a.ADD_URI_SAFE_ATTR),a.FORBID_CONTENTS&&(Oe===Ut&&(Oe=Ae(Oe)),y(Oe,a.FORBID_CONTENTS)),gt&&(C["#text"]=!0),xe&&y(C,["html","head","body"]),C.table&&(y(C,["tbody"]),delete qe.tbody),K&&K(a),Fe=a)},Vt=y({},["mi","mo","mn","ms","mtext"]),Yt=y({},["foreignobject","desc","title","annotation-xml"]),tt=y({},kt);y(tt,$t),y(tt,mr);var Tt=y({},Ct);y(Tt,hr);var Un=function(a){var i=oe(a);(!i||!i.tagName)&&(i={namespaceURI:be,tagName:"template"});var f=lt(a.tagName),k=lt(i.tagName);if(a.namespaceURI===wt)return i.namespaceURI===be?f==="svg":i.namespaceURI===bt?f==="svg"&&(k==="annotation-xml"||Vt[k]):Boolean(tt[f]);if(a.namespaceURI===bt)return i.namespaceURI===be?f==="math":i.namespaceURI===wt?f==="math"&&Yt[k]:Boolean(Tt[f]);if(a.namespaceURI===be){if(i.namespaceURI===wt&&!Yt[k]||i.namespaceURI===bt&&!Vt[k])return!1;var Y=y({},["title","style","font","a","script"]);return!Tt[f]&&(Y[f]||!tt[f])}return!1},me=function(a){Ve(t.removed,{element:a});try{a.parentNode.removeChild(a)}catch{try{a.outerHTML=X}catch{a.remove()}}},jt=function(a,i){try{Ve(t.removed,{attribute:i.getAttributeNode(a),from:i})}catch{Ve(t.removed,{attribute:null,from:i})}if(i.removeAttribute(a),a==="is"&&!O[a])if(Me||Ze)try{me(i)}catch{}else try{i.setAttribute(a,"")}catch{}},Qt=function(a){var i=void 0,f=void 0;if(_t)a="<remove></remove>"+a;else{var k=vn(a,/^[\r\n\t ]+/);f=k&&k[0]}De==="application/xhtml+xml"&&(a='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+a+"</body></html>");var Y=z?z.createHTML(a):a;if(et===be)try{i=new T().parseFromString(Y,De)}catch{}if(!i||!i.documentElement){i=ie.createDocument(et,"template",null);try{i.documentElement.innerHTML=xt?"":Y}catch{}}var j=i.body||i.documentElement;return a&&f&&j.insertBefore(o.createTextNode(f),j.childNodes[0]||null),et===be?w.call(i,xe?"html":"body")[0]:xe?i.documentElement:j},Kt=function(a){return R.call(a.ownerDocument||a,a,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT,null,!1)},Hn=function(a){return a instanceof g&&(typeof a.nodeName!="string"||typeof a.textContent!="string"||typeof a.removeChild!="function"||!(a.attributes instanceof m)||typeof a.removeAttribute!="function"||typeof a.setAttribute!="function"||typeof a.namespaceURI!="string"||typeof a.insertBefore!="function")},Ge=function(a){return(typeof s=="undefined"?"undefined":Ye(s))==="object"?a instanceof s:a&&(typeof a=="undefined"?"undefined":Ye(a))==="object"&&typeof a.nodeType=="number"&&typeof a.nodeName=="string"},he=function(a,i,f){!v[a]||dr(v[a],function(k){k.call(t,i,f,Fe)})},Xt=function(a){var i=void 0;if(he("beforeSanitizeElements",a,null),Hn(a)||vn(a.nodeName,/[\u0080-\uFFFF]/))return me(a),!0;var f=Se(a.nodeName);if(he("uponSanitizeElement",a,{tagName:f,allowedTags:C}),!Ge(a.firstElementChild)&&(!Ge(a.content)||!Ge(a.content.firstElementChild))&&ee(/<[/\w]/g,a.innerHTML)&&ee(/<[/\w]/g,a.textContent)||f==="select"&&ee(/<template/i,a.innerHTML))return me(a),!0;if(!C[f]||qe[f]){if(!qe[f]&&Jt(f)&&(D.tagNameCheck instanceof RegExp&&ee(D.tagNameCheck,f)||D.tagNameCheck instanceof Function&&D.tagNameCheck(f)))return!1;if(gt&&!Oe[f]){var k=oe(a)||a.parentNode,Y=te(a)||a.childNodes;if(Y&&k)for(var j=Y.length,q=j-1;q>=0;--q)k.insertBefore($(Y[q],!0),F(a))}return me(a),!0}return a instanceof d&&!Un(a)||(f==="noscript"||f==="noembed")&&ee(/<\/no(script|embed)/i,a.innerHTML)?(me(a),!0):(Ie&&a.nodeType===3&&(i=a.textContent,i=we(i,A," "),i=we(i,B," "),a.textContent!==i&&(Ve(t.removed,{element:a.cloneNode()}),a.textContent=i)),he("afterSanitizeElements",a,null),!1)},Zt=function(a,i,f){if(Bt&&(i==="id"||i==="name")&&(f in o||f in Bn))return!1;if(!(mt&&!vt[i]&&ee(ue,i))){if(!(Ft&&ee(ce,i))){if(!O[i]||vt[i]){if(!(Jt(a)&&(D.tagNameCheck instanceof RegExp&&ee(D.tagNameCheck,a)||D.tagNameCheck instanceof Function&&D.tagNameCheck(a))&&(D.attributeNameCheck instanceof RegExp&&ee(D.attributeNameCheck,i)||D.attributeNameCheck instanceof Function&&D.attributeNameCheck(i))||i==="is"&&D.allowCustomizedBuiltInElements&&(D.tagNameCheck instanceof RegExp&&ee(D.tagNameCheck,f)||D.tagNameCheck instanceof Function&&D.tagNameCheck(f))))return!1}else if(!yt[i]){if(!ee(He,we(f,Z,""))){if(!((i==="src"||i==="xlink:href"||i==="href")&&a!=="script"&&pr(f,"data:")===0&&Ht[a])){if(!(zt&&!ee(ge,we(f,Z,"")))){if(f)return!1}}}}}}return!0},Jt=function(a){return a.indexOf("-")>0},en=function(a){var i=void 0,f=void 0,k=void 0,Y=void 0;he("beforeSanitizeAttributes",a,null);var j=a.attributes;if(!!j){var q={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:O};for(Y=j.length;Y--;){i=j[Y];var nt=i,J=nt.name,tn=nt.namespaceURI;if(f=fr(i.value),k=Se(J),q.attrName=k,q.attrValue=f,q.keepAttr=!0,q.forceKeepAttr=void 0,he("uponSanitizeAttribute",a,q),f=q.attrValue,!q.forceKeepAttr&&(jt(J,a),!!q.keepAttr)){if(ee(/\/>/i,f)){jt(J,a);continue}Ie&&(f=we(f,A," "),f=we(f,B," "));var Wn=Se(a.nodeName);if(!!Zt(Wn,k,f))try{tn?a.setAttributeNS(tn,J,f):a.setAttribute(J,f),fn(t.removed)}catch{}}}he("afterSanitizeAttributes",a,null)}},qn=function h(a){var i=void 0,f=Kt(a);for(he("beforeSanitizeShadowDOM",a,null);i=f.nextNode();)he("uponSanitizeShadowNode",i,null),!Xt(i)&&(i.content instanceof r&&h(i.content),en(i));he("afterSanitizeShadowDOM",a,null)};return t.sanitize=function(h,a){var i=void 0,f=void 0,k=void 0,Y=void 0,j=void 0;if(xt=!h,xt&&(h="<!-->"),typeof h!="string"&&!Ge(h)){if(typeof h.toString!="function")throw Et("toString is not a function");if(h=h.toString(),typeof h!="string")throw Et("dirty is not a string, aborting")}if(!t.isSupported){if(Ye(e.toStaticHTML)==="object"||typeof e.toStaticHTML=="function"){if(typeof h=="string")return e.toStaticHTML(h);if(Ge(h))return e.toStaticHTML(h.outerHTML)}return h}if(ht||St(a),t.removed=[],typeof h=="string"&&(We=!1),We){if(h.nodeName){var q=Se(h.nodeName);if(!C[q]||qe[q])throw Et("root node is forbidden and cannot be sanitized in-place")}}else if(h instanceof s)i=Qt("<!---->"),f=i.ownerDocument.importNode(h,!0),f.nodeType===1&&f.nodeName==="BODY"||f.nodeName==="HTML"?i=f:i.appendChild(f);else{if(!Me&&!Ie&&!xe&&h.indexOf("<")===-1)return z&&Je?z.createHTML(h):h;if(i=Qt(h),!i)return Me?null:Je?X:""}i&&_t&&me(i.firstChild);for(var nt=Kt(We?h:i);k=nt.nextNode();)k.nodeType===3&&k===Y||Xt(k)||(k.content instanceof r&&qn(k.content),en(k),Y=k);if(Y=null,We)return h;if(Me){if(Ze)for(j=M.call(i.ownerDocument);i.firstChild;)j.appendChild(i.firstChild);else j=i;return O.shadowroot&&(j=I.call(n,j,!0)),j}var J=xe?i.outerHTML:i.innerHTML;return xe&&C["!doctype"]&&i.ownerDocument&&i.ownerDocument.doctype&&i.ownerDocument.doctype.name&&ee(Tr,i.ownerDocument.doctype.name)&&(J="<!DOCTYPE "+i.ownerDocument.doctype.name+`>
`+J),Ie&&(J=we(J,A," "),J=we(J,B," ")),z&&Je?z.createHTML(J):J},t.setConfig=function(h){St(h),ht=!0},t.clearConfig=function(){Fe=null,ht=!1},t.isValidAttribute=function(h,a,i){Fe||St({});var f=Se(h),k=Se(a);return Zt(f,k,i)},t.addHook=function(h,a){typeof a=="function"&&(v[h]=v[h]||[],Ve(v[h],a))},t.removeHook=function(h){v[h]&&fn(v[h])},t.removeHooks=function(h){v[h]&&(v[h]=[])},t.removeAllHooks=function(){v={}},t}var kr=Mn();const $r={class:"prose","w:text":"left","w:break":"words"},Cr={"w:whitespace":"pre-line","w:leading":"snug"},Pr=["innerHTML"],Rr=G({props:{content:null,nestLevel:null},setup(e){const t=e;let n=P(t,"content"),o=x(()=>kr.sanitize(n.value)),r=x(()=>o.value.indexOf("<font")>=0),l=b(0);Ce(Cn,it(l));let s=x(()=>{const d=new DOMParser().parseFromString(`<div>${o.value}</div>`,"text/html"),u=d.querySelectorAll('font[color="#789922"]');let c=1;return u.forEach(m=>{if(!/>>No\.\d+/.test(m.textContent))return;const g=Number(m.textContent.split(".")[1]),T=document.createElement("quest-post-ref-link");T.setAttribute(":post-id",String(g)),T.setAttribute(":nest-level",String(t.nestLevel+1)),T.setAttribute(":sibling-order",String(c)),c++,m.parentElement.replaceChild(T,m)}),l.value=c-1,d.documentElement.children[1]});return(d,u)=>(_(),S("div",$r,[p("div",Cr,[r.value?(_(),W(ua({template:s.value,components:{QuestPostRefLink:or}}),{key:0})):(_(),S("div",{key:1,innerHTML:o.value},null,8,Pr))])]))}});const Ke=e=>(Re("data-v-63887ae8"),e=e(),Le(),e),Lr={class:"quest-post-wrapper relative"},Ir=Ke(()=>p("div",{"w:clear":"both"},null,-1)),Mr=Ke(()=>p("div",{class:"h-1"},null,-1)),Nr=Ke(()=>p("hr",{"w:m":"x-0.5","w:border":"dashed gray-400"},null,-1)),Or={class:"quest-post-content-wrapper"},Dr=Ke(()=>p("div",{class:"relative quest-post-ref-wrapper"},null,-1)),Fr=Ke(()=>p("div",{"w:clear":"both"},null,-1)),zr=G({props:{nestLevel:null,displayStatus:null,backgroundColorRgbHex:null},emits:["expand"],setup(e,{emit:t}){const n=e;Pe(E=>({f2fc055a:e.backgroundColorRgbHex,"24765530":U(T)}));let o=x(()=>n.nestLevel>0),r=b(null);Ce($n,it(r));function l(E){n.displayStatus==="collapsed"&&(t("expand"),E.target instanceof HTMLElement&&E.target.classList.contains("ref-post-link")||E.stopPropagation())}let s=b(null),d=Ee("offsetTop",b(0)),u=b(0);se(()=>je(s.value,([E])=>u.value=E.contentRect.height));let c=b(null),m=function(L,$,F,te){let oe=$,V=L,z=F,X=te,H=b(null),ie=x(()=>z.value+X.value),R=x(()=>{var I;return Math.max((I=H.value)!=null?I:ie.value,z.value)}),M=b(null);const w=I=>{if(!V.value){window.removeEventListener("scroll",w);return}const N=V.value.getBoundingClientRect();H.value=N.bottom};return ca(()=>window.removeEventListener("scroll",w)),se(()=>ut(oe.value,([{intersectionRatio:I}])=>{const N=oe.value.getBoundingClientRect();N.top>0&&N.bottom>window.innerHeight/2||(I===1?M.value="onScreen":I===0?M.value==="aboveScreen"?M.value="partiallyCoveredByTopEdge":M.value="aboveScreen":M.value="partiallyCoveredByTopEdge")},{threshold:[0,1]})),pe(M,()=>{switch(M.value){case"onScreen":window.removeEventListener("scroll",w),H.value=null;break;case"aboveScreen":window.removeEventListener("scroll",w),H.value=0;break;case"partiallyCoveredByTopEdge":window.addEventListener("scroll",w);break}}),{childTop:R}}(s,c,d,u),g=P(m,"childTop");Ce("offsetTop",it(g));let T=Qe.postHead;return(E,L)=>{const $=Mt;return _(),S("article",{class:ze(["quest-post container relative rounded-md",U(o)?"!border-gray-400 px-1":"px-4 pt-0.5"]),"w:border":"1 dark:gray"},[p("div",Lr,[p("div",{class:"quest-post-head sticky",ref_key:"headRef",ref:s,"w:text":"sm","w:p":"t-1",style:ke({top:`${d.value}px`})},[$e(E.$slots,"head",{},void 0,!0),Ir,Mr,Nr],4),p("div",{class:ze(U(o)?"h-1.5":"h-1")},null,2),p("div",{class:"relative",ref_key:"postContentDivRef",ref:r},[e.displayStatus==="collapsed"?(_(),W($,{key:0,onClickCapture:l,"background-color-rgb-hex":e.backgroundColorRgbHex,"z-index":""},null,8,["background-color-rgb-hex"])):ne("",!0),p("div",{class:ze(e.displayStatus==="collapsed"?"max-h-15 overflow-hidden":void 0)},[p("div",Or,[Dr,p("div",{onClickCapture:l,class:ze((U(o),"px-2"))},[$e(E.$slots,"content",{},void 0,!0),p("div",{class:ze(U(o)?"h-2":"h-3")},null,2)],34)])],2)],512),Fr,p("div",{ref_key:"sentinelDiv",ref:c,style:ke([{position:"absolute",left:"0",right:"0",visibility:"hidden"},{height:`${u.value}px`,bottom:`${d.value}px`}])},null,4)])],2)}}});var Nn=ae(zr,[["__scopeId","data-v-63887ae8"]]);const Nt=e=>(Re("data-v-053ad1d9"),e=e(),Le(),e),Br={"w:float":"left"},Ur=Nt(()=>p("span",{class:"px-1.5"},null,-1)),Hr={"w:font":"mono"},qr=Nt(()=>p("span",{class:"px-3"},null,-1)),Wr={"w:font":"mono","w:float":"right"},Gr={"w:text":"xs"},Vr=It("("),Yr=["href"],jr=It(")"),Qr={key:0},Kr=Nt(()=>p("div",{class:"clear-both"},null,-1)),Xr=G({props:{post:null,nestLevel:null,displayStatus:null},emits:["expand"],setup(e,{emit:t}){const n=e;Pe(T=>({"09c311ec":U(Be)}));let o=x(()=>n.nestLevel>0),r=Ee(Ln),l=P(n,"post");const s=fe();let d=x(()=>{const T=l.value.createdAtUtc+288e3,E=new Date(T*1e3).toISOString(),[L,$]=E.split("T"),[F]=$.split(".");return`${L} ${F}`}),u=Ee(Pn),c=Ee(Rn),m=b(null),g=b(null);return se(()=>{if(n.nestLevel>0)return;let T=!0;ut(m,([{intersectionRatio:L,boundingClientRect:{y:$}}])=>{if(T){T=!1;return}s.isInAutoScrolling||L<1&&m.value.getBoundingClientRect().top<0&&(r.value&&(u.value=r.value),c.value=l.value.postId)},{threshold:1});let E=null;ut(g,([{intersectionRatio:L,boundingClientRect:{y:$}}])=>{if(E===null||E>window.innerHeight){E=$;return}E=$,!s.isInAutoScrolling&&L===1&&(r.value&&(u.value=r.value),c.value=l.value.postId)},{threshold:1})}),se(()=>{n.nestLevel===0&&dt(()=>{const T=fe();T.postToScrollTo===n.post.postId&&(m.value.scrollIntoView(),T.postToScrollTo=null)})}),(T,E)=>{const L=Xo,$=Rr;return _(),S("div",null,[p("div",{ref_key:"topSentinelDiv",ref:m},null,512),l.value?(_(),W(Nn,Rt({key:0,id:o.value?void 0:"id-"+l.value.postId,"nest-level":e.nestLevel,"display-status":e.displayStatus,"background-color-rgb-hex":U(Be),onExpand:E[0]||(E[0]=F=>t("expand"))},T.$attrs),{head:_e(()=>[p("div",Br,[$e(T.$slots,"head-left",{},void 0,!0),p("span",{"w:font":"mono",class:ze(l.value.isPostOwner?"font-black":"font-normal")},re(l.value.userId),3),Ur,p("span",Hr,re(d.value),1),qr]),p("div",Wr,[p("span",null,"No."+re(l.value.postId),1),p("span",Gr,[Vr,p("a",{class:"anchor-link",href:"#id-"+l.value.postId},"#"+re(l.value.floorNumber),9,Yr),jr])])]),content:_e(()=>{var F;return[p("div",null,[l.value.imageUrl?(_(),S("div",Qr,[Q(L,{"image-url":l.value.imageUrl,"background-color-rgb-hex":U(Be)},null,8,["image-url","background-color-rgb-hex"])])):ne("",!0),Q($,{content:l.value.content,"nest-level":(F=e.nestLevel)!=null?F:0},null,8,["content","nest-level"]),Kr])]}),_:3},16,["id","nest-level","display-status","background-color-rgb-hex"])):ne("",!0),p("div",{ref_key:"bottomSentinelDiv",ref:g},null,512)])}}});var Zr=ae(Xr,[["__scopeId","data-v-053ad1d9"]]);function On(e,t,n){const o=fe();return{postId:e.id,floorNumber:n,createdAtUtc:e.created_at,userId:e.user_id,isPostOwner:e.user_id===t.postOwner,content:e.content,imageUrl:e.attachment_base?(()=>{const l=`${e.attachment_base}${e.attachment_extension}`.split("/")[1],s=Ue.convertIdToFolderName(t.id);return`${o.lfsAssetBaseUrl}/${s}/attachments/${l}`})():void 0}}const Ot=e=>(Re("data-v-1caa4394"),e=e(),Le(),e),Jr={"w:float":"left"},es={"w:font":"mono","w:float":"right"},ts={key:0,"w:text":"rose-600 bold"},ns=Ot(()=>p("span",{"w:text":"lg"},"\u672C\u4E32\u53F7\u5BF9\u5E94\u5185\u5BB9\u672A\u88AB\u6536\u5F55\u2026",-1)),as=Ot(()=>p("br",null,null,-1)),os=Ot(()=>p("span",{"w:text":"sm"},"\u6B64\u5185\u5BB9\u53EF\u80FD\u6765\u81EA\u5176\u4ED6\u4E32\uFF0C\u6216\u5728\u6536\u5F55\u524D\u5C31\u5DF2\u6D88\u5931\u3002",-1)),rs=[ns,as,os],ss={key:1,"w:text":"gray-400 bold"},ls=G({props:{post:null,postId:null,nestLevel:null,displayStatus:{default:"open"}},emits:["expand"],setup(e,{emit:t}){const n=e;Pe(d=>({"6be2cbda":U(Be)}));let o=Ee(dn,b(!1)),r=x(()=>o.value||n.displayStatus==="collapsed");Ce(dn,it(r));const l=fe();let s=b("loading");return pe(n,()=>{if(n.post){s.value=n.post;return}new Promise(async()=>{const d=await l.currentQuest.getRefPost(n.postId);if(!d){console.debug(`\u4E32 ${n.postId} \u4E0D\u5B58\u5728\u4E8E\u6570\u636E\u4E2D`),s.value="lost";return}const u=l.currentQuest;s.value=On(d,u,u.postFloorLookup.get(d.id))})},{immediate:!0}),(d,u)=>{var m,g;const c=Zr;return s.value==="loading"||s.value==="lost"?(_(),W(Nn,Rt({key:0,"nest-level":(m=e.nestLevel)!=null?m:0,"display-status":e.displayStatus,"background-color-rgb-hex":U(Be),onExpand:u[0]||(u[0]=T=>t("expand"))},d.$attrs),{head:_e(()=>[p("div",Jr,[$e(d.$slots,"head-left",{},void 0,!0)]),p("div",es,[p("span",null,"No."+re(e.postId),1)])]),content:_e(()=>[s.value==="lost"?(_(),S("span",ts,rs)):(_(),S("span",ss,"\u52A0\u8F7D\u4E2D\u2026"))]),_:3},16,["nest-level","display-status","background-color-rgb-hex"])):(_(),W(c,Rt({key:1,post:s.value,"nest-level":(g=e.nestLevel)!=null?g:0,"display-status":e.displayStatus,onExpand:u[1]||(u[1]=T=>t("expand"))},d.$attrs),{"head-left":_e(()=>[$e(d.$slots,"head-left",{},void 0,!0)]),_:3},16,["post","nest-level","display-status"]))}}});var Dn=ae(ls,[["__scopeId","data-v-1caa4394"]]);const is=["id"],us={class:"post-page-bar"},cs={"w:font":"mono"},ds=p("div",{"w:h":"2"},null,-1),ps={key:1},fs=p("span",null,"\u9875\u9762\u52A0\u8F7D\u4E2D\u2026",-1),vs=[fs],ms=G({props:{props:null},emits:["ready"],setup(e,{emit:t}){const n=e;let o=x(()=>n.props.type==="page"?n.props.page:null);Ce(Ln,o);let r=x(()=>n.props.type==="page"?`${n.props.page}\u9875`:"?");const l=fe();let s=b([]);pe(P(n,"props"),async()=>{const u=l.currentQuest,c=await u.getPage(n.props.page);s.value=c.map(m=>On(m,u,u.postFloorLookup.get(m.id)))},{immediate:!0});let d=b(null);return se(()=>{je(d,u=>{l.rootPostWidth=u[0].contentRect.width})}),pe(s,()=>{s.value&&dt(()=>t("ready"))}),(u,c)=>{const m=Go;return _(),S("div",{class:"post-page",id:o.value!==null?`page-${o.value}`:void 0},[p("div",us,[Q(m,null,{default:_e(()=>[p("span",cs,re(r.value),1)]),_:1})]),ds,s.value?(_(),S("div",{key:0,class:"post-list",ref_key:"postListRef",ref:d,"w:space":"y-1"},[(_(!0),S(pt,null,bn(s.value,(g,T)=>(_(),W(Dn,{key:g.postId,post:g,style:ke({zIndex:U(Qe).post+s.value.length-T})},null,8,["post","style"]))),128))],512)):(_(),S("div",ps,vs))],8,is)}}}),hs={key:0,"w:h":"2"},_s=G({props:{pageStart:null,pageEnd:null,pageCurrent:null},emits:["updated"],setup(e,{emit:t}){const n=e;let o=x(()=>function*(){for(let s=n.pageStart;s<=n.pageEnd;s++)yield s});const r=new Map;pe([P(n,"pageStart"),P(n,"pageEnd")],()=>{for(const s of[...r.keys()])(s<n.pageStart||s>n.pageEnd)&&r.delete(s);for(let s=n.pageStart;s<=n.pageEnd;s++)r.has(s)||r.set(s,"loading")},{immediate:!0});function l(s){r.set(s,"ready"),t("updated",r)}return(s,d)=>{const u=ms;return _(!0),S(pt,null,bn(o.value(),(c,m)=>(_(),S("div",{key:c},[Number(m)!==0?(_(),S("div",hs)):ne("",!0),Q(u,{props:{type:"page",page:c},style:ke({zIndex:-c}),onReady:g=>l(c)},null,8,["props","style","onReady"])]))),128)}}});function gs(e){if(e.durationMs<=0)return window.scrollTo(window.screenX,e.finalY),e.onComplete(),null;const t=window.scrollY,n=e.finalY-t;let o=null,r=!1;const l=()=>{r=!0};return window.requestAnimationFrame(function s(d){if(r)return;o||(o=d);const u=d-o,c=Math.min(u/e.durationMs,1);window.scrollTo(window.screenX,t+n*c),u<e.durationMs?window.requestAnimationFrame(s):window.requestAnimationFrame(e.onComplete)}),l}const Dt=e=>(Re("data-v-51a22f11"),e=e(),Le(),e),ys={key:0,class:"max-w-2xl mx-auto"},bs=Dt(()=>p("hr",null,null,-1)),ws=Dt(()=>p("div",{"w:h":"2"},null,-1)),xs=Dt(()=>p("div",{"w:h":"2"},null,-1)),Ss=G({setup(e){var N;const n=wn().params;let o=xn(Te({},n)),r=P(o,"id"),l=P(o,"page");l.value=(N=l.value)!=null?N:"1";const s=fe();new Promise(async()=>{await Sn(P(s,"isInitialized")).toBe(!0),s.loadCurrentQuest(r.value)});let d=x(()=>s.currentQuest!==null),u=b(Number(l.value)),c=b(null);Ce(Pn,u),Ce(Rn,c),un([u,c],()=>{history.replaceState({},"",String(u.value)),history.replaceState({},"",c.value?`#id-${c.value}`:"")},{throttle:300});let m=b(u.value),g=b(u.value),T=x(()=>{var v;return(v=s.currentQuest)==null?void 0:v.postCount}),E=x(()=>{var v;return T.value?((((v=T.value)!=null?v:1)-1)/19|0)+1:null}),L=x(()=>{var v;return g.value<((v=E.value)!=null?v:0)});function $(v){return document.querySelector(`#page-${v}`)}let F=null,te;function oe(){F=$(m.value).offsetTop,m.value--}let V=b(new Map);function z(v){if(V.value=v,te&&(window.scrollTo(window.scrollX,te),te=null),F!==null){const B=$(m.value+1).offsetTop-F;window.scrollBy({top:B}),F=null}requestAnimationFrame(()=>ie())}let X=null,H=null;function ie(v=null,A=null){if(v===null){if(!H)return;v=H.pageToJumpTo,A=H.jumpToPageOptions}if(V.value.get(v)!=="ready"){H={pageToJumpTo:v,jumpToPageOptions:A};return}else H=null;X&&(X(),X=null),Te({behavior:"smooth"},A).behavior==="auto"?$(v).scrollIntoView():(s.isInAutoScrolling=!0,X=gs({finalY:$(v).getBoundingClientRect().top+window.scrollY,durationMs:300,onComplete:()=>{s.isInAutoScrolling=!1}}))}let R=b(null),M=x(()=>R.value===null?0:V.value.get(R.value)!=="ready"?500:0);un(R,()=>{if(R.value!==null){if(u.value=R.value,!(R.value>=m.value&&R.value<=g.value))if(R.value===m.value-1)m.value=R.value,g.value>m.value+9&&(g.value=m.value+9);else if(R.value===g.value+1){if(g.value=R.value,g.value>m.value+9){const v=$(m.value).getBoundingClientRect().top,A=$(g.value-9).getBoundingClientRect().top;te=window.scrollY-(A-v),m.value=g.value-9}}else m.value=R.value,g.value=R.value,window.scrollTo({top:0});c.value=null,ie(R.value),R.value=null}},{throttle:M});function w(v,A){R.value=v}let I=b(null);return se(()=>{ut(I,([{intersectionRatio:v}])=>{V.value.get(g.value)==="ready"&&v>0&&g.value++},{threshold:[0]})}),(v,A)=>{var ge;const B=Ao,ue=Fo,ce=_s;return d.value?(_(),S("div",ys,[Q(Tn,{class:"page-control bottom-2 sm:bottom-6"},{default:_e(()=>[Q(B,{"current-page":R.value||u.value,max:E.value,"page-statuses":V.value,onPageChangeRequired:A[0]||(A[0]=Z=>w(Z))},null,8,["current-page","max","page-statuses"])]),_:1}),It(re((ge=U(s).currentQuest)==null?void 0:ge.name),1),bs,m.value-1>0?(_(),W(ue,{key:0,direction:"up","page-number":m.value-1,onClick:oe},null,8,["page-number"])):ne("",!0),ws,Q(ce,{"page-start":m.value,"page-end":g.value,"page-current":u.value,onUpdated:A[1]||(A[1]=Z=>z(Z))},null,8,["page-start","page-end","page-current"]),xs,L.value?(_(),W(ue,{key:1,direction:"down","page-number":g.value+1,onClick:A[2]||(A[2]=Z=>g.value++)},null,8,["page-number"])):ne("",!0),p("div",{ref_key:"autoLoadNextPageSentinelDiv",ref:I,"w:m":"b-8"},null,512)])):ne("",!0)}}});var Ts=ae(Ss,[["__scopeId","data-v-51a22f11"]]);const As=G({setup(e){const t=wn(),n=da(),o=t.params;let r=xn(Te({},o)),l=P(r,"folder"),s=P(r,"quest"),d=P(r,"page");const u=fe();return new Promise(async()=>{await Sn(P(u,"isInitialized")).toBe(!0);const c=u.convertLegacyPathToId(l.value,s.value);n.replace({path:`${u.entrypoint}/quests/${c}/pages/${d.value}`,params:t.params,hash:t.hash})}),()=>{}}});var Es=[{path:`${st}/quests/:id/pages/:page`,component:Ts},{path:`${st}/quests/:id`,redirect:e=>{const t=e.path.endsWith("/")?e.path:`${e.path}/`;return At(Te({},e),{path:`${t}pages/1`})}},{path:`${st}/folder-:folder/quest-:quest/:page`,component:As}];const ks=to(Es);pa(ao,{routes:ks,scrollBehavior:(e,t,n)=>{if(e.hash){const o=/^#id\-(\d+)$/.exec(e.hash);if(o){const r=fe();r.postToScrollTo=Number(o[1])}}}},e=>{Object.values({"./modules/i18n.ts":ga,"./modules/nprogress.ts":ba,"./modules/pinia.ts":xa}).map(t=>{var n;return(n=t.install)==null?void 0:n.call(t,e)})});
